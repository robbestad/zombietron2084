(function(t){Number.prototype.map=function(t,i,e,s){return e+(s-e)*((this-t)/(i-t))};Number.prototype.limit=function(t,i){return Math.min(i,Math.max(t,this))};Number.prototype.round=function(t){t=Math.pow(10,t||0);return Math.round(this*t)/t};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*this/Math.PI};Object.defineProperty(Array.prototype,"erase",{value:function(t){for(var i=this.length;i--;)this[i]===t&&this.splice(i,1);return this}});Object.defineProperty(Array.prototype,"random",{value:function(){return this[Math.floor(Math.random()*this.length)]}});Function.prototype.bind=Function.prototype.bind||function(t){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var i=Array.prototype.slice.call(arguments,1),e=this,s=function(){},n=function(){return e.apply(this instanceof s&&t?this:t,i.concat(Array.prototype.slice.call(arguments)))};s.prototype=this.prototype;n.prototype=new s;return n};t.ig={game:null,debug:null,version:"1.24",global:t,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:t.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(t){return"#"==t.charAt(0)?document.getElementById(t.substr(1)):document.getElementsByTagName(t)},$new:function(t){return document.createElement(t)},copy:function(t){if(!t||"object"!=typeof t||t instanceof HTMLElement||t instanceof ig.Class)return t;if(t instanceof Array)for(var i=[],e=0,s=t.length;e<s;e++)i[e]=ig.copy(t[e]);else for(e in i={},t)i[e]=ig.copy(t[e]);return i},merge:function(t,i){for(var e in i){var s=i[e];if("object"!=typeof s||s instanceof HTMLElement||s instanceof ig.Class||null===s)t[e]=s;else{if(!t[e]||"object"!=typeof t[e])t[e]=s instanceof Array?[]:{};ig.merge(t[e],s)}}return t},ksort:function(t){if(!t||"object"!=typeof t)return[];var i=[],e=[],s;for(s in t)i.push(s);i.sort();for(s=0;s<i.length;s++)e.push(t[i[s]]);return e},setVendorAttribute:function(t,i,e){var s=i.charAt(0).toUpperCase()+i.substr(1);t[i]=t["ms"+s]=t["moz"+s]=t["webkit"+s]=t["o"+s]=e},getVendorAttribute:function(t,i){var e=i.charAt(0).toUpperCase()+i.substr(1);return t[i]||t["ms"+e]||t["moz"+e]||t["webkit"+e]||t["o"+e]},normalizeVendorAttribute:function(t,i){var e=ig.getVendorAttribute(t,i);!t[i]&&e&&(t[i]=e)},getImagePixels:function(t,i,e,s,n){var a=ig.$new("canvas");a.width=t.width;a.height=t.height;var o=a.getContext("2d");ig.System.SCALE.CRISP(a,o);var h=ig.getVendorAttribute(o,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(o,"getImageDataHD");var r=t.width/h,l=t.height/h;a.width=Math.ceil(r);a.height=Math.ceil(l);o.drawImage(t,0,0,r,l);return 1===h?o.getImageData(i,e,s,n):o.getImageDataHD(i,e,s,n)},module:function(t){if(ig._current)throw"Module '"+ig._current.name+"' defines nothing";if(ig.modules[t]&&ig.modules[t].body)throw"Module '"+t+"' is already defined";ig._current={name:t,requires:[],loaded:!1,body:null};ig.modules[t]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(t){ig._current.body=t;ig._current=null;ig._initDOMReady()},addResource:function(t){ig.resources.push(t)},setNocache:function(t){ig.nocache=t?"?"+Date.now():""},log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(t,i){ig.modules[t]={name:t,requires:[],loaded:!1,body:null};ig._waitForOnload++;var e=ig.prefix+ig.lib+t.replace(/\./g,"/")+".js"+ig.nocache,s=ig.$new("script");s.type="text/javascript";s.src=e;s.onload=function(){ig._waitForOnload--;ig._execModules()};s.onerror=function(){throw"Failed to load module "+t+" at "+e+" required from "+i};ig.$("head")[0].appendChild(s)},_execModules:function(){for(var t=!1,i=0;i<ig._loadQueue.length;i++){for(var e=ig._loadQueue[i],s=!0,n=0;n<e.requires.length;n++){var a=e.requires[n];ig.modules[a]?ig.modules[a].loaded||(s=!1):(s=!1,ig._loadScript(a,e.name))}s&&e.body&&(ig._loadQueue.splice(i,1),e.loaded=!0,e.body(),t=!0,i--)}if(t)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){t=[];for(i=0;i<ig._loadQueue.length;i++){s=[];a=ig._loadQueue[i].requires;for(n=0;n<a.length;n++)e=ig.modules[a[n]],(!e||!e.loaded)&&s.push(a[n]);t.push(ig._loadQueue[i].name+" (requires: "+s.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+t.join("\n")}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&ig.setNocache(!0);ig.ua.pixelRatio=t.devicePixelRatio||1;ig.ua.viewport={width:t.innerWidth,height:t.innerHeight};ig.ua.screen={width:t.screen.availWidth*ig.ua.pixelRatio,height:t.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in t||t.navigator.msMaxTouchPoints},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),t.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(t,"requestAnimationFrame");if(t.requestAnimationFrame){var i=1,e={};t.ig.setAnimation=function(s,n){var a=i++;e[a]=!0;var o=function(){e[a]&&(t.requestAnimationFrame(o,n),s())};t.requestAnimationFrame(o,n);return a};t.ig.clearAnimation=function(t){delete e[t]}}else t.ig.setAnimation=function(i){return t.setInterval(i,1e3/60)},t.ig.clearAnimation=function(i){t.clearInterval(i)};var s=!1,n=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,a=0;t.ig.Class=function(){};var o=function(t){var i=this.prototype,e={},s;for(s in t)"function"==typeof t[s]&&"function"==typeof i[s]&&n.test(t[s])?(e[s]=i[s],i[s]=function(t,i){return function(){var s=this.parent;this.parent=e[t];var n=i.apply(this,arguments);this.parent=s;return n}}(s,t[s])):i[s]=t[s]};t.ig.Class.extend=function(i){function e(){if(!s){if(this.staticInstantiate){var t=this.staticInstantiate.apply(this,arguments);if(t)return t}for(var i in this)"object"==typeof this[i]&&(this[i]=ig.copy(this[i]));this.init&&this.init.apply(this,arguments)}return this}var h=this.prototype;s=!0;var r=new this;s=!1;for(var l in i)r[l]="function"==typeof i[l]&&"function"==typeof h[l]&&n.test(i[l])?function(t,i){return function(){var e=this.parent;this.parent=h[t];var s=i.apply(this,arguments);this.parent=e;return s}}(l,i[l]):i[l];e.prototype=r;e.prototype.constructor=e;e.extend=t.ig.Class.extend;e.inject=o;e.classId=r.classId=++a;return e};t.ImpactMixin&&ig.merge(ig,t.ImpactMixin)})(window);ig.baked=!0;ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(t){return ig.Image.cache[t]||null},init:function(t){this.path=t;this.load()},load:function(t){this.loaded?t&&t(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=t||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(t){var i=ig.getImagePixels(this.data,0,0,this.width,this.height),e=this.width*t,s=this.height*t,n=ig.$new("canvas");n.width=e;n.height=s;for(var a=n.getContext("2d"),o=a.getImageData(0,0,e,s),h=0;h<s;h++)for(var r=0;r<e;r++){var l=4*(Math.floor(h/t)*this.width+Math.floor(r/t)),g=4*(h*e+r);o.data[g]=i.data[l];o.data[g+1]=i.data[l+1];o.data[g+2]=i.data[l+2];o.data[g+3]=i.data[l+3]}a.putImageData(o,0,0);this.data=n},draw:function(t,i,e,s,n,a){if(this.loaded){var o=ig.system.scale;n=(n?n:this.width)*o;a=(a?a:this.height)*o;ig.system.context.drawImage(this.data,e?e*o:0,s?s*o:0,n,a,ig.system.getDrawPos(t),ig.system.getDrawPos(i),n,a);ig.Image.drawCount++}},drawTile:function(t,i,e,s,n,a,o){n=n?n:s;if(this.loaded&&!(s>this.width||n>this.height)){var h=ig.system.scale,r=Math.floor(s*h),l=Math.floor(n*h),g=a?-1:1,u=o?-1:1;if(a||o)ig.system.context.save(),ig.system.context.scale(g,u);ig.system.context.drawImage(this.data,Math.floor(e*s)%this.width*h,Math.floor(e*s/this.width)*n*h,r,l,ig.system.getDrawPos(t)*g-(a?r:0),ig.system.getDrawPos(i)*u-(o?l:0),r,l);(a||o)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var t in ig.Image.cache)ig.Image.cache[t].reload()}});ig.baked=!0;ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(t){this._loadMetrics(this.data);this.parent(t)},widthForString:function(t){if(-1!==t.indexOf("\n")){t=t.split("\n");for(var i=0,e=0;e<t.length;e++)i=Math.max(i,this._widthForLine(t[e]));return i}return this._widthForLine(t)},_widthForLine:function(t){for(var i=0,e=0;e<t.length;e++)i+=this.widthMap[t.charCodeAt(e)-this.firstChar]+this.letterSpacing;return i},heightForString:function(t){return t.split("\n").length*(this.height+this.lineSpacing)},draw:function(t,i,e,s){"string"!=typeof t&&(t=t.toString());if(-1!==t.indexOf("\n")){t=t.split("\n");for(var n=this.height+this.lineSpacing,a=0;a<t.length;a++)this.draw(t[a],i,e+a*n,s)}else{if(s==ig.Font.ALIGN.RIGHT||s==ig.Font.ALIGN.CENTER)a=this._widthForLine(t),i-=s==ig.Font.ALIGN.CENTER?a/2:a;1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(a=0;a<t.length;a++)s=t.charCodeAt(a),i+=this._drawChar(s-this.firstChar,i,e);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=t.length}},_drawChar:function(t,i,e){if(!this.loaded||0>t||t>=this.indices.length)return 0;var s=ig.system.scale,n=this.widthMap[t]*s,a=(this.height-2)*s;ig.system.context.drawImage(this.data,this.indices[t]*s,0,n,a,ig.system.getDrawPos(i),ig.system.getDrawPos(e),n,a);return this.widthMap[t]+this.letterSpacing},_loadMetrics:function(t){this.height=t.height-1;this.widthMap=[];this.indices=[];for(var i=ig.getImagePixels(t,0,t.height-1,t.width,1),e=0,s=0,n=0;n<t.width;n++){var a=4*n+3;127<i.data[a]?s++:128>i.data[a]&&s&&(this.widthMap.push(s),this.indices.push(n-s),e++,s=0)}this.widthMap.push(s);this.indices.push(n-s)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var t=new Audio,i=0;i<ig.Sound.use.length;i++){var e=ig.Sound.use[i];if(t.canPlayType(e.mime)){this.format=e;break}}this.format||(ig.Sound.enabled=!1);ig.Sound.enabled&&ig.Sound.useWebAudio&&(this.audioContext=new AudioContext,this.boundWebAudioUnlock=this.unlockWebAudio.bind(this),document.addEventListener("touchstart",this.boundWebAudioUnlock,!1))}},unlockWebAudio:function(){document.removeEventListener("touchstart",this.boundWebAudioUnlock,!1);var t=this.audioContext.createBuffer(1,1,22050),i=this.audioContext.createBufferSource();i.buffer=t;i.connect(this.audioContext.destination);i.start(0)},load:function(t,i,e){return i&&ig.Sound.useWebAudio?this.loadWebAudio(t,i,e):this.loadHTML5Audio(t,i,e)},loadWebAudio:function(t,i,e){i=ig.prefix+t.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[t])return this.clips[t];var s=new ig.Sound.WebAudioSource;this.clips[t]=s;var n=new XMLHttpRequest;n.open("GET",i,!0);n.responseType="arraybuffer";var a=this;n.onload=function(i){a.audioContext.decodeAudioData(n.response,function(n){s.buffer=n;e(t,!0,i)},function(i){e(t,!1,i)})};n.onerror=function(i){e(t,!1,i)};n.send();return s},loadHTML5Audio:function(t,i,e){var s=ig.prefix+t.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[t]){if(this.clips[t]instanceof ig.Sound.WebAudioSource)return this.clips[t];if(i&&this.clips[t].length<ig.Sound.channels)for(i=this.clips[t].length;i<ig.Sound.channels;i++){var n=new Audio(s);n.load();this.clips[t].push(n)}return this.clips[t][0]}var a=new Audio(s);e&&(ig.ua.mobile?setTimeout(function(){e(t,!0,null)},0):(a.addEventListener("canplaythrough",function o(i){a.removeEventListener("canplaythrough",o,!1);e(t,!0,i)},!1),a.addEventListener("error",function(i){e(t,!1,i)},!1)));a.preload="auto";a.load();this.clips[t]=[a];if(i)for(i=1;i<ig.Sound.channels;i++)n=new Audio(s),n.load(),this.clips[t].push(n);return a},get:function(t){if((t=this.clips[t])&&t instanceof ig.Sound.WebAudioSource)return t;for(var i=0,e;e=t[i++];)if(e.paused||e.ended)return e.ended&&(e.currentTime=0),e;t[0].pause();t[0].currentTime=0;return t[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)});Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})},add:function(t,i){if(ig.Sound.enabled){var e=t instanceof ig.Sound?t.path:t,s=ig.soundManager.load(e,!1);if(s instanceof ig.Sound.WebAudioSource)throw ig.system.stopRunLoop(),"Sound '"+e+"' loaded as Multichannel but used for Music. Set the multiChannel param to false when loading, e.g.: new ig.Sound(path, false)";s.loop=this._loop;s.volume=this._volume;s.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(s);i&&(this.namedTracks[i]=s);this.currentTrack||(this.currentTrack=s)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(t){if(t&&this.namedTracks[t])t=this.namedTracks[t],t!=this.currentTrack&&(this.stop(),this.currentTrack=t);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(t){this._loop=t;for(var i in this.tracks)this.tracks[i].loop=t},getVolume:function(){return this._volume},setVolume:function(t){this._volume=t.limit(0,1);for(var i in this.tracks)this.tracks[i].volume=this._volume},fadeOut:function(t){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(t),this._fadeInterval=setInterval(this._fadeStep.bind(this),50))},_fadeStep:function(){var t=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;.01>=t?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=t},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,_loop:!1,init:function(t,i){this.path=t;this.multiChannel=!1!==i;Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});this.load()},getLooping:function(){return this._loop},setLooping:function(t){this._loop=t;this.currentClip&&(this.currentClip.loop=t)},load:function(t){ig.Sound.enabled?ig.ready?ig.soundManager.load(this.path,this.multiChannel,t):ig.addResource(this):t&&t(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.loop=this._loop,this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.WebAudioSource=ig.Class.extend({sources:[],gain:null,buffer:null,_loop:!1,init:function(){this.gain=ig.soundManager.audioContext.createGain();this.gain.connect(ig.soundManager.audioContext.destination);Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)})},play:function(){if(this.buffer){var t=ig.soundManager.audioContext.createBufferSource();t.buffer=this.buffer;t.connect(this.gain);t.loop=this._loop;var i=this;this.sources.push(t);t.onended=function(){i.sources.erase(t)};t.start(0)}},pause:function(){for(var t=0;t<this.sources.length;t++)try{this.sources[t].stop()}catch(i){}},getLooping:function(){return this._loop},setLooping:function(t){this._loop=t;for(var i=0;i<this.sources.length;i++)this.sources[i].loop=t},getVolume:function(){return this.gain.gain.value},setVolume:function(t){this.gain.gain.value=t}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0;ig.normalizeVendorAttribute(window,"AudioContext");ig.Sound.useWebAudio=!!window.AudioContext&&!window.nwf});ig.baked=!0;ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(t,i){this.gameClass=t;this.resources=i;this._loadCallbackBound=this._loadCallback.bind(this);for(var e=0;e<this.resources.length;e++)this._unloaded.push(this.resources[e].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var t=0;t<this.resources.length;t++)this.loadResource(this.resources[t]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(t){t.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId),ig.system.setGame(this.gameClass))},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var t=ig.system.scale,i=.6*ig.system.width,e=.1*ig.system.height,s=.5*ig.system.width-i/2,n=.5*ig.system.height-e/2;ig.system.context.fillStyle="#000";ig.system.context.fillRect(0,0,480,320);ig.system.context.fillStyle="#fff";ig.system.context.fillRect(s*t,n*t,i*t,e*t);ig.system.context.fillStyle="#000";ig.system.context.fillRect(s*t+t,n*t+t,i*t-t-t,e*t-t-t);ig.system.context.fillStyle="#fff";ig.system.context.fillRect(s*t,n*t,i*t*this._drawStatus,e*t)},_loadCallback:function(t,i){if(i)this._unloaded.erase(t);else throw"Failed to load resource: "+t;this.status=1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});ig.baked=!0;ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(t){this.last=this.base=ig.Timer.time;this.target=t||0},set:function(t){this.target=t||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var t=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:t},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=.05;ig.Timer.step=function(){var t=Date.now();ig.Timer.time+=Math.min((t-ig.Timer._last)/1e3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=t}});ig.baked=!0;ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(t,i,e,s,n){this.fps=i;this.clock=new ig.Timer;this.canvas=ig.$(t);this.resize(e,s,n);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);ig.System.scaleMode(this.canvas,this.context)},resize:function(t,i,e){this.width=t;this.height=i;this.scale=e||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(t){this.running?this.newGameClass=t:this.setGameNow(t)},setGameNow:function(t){ig.game=new t;ig.system.setDelegate(ig.game)},setDelegate:function(t){if("function"==typeof t.run)this.delegate=t,this.startRunLoop();else throw"System.setDelegate: No run() function in object"},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this),this.canvas);this.running=!0},clear:function(t){this.context.fillStyle=t;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});ig.System.DRAW={AUTHENTIC:function(t){return Math.round(t)*this.scale},SMOOTH:function(t){return Math.round(t*this.scale)},SUBPIXEL:function(t){return t*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(t,i){ig.setVendorAttribute(i,"imageSmoothingEnabled",!1);t.style.imageRendering="-moz-crisp-edges";t.style.imageRendering="-o-crisp-edges";t.style.imageRendering="-webkit-optimize-contrast";t.style.imageRendering="crisp-edges";t.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(t,i){ig.setVendorAttribute(i,"imageSmoothingEnabled",!0);t.style.imageRendering="";t.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var t=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",t,!1);ig.system.canvas.addEventListener("DOMMouseScroll",t,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||(this.isUsingAccelerometer=!0,window.addEventListener("devicemotion",this.devicemotion.bind(this),!1))},mousewheel:function(t){var i=this.bindings[0<(t.wheelDelta?t.wheelDelta:-1*t.detail)?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];i&&(this.actions[i]=!0,this.presses[i]=!0,this.delayedKeyup[i]=!0,t.stopPropagation(),t.preventDefault())},mousemove:function(t){var i=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,i=ig.system.scale*(i/ig.system.realWidth),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());t=t.touches?t.touches[0]:t;this.mouse.x=(t.clientX-e.left)/i;this.mouse.y=(t.clientY-e.top)/i},contextmenu:function(t){this.bindings[ig.KEY.MOUSE2]&&(t.stopPropagation(),t.preventDefault())},keydown:function(t){var i=t.target.tagName;if(!("INPUT"==i||"TEXTAREA"==i))if(i="keydown"==t.type?t.keyCode:2==t.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,0>i&&!ig.ua.mobile&&window.focus(),("touchstart"==t.type||"mousedown"==t.type)&&this.mousemove(t),i=this.bindings[i])this.actions[i]=!0,this.locks[i]||(this.presses[i]=!0,this.locks[i]=!0),t.preventDefault()},keyup:function(t){var i=t.target.tagName;if(!("INPUT"==i||"TEXTAREA"==i))if(i=this.bindings["keyup"==t.type?t.keyCode:2==t.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[i]=!0,t.preventDefault()},devicemotion:function(t){this.accel=t.accelerationIncludingGravity},bind:function(t,i){0>t?this.initMouse():0<t&&this.initKeyboard();this.bindings[t]=i},bindTouch:function(t,i){var e=ig.$(t),s=this;e.addEventListener("touchstart",function(t){s.touchStart(t,i)},!1);e.addEventListener("touchend",function(t){s.touchEnd(t,i)},!1);e.addEventListener("MSPointerDown",function(t){s.touchStart(t,i)},!1);e.addEventListener("MSPointerUp",function(t){s.touchEnd(t,i)},!1)},unbind:function(t){this.delayedKeyup[this.bindings[t]]=!0;this.bindings[t]=null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(t){return this.actions[t]},pressed:function(t){return this.presses[t]},released:function(t){return!!this.delayedKeyup[t]},clearPressed:function(){for(var t in this.delayedKeyup)this.actions[t]=!1,this.locks[t]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(t,i){this.actions[i]=!0;this.presses[i]=!0;t.stopPropagation();t.preventDefault();return!1},touchEnd:function(t,i){this.delayedKeyup[i]=!0;t.stopPropagation();t.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(t,i,e,s,n,a,o){ig.system=new ig.System(t,e,s,n,a||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;new(o||ig.Loader)(i,ig.resources).load()}});ig.merge=function(t,i){t=t||{};if(i)for(var e in i){var s=i[e],n=typeof s;if("undefined"!==n)if("object"!==n||s instanceof HTMLElement||s instanceof ig.Class)"string"===n&&("true"===s?s=!0:"false"===s&&(s=!1)),t[e]=s;else{if(!t[e]||"object"!==typeof t[e])t[e]=s instanceof Array?[]:{};ig.merge(t[e],s)}}return t};ig.baked=!0;ig.module("plusplus.config-user").defines(function(){ig.CONFIG_USER={TOP_DOWN:!0,ENTITY:{CAN_FLIP_X:!0,CAN_FLIP_Y:!1,MAX_VEL_X:500},CREATURE:{CAN_WANDER_X:!0,CAN_WANDER_Y:!0},LIGHT:{CASTS_SHADOWS:!1,CASTS_SHADOWS_MOVABLE:!1,ALPHA:.4,DIFFUSE:.9,SAMPLES:1},GAME_WIDTH_PCT:1,GAME_HEIGHT_PCT:1,GAME_WIDTH_VIEW:250,GAME_HEIGHT_VIEW:100,CAMERA:{KEEP_CENTERED:!1,LERP:.025,BOUNDS_TRAP_AS_PCT:!0,BOUNDS_TRAP_PCT_MINX:-.2,BOUNDS_TRAP_PCT_MINY:-.3,BOUNDS_TRAP_PCT_MAXX:.2,BOUNDS_TRAP_PCT_MAXY:.3,KEEP_INSIDE_LEVEL:!0},FONT:{MAIN_NAME:"fonts/kenpixel.blocks.8px.png",ALT_NAME:"fonts/kenpixel.blocks.8px.png",CHAT_NAME:"fonts/kenpixel.blocks.8px.png"},UI:{SCALE:3,IGNORE_SYSTEM_SCALE:!0}}});ig.baked=!0;ig.module("plusplus.core.config").requires("plusplus.config-user").defines(function(){ig.CONFIG={};ig.CONFIG.FORCE_ENTITY_EXTENDED=!0;ig.CONFIG.AUTO_CRISP_SCALING=!0;ig.CONFIG.MIN_TIME_STEP=(ig.ua.mobile?1e3/30:1e3/60)/1e3;ig.CONFIG.PATH_TO_MEDIA="media/";ig.CONFIG.DURATION_THROTTLE=500;ig.CONFIG.DURATION_THROTTLE_MEDIUM=250;ig.CONFIG.DURATION_THROTTLE_SHORT=60;ig.CONFIG.DURATION_TWEEN=500;ig.CONFIG.DURATION_FADE=300;ig.CONFIG.GAME_WIDTH=ig.ua.viewport.width;ig.CONFIG.GAME_HEIGHT=ig.ua.viewport.height;ig.CONFIG.GAME_WIDTH_PCT=0;ig.CONFIG.GAME_HEIGHT_PCT=0;ig.CONFIG.GAME_WIDTH_VIEW=0;ig.CONFIG.GAME_HEIGHT_VIEW=0;ig.CONFIG.TOP_DOWN=!1;ig.CONFIG.FLIP_Y=!1;ig.CONFIG.SCALE=1;ig.CONFIG.SCALE_MIN=1;ig.CONFIG.SCALE_MAX=Infinity;ig.CONFIG.RESIZE_DELAY=500;ig.CONFIG.GRAVITY=400;ig.CONFIG.AUTO_SORT_LAYERS=!1;ig.CONFIG.AUTO_SORT_OVERLAY_LAYER=!0;ig.CONFIG.AUTO_SORT_UI_LAYER=!0;ig.CONFIG.PRERENDER_MAPS=!0;ig.CONFIG.PRERENDER_BACKGROUND_LAYER=!0;ig.CONFIG.PRERENDER_FOREGROUND_LAYER=!0;ig.CONFIG.CLEAR_ON_LOAD_UI_LAYER=!1;ig.CONFIG.IGNORE_PAUSE_UI_LAYER=!0;ig.CONFIG.IGNORE_PAUSE_OVERLAY_LAYER=!1;ig.CONFIG.NO_UPDATE_BACKGROUND_LAYER=!0;ig.CONFIG.NO_UPDATE_FOREGROUND_LAYER=!0;ig.CONFIG.BACKGROUNDS_PARALLAX_X=!0;ig.CONFIG.BACKGROUNDS_PARALLAX_Y=!1;ig.CONFIG.LOADER_MAX_WIDTH_PCT=.5;ig.CONFIG.LOADER_MAX_HEIGHT_PCT=.5;ig.CONFIG.LOADER_BG_COLOR="#111111";ig.CONFIG.LOADER_FADE_COLOR="#DDDDDD";ig.CONFIG.LOADER_BAR=!0;ig.CONFIG.LOADER_BAR_COLOR="#DDDDDD";ig.CONFIG.LOADER_BAR_WIDTH_PCT=.25;ig.CONFIG.LOADER_BAR_HEIGHT_PCT=.025;ig.CONFIG.LOADER_BAR_LINE_WIDTH=3;ig.CONFIG.LOADER_BAR_SPACE_PCT=.005;ig.CONFIG.LOADER_SPACE_PCT=.02;ig.CONFIG.LOADER_LOGO_SRC_MAIN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP8AAAAtCAYAAABh/r3uAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QUTEQcqYSZEBgAAAVtJREFUeNrt3MGNwjAQBVC8oqPctpxtYevYFiiHm2tiryARKdaMjcHv3UCBOA5f/oGIctqxbdvtBLy9Wmt59vyXqYE1CT8sqqj6sOYlgJUf1H5gqdqv6oOVHxB+QPgB4QeEHxB+QPgB4Qfmds56o+vfz9Pnv38v6YPe29eR/baO8377I8eyt31kzK1zEhln1lxlnZfZ5qd1nJHtsz6TVn5A+IFg7R9ZUSLvkzXOSBXsfSmUNc6suerx2pFzlVXRW7e38gPCD0xY+2cw8leGIxWutVr3GHPWOFc4p+/42bbyA8IPvLD2v6pGZlXuyH5HvnbkvmY4pyuL3BBl5QeEH+hU+3tXlKxvqnuPM1KnZ6u7kbmKHGOP+Wn9BaT12Ge7gcfKDwg/8Mj/9oOVHxB+QPgB4QeEHxB+QPgB4QcmV+4fuOEHPluttVj5Qe0Hlq/9LgHgs6u+lR8QfljVP9Eqv3CR+x/VAAAAAElFTkSuQmCC";ig.CONFIG.LOADER_LOGO_SRC_ALT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QUGFCwN01BpQgAAACZpVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVAgb24gYSBNYWOV5F9bAAADT0lEQVR42u3du27UQBiG4VlkUSCuIRU9QhuKpMpFUFOkTcl1bElLTcFFUCUFsai4EwqEEFAkGwkL4zE+zeF5qxw2m43z/+98Y896dmGA/X7/KyBb2rbd/ev7jxyiulEACgA1szPm150JGMAQAAWAejOAMZ8BoACgACZwe9aG27PW0WQAVB0CuxY4vdk7wgyA6qaBTMAAyIRmjV/CCAyAmjJAX+d3YQIGQMkGiDUBIzAASjYAEzAAFMA4U7i6yAAoLQOMzQKyAQOgRAMwwbjjseTfywCV05TQKbIBAyDHDDA1C+SeDVLIQAxgCCgrRad8BvH6cBmuD5cKAGYBRc8Sjl1+/ubdH1/vfs4AqGMWkMq4nPos4Xicvr96G0II4fGHq8VfNwMwQHorglI3Qt8Yv9TxYQCUYYDSTFACDMAA+a0HKNUES2ULBkCaBkjVBDVlAwaoHAUwYKbS35+gAGSAdG4Vm0u3zZUNtkj9DIB0DVCrCWQAMAATMAA2oHEI5jdVnxFSSP0MgHwyQG5ZIMdswAAMkM+mUUuZ4OuPuz64+PRi1M99fPk5hBDC0+ZntiZgAAbIb9u4uU0wtUP7Xs+a6/sZAPUYYC4TzN2R759/CSGE8OzJt2yyAANUThZnAuc+g7ZUJ568Ptx9cD/m9xkrJRMwgAyQ/+bRY7PA0h2Y004pDFA5RRTA6c1+k65K8Z4/DIB8ZwFT0/7RAmtdPUzxnj8MgHwNkGpHpbiShwHgPEBq8/Ecd0VjAAbYzgBrja2xJvjf15PzfogMwADlZoDYDl16TSADgAFiOnKtq3TdtXpL4X0BSJ6q3hv4cK0gXPnPMwBWywBb7Y4VO69P7X0GDAAZYA5iz+hNXUfgDiFggC2Z65pCjfsGMIBZQHpnAvs6uuSVOQwABqh57x4GQD0GAANAAUABQAFAAUABQAFAAaCiAsj19iol3BaGAfBAMqeCh7qq79Lw0OPGPr77uOP3x/780OtI5ZI2A1ROs3XHdzuh23F9n8d24NDiktjOnPp8Y38fA6BsA5RGrKlkADDAkrOHoc6L7eDY5xvKJLGzFAZA3ecB5ppFgAGgAKAAEJcBul+wTLxs2rbdMQAUABQA/pYBZIKyx3wGgAKAAsA9vwE+PY+Xd5MPtQAAAABJRU5ErkJggg==";
ig.CONFIG.CLEAR_COLOR="#000000";ig.CONFIG.STATIC="static";ig.CONFIG.MOVABLE="movable";ig.CONFIG.DYNAMIC="dynamic";ig.CONFIG.AUTO_SPAWN_PLAYER=!0;ig.CONFIG.Z_INDEX_BELOW_ALL=-1;ig.CONFIG.Z_INDEX_BELOW_PLAYER=0;ig.CONFIG.Z_INDEX_PLAYER=100;ig.CONFIG.Z_INDEX_ABOVE_PLAYER=200;ig.CONFIG.Z_INDEX_ABOVE_ALL=9999;ig.CONFIG.TRANSITION_LEVELS=!0;ig.CONFIG.TRANSITIONER_COLOR="#333333";ig.CONFIG.TRANSITIONER_R=51;ig.CONFIG.TRANSITIONER_G=51;ig.CONFIG.TRANSITIONER_B=51;ig.CONFIG.TRANSITIONER_LAYER="ui";ig.CONFIG.Z_INDEX_TRANSITIONER=ig.CONFIG.Z_INDEX_ABOVE_PLAYER;ig.CONFIG.DIMMED_PAUSE=!0;ig.CONFIG.DIMMER_COLOR="#333333";ig.CONFIG.DIMMER_R=51;ig.CONFIG.DIMMER_G=51;ig.CONFIG.DIMMER_B=51;ig.CONFIG.DIMMER_ALPHA=.75;ig.CONFIG.LAYERS_CUSTOM={};ig.CONFIG.LEVEL_MAX=4;ig.CONFIG.RANKS_MAP={NONE:0,EASY:Math.round(.25*ig.CONFIG.LEVEL_MAX),MEDIUM:Math.round(.5*ig.CONFIG.LEVEL_MAX),HARD:Math.round(.75*ig.CONFIG.LEVEL_MAX),IMPOSSIBLE:ig.CONFIG.LEVEL_MAX};ig.CONFIG.PRECISION_ZERO=.01;ig.CONFIG.PRECISION_ZERO_TWEEN=.1;ig.CONFIG.PRECISION_PCT_ONE_SIDED=.01;ig.CONFIG.FONT={};ig.CONFIG.FONT.MAIN_NAME="font_04b03_white_8.png";ig.CONFIG.FONT.ALT_NAME="";ig.CONFIG.FONT.CHAT_NAME="";ig.CONFIG.FONT.SCALE=1;ig.CONFIG.FONT.SCALE_OF_SYSTEM_SCALE=1;ig.CONFIG.FONT.SCALE_MIN=1;ig.CONFIG.FONT.SCALE_MAX=Infinity;ig.CONFIG.FONT.IGNORE_SYSTEM_SCALE=!1;ig.CONFIG.UI={};ig.CONFIG.UI.POS_AS_PCT=!0;ig.CONFIG.UI.SCALE=1;ig.CONFIG.UI.SCALE_OF_SYSTEM_SCALE=1;ig.CONFIG.UI.SCALE_MIN=1;ig.CONFIG.UI.SCALE_MAX=Infinity;ig.CONFIG.UI.IGNORE_SYSTEM_SCALE=!1;ig.CONFIG.UI.MARGIN_AS_PCT_SMALLEST=!0;ig.CONFIG.UI.MARGIN_SCALELESS=!0;ig.CONFIG.UI.CAN_FLIP_X=!0;ig.CONFIG.UI.CAN_FLIP_Y=!1;ig.CONFIG.GESTURE={RELEASE_DELAY:.3,DIRECTION_SWITCH_PCT:.03,HOLD_DELAY:.15,HOLD_DELAY_BLOCK_TAP:.3,HOLD_DELAY_ACTIVATE:.5,HOLD_ACTIVATE_DISTANCE_PCT:.01,SWIPE_DISTANCE_PCT:.05,SWIPE_DURATION_TRY:.3,SWIPE_DURATION_RESET:.1,TAP_MULTI_DISTANCE_PCT:.05,TARGET_UP:!1,TARGET_DOWN:!1,TARGET_DOWN_START:!0,TARGET_TAP:!0,TARGET_SEARCH_RADIUS:10};ig.CONFIG.CAMERA={AUTO_FOLLOW_PLAYER:!0,SNAP_FIRST_FOLLOW:!0,CENTER_FIRST_FOLLOW:!0,KEEP_CENTERED:!0,KEEP_INSIDE_LEVEL:!1,LERP:1,BOUNDS_TRAP_AS_PCT:!1,BOUNDS_TRAP_MINX:0,BOUNDS_TRAP_MINY:0,BOUNDS_TRAP_MAXX:0,BOUNDS_TRAP_MAXY:0,BOUNDS_TRAP_PCT_MINX:0,BOUNDS_TRAP_PCT_MINY:0,BOUNDS_TRAP_PCT_MAXX:0,BOUNDS_TRAP_PCT_MAXY:0,TRANSITION_DURATION:1,TRANSITION_DURATION_MIN:.2,TRANSITION_DURATION_MAX:2,TRANSITION_DISTANCE:100};ig.CONFIG.ENTITY={};ig.CONFIG.ENTITY.SIZE_X=16;ig.CONFIG.ENTITY.SIZE_Y=16;ig.CONFIG.ENTITY.SIZE_OFFSET_X=0;ig.CONFIG.ENTITY.SIZE_OFFSET_Y=0;ig.CONFIG.ENTITY.SCALE=1;ig.CONFIG.ENTITY.SCALE_OF_SYSTEM_SCALE=1;ig.CONFIG.ENTITY.SCALE_MIN=1;ig.CONFIG.ENTITY.SCALE_MAX=Infinity;ig.CONFIG.ENTITY.IGNORE_SYSTEM_SCALE=!1;ig.CONFIG.ENTITY.CAN_FLIP_X=!0;ig.CONFIG.ENTITY.CAN_FLIP_Y=!1;ig.CONFIG.ENTITY.FRICTION_X=0;ig.CONFIG.ENTITY.FRICTION_Y=0;ig.CONFIG.ENTITY.MAX_VEL_X=100;ig.CONFIG.ENTITY.MAX_VEL_Y=100;ig.CONFIG.ENTITY.BOUNCINESS=0;ig.CONFIG.ENTITY.MIN_BOUNCE_VEL=40;ig.CONFIG.ENTITY.NEEDS_BOUNDS=!1;ig.CONFIG.ENTITY.NEEDS_VERTICES=!1;ig.CONFIG.ENTITY.HEALTH=1;ig.CONFIG.ENTITY.SLOPE_STICKING=!1;ig.CONFIG.ENTITY.SLOPE_SPEED_MOD=.75;ig.CONFIG.ENTITY.SLOPE_STANDING_MIN=-136;ig.CONFIG.ENTITY.SLOPE_STANDING_MAX=-44;ig.CONFIG.ENTITY.OPAQUE=!1;ig.CONFIG.ENTITY.OPAQUE_OFFSET={left:0,right:0,top:0,bottom:0};ig.CONFIG.ENTITY.OPAQUE_OFFSET_RIGHT=0;ig.CONFIG.ENTITY.OPAQUE_OFFSET_TOP=0;ig.CONFIG.ENTITY.OPAQUE_OFFSET_BOTTOM=0;ig.CONFIG.ENTITY.OPAQUE_FROM_VERTICES=!1;ig.CONFIG.ENTITY.DIFFUSE=.8;ig.CONFIG.LIGHT={};ig.CONFIG.LIGHT.PIXEL_PERFECT=!1;ig.CONFIG.LIGHT.GRADIENT=!0;ig.CONFIG.LIGHT.CASTS_SHADOWS=!1;ig.CONFIG.LIGHT.CASTS_SHADOWS_MOVABLE=!1;ig.CONFIG.LIGHT.R=1;ig.CONFIG.LIGHT.G=1;ig.CONFIG.LIGHT.B=1;ig.CONFIG.LIGHT.ALPHA=.25;ig.CONFIG.LIGHT.DIFFUSE=.8;ig.CONFIG.LIGHT.SAMPLES=1;ig.CONFIG.CHARACTER={};ig.CONFIG.CHARACTER.ANIM_AUTOMATIC=!0;ig.CONFIG.CHARACTER.SIZE_X=32;ig.CONFIG.CHARACTER.SIZE_Y=16;ig.CONFIG.CHARACTER.SIZE_OFFSET_X=0;ig.CONFIG.CHARACTER.SIZE_OFFSET_Y=0;ig.CONFIG.CHARACTER.MAX_VEL_UNGROUNDED_X=100;ig.CONFIG.CHARACTER.MAX_VEL_UNGROUNDED_Y=200;ig.CONFIG.CHARACTER.MAX_VEL_GROUNDED_X=100;ig.CONFIG.CHARACTER.MAX_VEL_GROUNDED_Y=100;ig.CONFIG.CHARACTER.MAX_VEL_CLIMBING_X=75;ig.CONFIG.CHARACTER.MAX_VEL_CLIMBING_Y=75;ig.CONFIG.CHARACTER.FRICTION_UNGROUNDED_X=0;ig.CONFIG.CHARACTER.FRICTION_UNGROUNDED_Y=0;ig.CONFIG.CHARACTER.FRICTION_GROUNDED_X=1600;ig.CONFIG.CHARACTER.FRICTION_GROUNDED_Y=1600;ig.CONFIG.CHARACTER.SPEED_X=750;ig.CONFIG.CHARACTER.SPEED_Y=750;ig.CONFIG.CHARACTER.CAN_JUMP=!0;ig.CONFIG.CHARACTER.JUMP_STEPS=4;ig.CONFIG.CHARACTER.JUMP_FORCE=10;ig.CONFIG.CHARACTER.JUMP_CONTROL=.75;ig.CONFIG.CHARACTER.CAN_JUMP_REPEATEDLY=!1;ig.CONFIG.CHARACTER.SLOPE_STICKING=!0;ig.CONFIG.CHARACTER.UNGROUNDED_FOR_THRESHOLD=.1;ig.CONFIG.CHARACTER.UNGROUNDED_FOR_AND_FALLING_THRESHOLD=.25;ig.CONFIG.CHARACTER.CAN_CLIMB=!0;ig.CONFIG.CHARACTER.CLIMBING_CONTROL=1;ig.CONFIG.CHARACTER.CAN_PATHFIND=!0;ig.CONFIG.CHARACTER.PATHFINDING_DELAY=1;ig.CONFIG.CHARACTER.PATHFINDING_UPDATE_DELAY=.2;ig.CONFIG.CHARACTER.PATHFINDING_SIMPLE_DELAY=.075;ig.CONFIG.CHARACTER.STUCK_DELAY=.1;ig.CONFIG.CHARACTER.HEALTH=1;ig.CONFIG.CHARACTER.ENERGY=1;ig.CONFIG.CHARACTER.REGEN_RATE_HEALTH=0;ig.CONFIG.CHARACTER.REGEN_RATE_ENERGY=0;ig.CONFIG.CHARACTER.EXPLODING_DAMAGE=!0;ig.CONFIG.CHARACTER.EXPLODING_DAMAGE_PARTICLE_COUNT=3;ig.CONFIG.CHARACTER.EXPLODING_DEATH=!0;ig.CONFIG.CHARACTER.EXPLODING_DEATH_PARTICLE_COUNT=10;ig.CONFIG.PLAYER_MANAGER={};ig.CONFIG.PLAYER_MANAGER.AUTO_MANAGE_PLAYER=!0;ig.CONFIG.PLAYER_MANAGER.HOLD_TO_MOVE=!0;ig.CONFIG.PLAYER_MANAGER.SWIPE_TO_JUMP=!0;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_ENABLED=!1;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_DEAD_ZONE_SIZE=6;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_SIZE=32;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MINX=0;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MINY=0;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MAXX=1;ig.CONFIG.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MAXY=1;ig.CONFIG.CREATURE={};ig.CONFIG.CREATURE.REACTION_DISTANCE=100;ig.CONFIG.CREATURE.REACTION_DELAY=.2;ig.CONFIG.CREATURE.PREDATOR_FROM_DAMAGE=!1;ig.CONFIG.CREATURE.CAN_LEARN_PREDATORS=!1;ig.CONFIG.CREATURE.NEEDS_LINE_OF_SIGHT_PREY=!0;ig.CONFIG.CREATURE.DETECT_HIDDEN_PREY=!1;ig.CONFIG.CREATURE.MOVE_TO_PREY_SETTINGS={avoidEntities:!0,searchDistance:ig.CONFIG.CREATURE.REACTION_DISTANCE};ig.CONFIG.CREATURE.NEEDS_LINE_OF_SIGHT_PREDATOR=!0;ig.CONFIG.CREATURE.DETECT_HIDDEN_PREDATOR=!1;ig.CONFIG.CREATURE.MOVE_TO_PREDATOR_SETTINGS={avoidEntities:!0,searchDistance:ig.CONFIG.CREATURE.REACTION_DISTANCE};ig.CONFIG.CREATURE.CAN_FLEE=!0;ig.CONFIG.CREATURE.FLEE_HEALTH_PCT=.15;ig.CONFIG.CREATURE.CAN_BREAK_TETHER=!1;ig.CONFIG.CREATURE.TETHER_TO_SPAWNER=!1;ig.CONFIG.CREATURE.TETHER_DISTANCE=100;ig.CONFIG.CREATURE.MOVE_TO_TETHER_SETTINGS={avoidEntities:!0};ig.CONFIG.CREATURE.CAN_WANDER_X=!0;ig.CONFIG.CREATURE.CAN_WANDER_Y=!1;ig.CONFIG.CREATURE.WANDER_SWITCH_CHANCE=0;ig.CONFIG.CREATURE.WANDER_SWITCH_CHANCE_STOPPED=0;ig.CONFIG.CREATURE.MOVE_TO_WANDER_SETTINGS={simple:!0,avoidUngrounded:!0,avoidSlopes:!0};ig.CONFIG.PARTICLE={};ig.CONFIG.PARTICLE.ANIM_AUTOMATIC=!0;ig.CONFIG.COLLISION={};ig.CONFIG.COLLISION.ALLOW_FIXED=!1;ig.CONFIG.COLLISION.TILE_SOLID=1;ig.CONFIG.COLLISION.TILE_ONE_WAY_UP=12;ig.CONFIG.COLLISION.TILE_ONE_WAY_DOWN=23;ig.CONFIG.COLLISION.TILE_ONE_WAY_RIGHT=34;ig.CONFIG.COLLISION.TILE_ONE_WAY_LEFT=45;ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP=46;ig.CONFIG.COLLISION.TILE_CLIMBABLE=47;ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP=48;ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS=49;ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY={};ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_UP]=!0;ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_DOWN]=!0;ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_RIGHT]=!0;ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_ONE_WAY_LEFT]=!0;ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE={};ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY={};ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_STAIRS={};ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_STAIRS[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_CLIMBABLE_STAIRS[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE={0:!0,50:!0,51:!0};ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_UP]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_DOWN]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_RIGHT]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_ONE_WAY_LEFT]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE_STRICT={0:!0,50:!0,51:!0};ig.CONFIG.COLLISION.TILES_HASH_WALKABLE_STRICT[ig.CONFIG.COLLISION.TILE_CLIMBABLE]=!0;ig.CONFIG.COLLISION.TILES_HASH_WALKABLE_STRICT[ig.CONFIG.COLLISION.TILE_CLIMBABLE_STAIRS]=!0;ig.CONFIG.COLLISION.TILES_HASH_SLOPED={2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,13:!0,14:!0,15:!0,16:!0,17:!0,18:!0,19:!0,20:!0,21:!0,22:!0,24:!0,25:!0,26:!0,27:!0,28:!0,29:!0,30:!0,31:!0,32:!0,33:!0,35:!0,36:!0,37:!0,38:!0,39:!0,40:!0,41:!0,42:!0,43:!0,44:!0,52:!0,53:!0,54:!0,55:!0};ig.CONFIG.PATHFINDING={};ig.CONFIG.PATHFINDING.BUILD_WITH_LEVEL=!0;ig.CONFIG.PATHFINDING.WEIGHTED=!0;ig.CONFIG.PATHFINDING.ALLOW_DIAGONAL=!0;ig.CONFIG.PATHFINDING.DIAGONAL_REQUIRES_BOTH_DIRECT=!0;ig.CONFIG.PATHFINDING.AVOID_ENTITIES=!0;ig.CONFIG.PATHFINDING.WEIGHT=10;ig.CONFIG.PATHFINDING.WEIGHT_AWAY_FROM=2;ig.CONFIG.PATHFINDING.AWAY_FROM_DISTANCE=100;ig.CONFIG.PATHFINDING.AWAY_FROM_MIN_DISTANCE_PCT=.4;ig.CONFIG.PATHFINDING.AWAY_FROM_MAX_NODES=40;ig.CONFIG.PATHFINDING.STRICT_SLOPE_CHECK=!1;ig.CONFIG.PATHFINDING.TILE_DEF={0:{weightPct:1},1:{weightPct:0,walkable:!0},2:{weightPct:.25,walkable:!0},3:{weightPct:.75,walkable:!0},4:{walkable:!1}};ig.CONFIG.OVERLAY={};ig.CONFIG.OVERLAY.R=0;ig.CONFIG.OVERLAY.G=0;ig.CONFIG.OVERLAY.B=0;ig.CONFIG.OVERLAY.ALPHA=.8;ig.CONFIG.OVERLAY.PIXEL_PERFECT=!1;ig.CONFIG.TEXT_BUBBLE={};ig.CONFIG.TEXT_BUBBLE.SIZE_X=120;ig.CONFIG.TEXT_BUBBLE.SIZE_Y=70;ig.CONFIG.TEXT_BUBBLE.SIZE_AS_PCT=!0;ig.CONFIG.TEXT_BUBBLE.SIZE_PCT_X=.5;ig.CONFIG.TEXT_BUBBLE.SIZE_PCT_Y=.5;ig.CONFIG.TEXT_BUBBLE.CORNER_RADIUS=5;ig.CONFIG.TEXT_BUBBLE.CORNER_RADIUS_AS_PCT=!1;ig.CONFIG.TEXT_BUBBLE.PIXEL_PERFECT=!1;ig.CONFIG.TEXT_BUBBLE.R=.9;ig.CONFIG.TEXT_BUBBLE.G=.9;ig.CONFIG.TEXT_BUBBLE.B=.9;ig.CONFIG.TEXT_BUBBLE.ALPHA=1;ig.CONFIG.TEXT_BUBBLE.TRIANGLE_LENGTH=10;ig.CONFIG.TEXT_BUBBLE.TRIANGLE_WIDTH=12;ig.CONFIG.TEXT_BUBBLE.PADDING_X=6;ig.CONFIG.TEXT_BUBBLE.PADDING_Y=6;ig.CONFIG.TEXT_BUBBLE.SHRINK_TO_TEXT=!0;ig.merge(ig.CONFIG,ig.CONFIG_USER);ig.CONFIG.ENTITY.CAN_FLIP_Y=ig.CONFIG.ENTITY.CAN_FLIP_Y||ig.CONFIG.FLIP_Y;ig.CONFIG.FONT.MAIN_PATH=ig.CONFIG.FONT.MAIN_NAME?ig.CONFIG.PATH_TO_MEDIA+ig.CONFIG.FONT.MAIN_NAME:"";ig.CONFIG.FONT.ALT_PATH=ig.CONFIG.FONT.ALT_NAME?ig.CONFIG.PATH_TO_MEDIA+ig.CONFIG.FONT.ALT_NAME:"";ig.CONFIG.FONT.CHAT_PATH=ig.CONFIG.FONT.CHAT_NAME?ig.CONFIG.PATH_TO_MEDIA+ig.CONFIG.FONT.CHAT_NAME:"";var t=ig.CONFIG,i=[],e;for(e in ig.CONFIG.RANKS_MAP)i.push({name:e,level:ig.CONFIG.RANKS_MAP[e]});i.sort(function(t,i){return t.level-i.level});t.RANKS=i;ig.CONFIG.ENTITY.SIZE_EFFECTIVE_X=ig.CONFIG.ENTITY.SIZE_X-2*ig.CONFIG.ENTITY.SIZE_OFFSET_X;ig.CONFIG.ENTITY.SIZE_EFFECTIVE_Y=ig.CONFIG.ENTITY.SIZE_Y-2*ig.CONFIG.ENTITY.SIZE_OFFSET_Y;ig.CONFIG.ENTITY.SIZE_EFFECTIVE_MIN=Math.min(ig.CONFIG.ENTITY.SIZE_EFFECTIVE_X,ig.CONFIG.ENTITY.SIZE_EFFECTIVE_Y);ig.CONFIG.ENTITY.SIZE_EFFECTIVE_MAX=Math.max(ig.CONFIG.ENTITY.SIZE_EFFECTIVE_X,ig.CONFIG.ENTITY.SIZE_EFFECTIVE_Y);ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X=ig.CONFIG.CHARACTER.SIZE_X-2*ig.CONFIG.CHARACTER.SIZE_OFFSET_X;ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_Y=ig.CONFIG.CHARACTER.SIZE_Y-2*ig.CONFIG.CHARACTER.SIZE_OFFSET_Y;ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_MIN=Math.min(ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X,ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_Y);ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_MAX=Math.max(ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X,ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_Y)});ig.baked=!0;ig.module("plusplus.helpers.utilsmath").defines(function(){ig.utilsmath={};ig.utilsmath.GOLDEN_ANGLE=Math.PI*(3-Math.sqrt(5));ig.utilsmath.TWOPI=2*Math.PI;ig.utilsmath.HALFPI=.5*Math.PI;ig.utilsmath.clamp=function(t,i,e){return Math.min(Math.max(t,i),e)};ig.utilsmath.map=function(t,i,e,s,n){return s+(n-s)*((t-i)/(e-i))};ig.utilsmath.degreesToRadians=function(t){return t/180*Math.PI};ig.utilsmath.radiansToDegrees=function(t){return 180*t/Math.PI};ig.utilsmath.almostEqual=function(t,i,e){if(t===i)return!0;t=i-t;return 0<t?t<e:t>-e};ig.utilsmath.oppositeSidesOfZero=function(t,i){return 0>t&&0<i||0<t&&0>i};ig.utilsmath.direction=function(t){return 0===t?0:0>t?-1:1};ig.utilsmath.directionChange=function(t,i){return 0===t&&0!==i||0!==t&&0===i||ig.utilsmath.oppositeSidesOfZero(t,i)}});ig.baked=!0;ig.module("plusplus.core.loader").requires("impact.loader","plusplus.core.config","plusplus.helpers.utilsmath").defines(function(){var t=ig.CONFIG,i=ig.utilsmath;ig.LoaderExtended=ig.Loader.extend({_endTime:0,init:function(i,e){this.logoMain=ig.$new("img");this.logoMain.src=t.LOADER_LOGO_SRC_MAIN;this.logoAlt=ig.$new("img");this.logoAlt.src=t.LOADER_LOGO_SRC_ALT;this.parent(i,e);i.prototype.resize.call(this)},end:function(){this.parent();this._endTime=Date.now();ig.system.setDelegate(this)},run:function(){var e=Date.now()-this._endTime,s=1;if(e<t.DURATION_FADE)this.draw(),s=i.map(e,0,t.DURATION_FADE,0,1);else if(e<2*t.DURATION_FADE)ig.game.run(),s=i.map(e,t.DURATION_FADE,2*t.DURATION_FADE,1,0);else{ig.system.setDelegate(ig.game);return}e=ig.system.context;e.globalAlpha=s;e.fillStyle=t.LOADER_FADE_COLOR;e.fillRect(0,0,ig.system.realWidth,ig.system.realHeight);e.globalAlpha=1},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var i=ig.system.context,e=ig.system.realWidth,s=ig.system.realHeight,n=Math.min(e,s)*t.LOADER_SPACE_PCT,a,o,h;t.LOADER_BAR?(a=e*t.LOADER_BAR_WIDTH_PCT,o=s*t.LOADER_BAR_HEIGHT_PCT,h=Math.min(e,s)*t.LOADER_BAR_SPACE_PCT):a=o=h=0;var r=this.logoMain.width,l=this.logoMain.height,g=this.logoAlt.width,u=this.logoAlt.height,c=Math.max(a,r,g),d=l+n+o+n+u,p=c/e,m=d/s,y=1,f=1;p>t.LOADER_MAX_WIDTH_PCT&&(y=1-(p-t.LOADER_MAX_WIDTH_PCT));m>t.LOADER_MAX_HEIGHT_PCT&&(f=1-(m-t.LOADER_MAX_HEIGHT_PCT));p=Math.min(1,y,f);m=(e-c*p)/2;y=(s-d*p)/2;i.fillStyle=t.LOADER_BG_COLOR;i.clearRect(0,0,e,s);i.save();i.translate(m,y);i.scale(p,p);i.drawImage(this.logoMain,.5*(c-r),0);t.LOADER_BAR&&(i.lineWidth=t.LOADER_BAR_LINE_WIDTH,i.strokeStyle=t.LOADER_BAR_COLOR,i.strokeRect(.5*(c-a),l+n,a,o),i.fillStyle=t.LOADER_BAR_COLOR,i.fillRect(.5*(c-a)+h,l+n+h,Math.max(0,a*this._drawStatus-2*h),o-2*h));i.drawImage(this.logoAlt,.5*(c-g),d-u);i.restore()}})});ig.baked=!0;ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(t,i,e){this.width=i;this.height=e;this.image=new ig.Image(t)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(t,i,e,s){this.sheet=t;this.pivot={x:t.width/2,y:t.height/2};this.timer=new ig.Timer;this.frameTime=i;this.sequence=e;this.stop=!!s;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(t){this.timer.set(this.frameTime*-t-1e-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var t=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(t/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-1:t%this.sequence.length;this.tile=this.sequence[this.frame]},draw:function(t,i){var e=Math.max(this.sheet.width,this.sheet.height);t>ig.system.width||(i>ig.system.height||0>t+e||0>i+e)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(t,i,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(t+this.pivot.x),ig.system.getDrawPos(i+this.pivot.y)),ig.system.context.rotate(this.angle),this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:44..toRad(),max:136..toRad()},init:function(t,i,e){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=t;this.pos.y=this.last.y=i;ig.merge(this,e)},reset:function(t,i,e){var s=this.constructor.prototype;this.pos.x=t;this.pos.y=i;this.last.x=t;this.last.y=i;this.vel.x=s.vel.x;this.vel.y=s.vel.y;this.accel.x=s.accel.x;this.accel.y=s.accel.y;this.health=s.health;this._killed=s._killed;this.standing=s.standing;this.type=s.type;this.checkAgainst=s.checkAgainst;this.collides=s.collides;ig.merge(this,e)},addAnim:function(t,i,e,s){if(!this.animSheet)throw"No animSheet to add the animation "+t+" to.";i=new ig.Animation(this.animSheet,i,e,s);this.anims[t]=i;this.currentAnim||(this.currentAnim=i);return i},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(t);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(t,i,e,s){return i?(t+i*ig.system.tick).limit(-s,s):e?(i=e*ig.system.tick,0<t-i?t-i:0>t+i?t+i:0):t.limit(-s,s)},handleMovementTrace:function(t){this.standing=!1;t.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));t.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(t.collision.slope){var i=t.collision.slope;if(0<this.bounciness){var e=this.vel.x*i.nx+this.vel.y*i.ny;this.vel.x=(this.vel.x-2*i.nx*e)*this.bounciness;this.vel.y=(this.vel.y-2*i.ny*e)*this.bounciness}else e=(this.vel.x*i.x+this.vel.y*i.y)/(i.x*i.x+i.y*i.y),this.vel.x=i.x*e,this.vel.y=i.y*e,i=Math.atan2(i.x,i.y),i>this.slopeStanding.min&&i<this.slopeStanding.max&&(this.standing=!0)}this.pos=t.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(t){this.health-=t;0>=this.health&&this.kill()},touches:function(t){return!(this.pos.x>=t.pos.x+t.size.x||this.pos.x+this.size.x<=t.pos.x||this.pos.y>=t.pos.y+t.size.y||this.pos.y+this.size.y<=t.pos.y)},distanceTo:function(t){var i=this.pos.x+this.size.x/2-(t.pos.x+t.size.x/2);t=this.pos.y+this.size.y/2-(t.pos.y+t.size.y/2);return Math.sqrt(i*i+t*t)},angleTo:function(t){return Math.atan2(t.pos.y+t.size.y/2-(this.pos.y+this.size.y/2),t.pos.x+t.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(t,i){t.checkAgainst&i.type&&t.check(i);i.checkAgainst&t.type&&i.check(t);t.collides&&(i.collides&&t.collides+i.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(t,i)};ig.Entity.solveCollision=function(t,i){var e=null;if(t.collides==ig.Entity.COLLIDES.LITE||i.collides==ig.Entity.COLLIDES.FIXED)e=t;else if(i.collides==ig.Entity.COLLIDES.LITE||t.collides==ig.Entity.COLLIDES.FIXED)e=i;t.last.x+t.size.x>i.last.x&&t.last.x<i.last.x+i.size.x?(t.last.y<i.last.y?ig.Entity.seperateOnYAxis(t,i,e):ig.Entity.seperateOnYAxis(i,t,e),t.collideWith(i,"y"),i.collideWith(t,"y")):t.last.y+t.size.y>i.last.y&&t.last.y<i.last.y+i.size.y&&(t.last.x<i.last.x?ig.Entity.seperateOnXAxis(t,i,e):ig.Entity.seperateOnXAxis(i,t,e),t.collideWith(i,"x"),i.collideWith(t,"x"))};ig.Entity.seperateOnXAxis=function(t,i,e){var s=t.pos.x+t.size.x-i.pos.x;e?(e.vel.x=-e.vel.x*e.bounciness+(t===e?i:t).vel.x,i=ig.game.collisionMap.trace(e.pos.x,e.pos.y,e==t?-s:s,0,e.size.x,e.size.y),e.pos.x=i.pos.x):(e=(t.vel.x-i.vel.x)/2,t.vel.x=-e,i.vel.x=e,e=ig.game.collisionMap.trace(t.pos.x,t.pos.y,-s/2,0,t.size.x,t.size.y),t.pos.x=Math.floor(e.pos.x),t=ig.game.collisionMap.trace(i.pos.x,i.pos.y,s/2,0,i.size.x,i.size.y),i.pos.x=Math.ceil(t.pos.x))};ig.Entity.seperateOnYAxis=function(t,i,e){var s=t.pos.y+t.size.y-i.pos.y;if(e){i=t===e?i:t;e.vel.y=-e.vel.y*e.bounciness+i.vel.y;var n=0;e==t&&Math.abs(e.vel.y-i.vel.y)<e.minBounceVelocity&&(e.standing=!0,n=i.vel.x*ig.system.tick);t=ig.game.collisionMap.trace(e.pos.x,e.pos.y,n,e==t?-s:s,e.size.x,e.size.y);e.pos.y=t.pos.y;e.pos.x=t.pos.x}else ig.game.gravity&&(i.standing||0<t.vel.y)?(e=ig.game.collisionMap.trace(t.pos.x,t.pos.y,0,-(t.pos.y+t.size.y-i.pos.y),t.size.x,t.size.y),t.pos.y=e.pos.y,0<t.bounciness&&t.vel.y>t.minBounceVelocity?t.vel.y*=-t.bounciness:(t.standing=!0,t.vel.y=0)):(e=(t.vel.y-i.vel.y)/2,t.vel.y=-e,i.vel.y=e,n=i.vel.x*ig.system.tick,e=ig.game.collisionMap.trace(t.pos.x,t.pos.y,n,-s/2,t.size.x,t.size.y),t.pos.y=e.pos.y,t=ig.game.collisionMap.trace(i.pos.x,i.pos.y,0,s/2,i.size.x,i.size.y),i.pos.y=t.pos.y)}});ig.baked=!0;ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(t,i){this.tilesize=t;this.data=i;this.height=i.length;this.width=i[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(t,i){var e=Math.floor(t/this.tilesize),s=Math.floor(i/this.tilesize);return 0<=e&&e<this.width&&0<=s&&s<this.height?this.data[s][e]:0},setTile:function(t,i,e){t=Math.floor(t/this.tilesize);i=Math.floor(i/this.tilesize);0<=t&&t<this.width&&(0<=i&&i<this.height)&&(this.data[i][t]=e)}})});ig.baked=!0;ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(t,i,e){this.parent(t,i);this.tiledef=e||ig.CollisionMap.defaultTileDef;for(var s in this.tiledef)s|0>this.lastSlope&&(this.lastSlope=s|0)},trace:function(t,i,e,s,n,a){var o={collision:{x:!1,y:!1,slope:!1},pos:{x:t,y:i},tile:{x:0,y:0}},h=Math.ceil(Math.max(Math.abs(e),Math.abs(s))/this.tilesize);if(1<h)for(var r=e/h,l=s/h,g=0;g<h&&(r||l)&&!(this._traceStep(o,t,i,r,l,n,a,e,s,g),t=o.pos.x,i=o.pos.y,o.collision.x&&(e=r=0),o.collision.y&&(s=l=0),o.collision.slope);g++);else this._traceStep(o,t,i,e,s,n,a,e,s,0);return o},_traceStep:function(t,i,e,s,n,a,o,h,r,l){t.pos.x+=s;t.pos.y+=n;var g=0;if(s){var u=0<s?a:0,c=0>s?this.tilesize:0,g=Math.max(Math.floor(e/this.tilesize),0),d=Math.min(Math.ceil((e+o)/this.tilesize),this.height);s=Math.floor((t.pos.x+u)/this.tilesize);var p=Math.floor((i+u)/this.tilesize);if(0<l||s==p||0>p||p>=this.width)p=-1;if(0<=s&&s<this.width)for(var m=g;m<d&&!(-1!=p&&(g=this.data[m][p],1<g&&g<=this.lastSlope&&this._checkTileDef(t,g,i,e,h,r,a,o,p,m)));m++)if(g=this.data[m][s],1==g||g>this.lastSlope||1<g&&this._checkTileDef(t,g,i,e,h,r,a,o,s,m)){if(1<g&&g<=this.lastSlope&&t.collision.slope)break;t.collision.x=!0;t.tile.x=g;i=t.pos.x=s*this.tilesize-u+c;h=0;break}}if(n){u=0<n?o:0;n=0>n?this.tilesize:0;g=Math.max(Math.floor(t.pos.x/this.tilesize),0);c=Math.min(Math.ceil((t.pos.x+a)/this.tilesize),this.width);m=Math.floor((t.pos.y+u)/this.tilesize);d=Math.floor((e+u)/this.tilesize);if(0<l||m==d||0>d||d>=this.height)d=-1;if(0<=m&&m<this.height)for(s=g;s<c&&!(-1!=d&&(g=this.data[d][s],1<g&&g<=this.lastSlope&&this._checkTileDef(t,g,i,e,h,r,a,o,s,d)));s++)if(g=this.data[m][s],1==g||g>this.lastSlope||1<g&&this._checkTileDef(t,g,i,e,h,r,a,o,s,m)){if(1<g&&g<=this.lastSlope&&t.collision.slope)break;t.collision.y=!0;t.tile.y=g;t.pos.y=m*this.tilesize-u+n;break}}},_checkTileDef:function(t,i,e,s,n,a,o,h,r,l){var g=this.tiledef[i];if(!g)return!1;i=(g[2]-g[0])*this.tilesize;var u=(g[3]-g[1])*this.tilesize,c=g[4];o=e+n+(0>u?o:0)-(r+g[0])*this.tilesize;h=s+a+(0<i?h:0)-(l+g[1])*this.tilesize;if(0<i*h-u*o){if(0>n*-u+a*i)return c;r=Math.sqrt(i*i+u*u);l=u/r;r=-i/r;var d=o*l+h*r,g=l*d,d=r*d;if(g*g+d*d>=n*n+a*a)return c||.5>i*(h-a)-u*(o-n);t.pos.x=e+n-g;t.pos.y=s+a-d;t.collision.slope={x:i,y:u,nx:l,ny:r};return!0}return!1}});var t=1/3,i=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,i,!0],6:[0,i,1,t,!0],7:[0,t,1,0,!0],3:[0,1,1,.5,!0],4:[0,.5,1,0,!0],2:[0,1,1,0,!0],10:[.5,1,1,0,!0],21:[0,1,.5,0,!0],32:[i,1,1,0,!0],43:[t,1,i,0,!0],54:[0,1,t,0,!0],27:[0,0,1,t,!0],28:[0,t,1,i,!0],29:[0,i,1,1,!0],25:[0,0,1,.5,!0],26:[0,.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,.5,1,!0],22:[.5,0,1,1,!0],33:[0,0,t,1,!0],44:[t,0,i,1,!0],55:[i,0,1,1,!0],16:[1,t,0,0,!0],17:[1,i,0,t,!0],18:[1,1,0,i,!0],14:[1,.5,0,0,!0],15:[1,1,0,.5,!0],13:[1,1,0,0,!0],8:[.5,1,0,0,!0],19:[1,1,.5,0,!0],30:[t,1,0,0,!0],41:[i,1,t,0,!0],52:[1,1,i,0,!0],38:[1,i,0,1,!0],39:[1,t,0,i,!0],40:[1,0,0,t,!0],36:[1,.5,0,1,!0],37:[1,0,0,.5,!0],35:[1,0,0,1,!0],9:[1,0,.5,1,!0],20:[.5,0,0,1,!0],31:[1,0,i,1,!0],42:[i,0,t,1,!0],53:[t,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(t,i,e,s){return{collision:{x:!1,y:!1,slope:!1},pos:{x:t+e,y:i+s},tile:{x:0,y:0}}}}});ig.baked=!0;ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(t,i,e){this.parent(t,i);this.setTileset(e)},setTileset:function(t){this.tilesetName=t instanceof ig.Image?t.path:t;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(t,i){this.scroll.x=t/this.distance;this.scroll.y=i/this.distance},preRenderMapToChunks:function(){var t=this.width*this.tilesize*ig.system.scale,i=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(t,i),this.chunkSize);var e=Math.ceil(t/this.chunkSize),s=Math.ceil(i/this.chunkSize);this.preRenderedChunks=[];for(var n=0;n<s;n++){this.preRenderedChunks[n]=[];for(var a=0;a<e;a++)this.preRenderedChunks[n][a]=this.preRenderChunk(a,n,a==e-1?t-a*this.chunkSize:this.chunkSize,n==s-1?i-n*this.chunkSize:this.chunkSize)}},preRenderChunk:function(t,i,e,s){var n=e/this.tilesize/ig.system.scale+1,a=s/this.tilesize/ig.system.scale+1,o=t*this.chunkSize/ig.system.scale%this.tilesize,h=i*this.chunkSize/ig.system.scale%this.tilesize;t=Math.floor(t*this.chunkSize/this.tilesize/ig.system.scale);i=Math.floor(i*this.chunkSize/this.tilesize/ig.system.scale);var r=ig.$new("canvas");r.width=e;r.height=s;r.retinaResolutionEnabled=!1;s=r.getContext("2d");ig.System.scaleMode(r,s);e=ig.system.context;ig.system.context=s;for(s=0;s<n;s++)for(var l=0;l<a;l++)if(s+t<this.width&&l+i<this.height){var g=this.data[l+i][s+t];g&&this.tiles.drawTile(s*this.tilesize-o,l*this.tilesize-h,g-1,this.tilesize)}ig.system.context=e;return r},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var t=ig.system.getDrawPos(this.scroll.x),i=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var e=this.width*this.tilesize*ig.system.scale,t=(t%e+e)%e,e=this.height*this.tilesize*ig.system.scale,i=(i%e+e)%e;var e=Math.max(Math.floor(t/this.chunkSize),0),s=Math.max(Math.floor(i/this.chunkSize),0),n=Math.ceil((t+ig.system.realWidth)/this.chunkSize),a=Math.ceil((i+ig.system.realHeight)/this.chunkSize),o=this.preRenderedChunks[0].length,h=this.preRenderedChunks.length;this.repeat||(n=Math.min(n,o),a=Math.min(a,h));for(var r=0;s<a;s++){for(var l=0,g=e;g<n;g++){var u=this.preRenderedChunks[s%h][g%o],c=-t+g*this.chunkSize-l,d=-i+s*this.chunkSize-r;ig.system.context.drawImage(u,c,d);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(c,d,this.chunkSize,this.chunkSize));this.repeat&&(u.width<this.chunkSize&&c+u.width<ig.system.realWidth)&&(l+=this.chunkSize-u.width,n++)}this.repeat&&(u.height<this.chunkSize&&d+u.height<ig.system.realHeight)&&(r+=this.chunkSize-u.height,a++)}},drawTiled:function(){for(var t=0,i=null,e=(this.scroll.x/this.tilesize).toInt(),s=(this.scroll.y/this.tilesize).toInt(),n=this.scroll.x%this.tilesize,a=this.scroll.y%this.tilesize,o=-n-this.tilesize,n=ig.system.width+this.tilesize-n,h=ig.system.height+this.tilesize-a,r=-1,a=-a-this.tilesize;a<h;r++,a+=this.tilesize){var l=r+s;if(l>=this.height||0>l){if(!this.repeat)continue;l=(l%this.height+this.height)%this.height}for(var g=-1,u=o;u<n;g++,u+=this.tilesize){t=g+e;if(t>=this.width||0>t){if(!this.repeat)continue;t=(t%this.width+this.width)%this.width}if(t=this.data[l][t])(i=this.anims[t-1])?i.draw(u,a):this.tiles.drawTile(u,a,t-1,this.tilesize)}}}})});ig.baked=!0;ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;ig.game=this;return null},loadLevel:function(t){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var i=0;i<t.entities.length;i++){var e=t.entities[i];this.spawnEntity(e.type,e.x,e.y,e.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(i=0;i<t.layer.length;i++)if(e=t.layer[i],"collision"==e.name)this.collisionMap=new ig.CollisionMap(e.tilesize,e.data);else{var s=new ig.BackgroundMap(e.tilesize,e.data,e.tilesetName);s.anims=this.backgroundAnims[e.tilesetName]||{};s.repeat=e.repeat;s.distance=e.distance;s.foreground=!!e.foreground;s.preRender=!!e.preRender;s.name=e.name;this.backgroundMaps.push(s)}for(i=0;i<this.entities.length;i++)this.entities[i].ready()},loadLevelDeferred:function(t){this._levelToLoad=t},getMapByName:function(t){if("collision"==t)return this.collisionMap;
for(var i=0;i<this.backgroundMaps.length;i++)if(this.backgroundMaps[i].name==t)return this.backgroundMaps[i];return null},getEntityByName:function(t){return this.namedEntities[t]},getEntitiesByType:function(t){t="string"===typeof t?ig.global[t]:t;for(var i=[],e=0;e<this.entities.length;e++){var s=this.entities[e];s instanceof t&&!s._killed&&i.push(s)}return i},spawnEntity:function(t,i,e,s){var n="string"===typeof t?ig.global[t]:t;if(!n)throw"Can't spawn entity of type "+t;t=new n(i,e,s||{});this.entities.push(t);t.name&&(this.namedEntities[t.name]=t);return t},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(t){t.name&&delete this.namedEntities[t.name];t._killed=!0;t.type=ig.Entity.TYPE.NONE;t.checkAgainst=ig.Entity.TYPE.NONE;t.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(t)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var t=0;t<this._deferredKill.length;t++)this._deferredKill[t].erase(),this.entities.erase(this._deferredKill[t]);this._deferredKill=[];if(this._doSortEntities||this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var i in this.backgroundAnims){var t=this.backgroundAnims[i],e;for(e in t)t[e].update()}},updateEntities:function(){for(var t=0;t<this.entities.length;t++){var i=this.entities[t];i._killed||i.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var t;for(t=0;t<this.backgroundMaps.length;t++){var i=this.backgroundMaps[t];if(i.foreground)break;i.setScreenPos(this.screen.x,this.screen.y);i.draw()}this.drawEntities();for(t;t<this.backgroundMaps.length;t++)i=this.backgroundMaps[t],i.setScreenPos(this.screen.x,this.screen.y),i.draw()},drawEntities:function(){for(var t=0;t<this.entities.length;t++)this.entities[t].draw()},checkEntities:function(){for(var t={},i=0;i<this.entities.length;i++){var e=this.entities[i];if(!(e.type==ig.Entity.TYPE.NONE&&e.checkAgainst==ig.Entity.TYPE.NONE&&e.collides==ig.Entity.COLLIDES.NEVER))for(var s={},n=Math.floor(e.pos.y/this.cellSize),a=Math.floor((e.pos.x+e.size.x)/this.cellSize)+1,o=Math.floor((e.pos.y+e.size.y)/this.cellSize)+1,h=Math.floor(e.pos.x/this.cellSize);h<a;h++)for(var r=n;r<o;r++)if(t[h])if(t[h][r]){for(var l=t[h][r],g=0;g<l.length;g++)e.touches(l[g])&&!s[l[g].id]&&(s[l[g].id]=!0,ig.Entity.checkPair(e,l[g]));l.push(e)}else t[h][r]=[e];else t[h]={},t[h][r]=[e]}}});ig.Game.SORT={Z_INDEX:function(t,i){return t.zIndex-i.zIndex},POS_X:function(t,i){return t.pos.x+t.size.x-(i.pos.x+i.size.x)},POS_Y:function(t,i){return t.pos.y+t.size.y-(i.pos.y+i.size.y)}}});ig.baked=!0;ig.module("plusplus.core.timer").requires("impact.timer","plusplus.core.config").defines(function(){ig.Timer.minStep=ig.CONFIG.MIN_TIME_STEP;ig.Timer.overflow=0;ig.Timer.stepped=!1;ig.Timer.step=function(){var t=Date.now();ig.Timer.overflow+=Math.min((t-ig.Timer._last)/1e3,ig.Timer.maxStep);ig.Timer.overflow>=ig.Timer.minStep?(ig.Timer.overflow-=ig.Timer.minStep,ig.Timer.time+=ig.Timer.minStep*ig.Timer.timeScale,ig.Timer.stepped=!0):ig.Timer.stepped=!1;ig.Timer._last=t}});ig.baked=!0;ig.module("plusplus.helpers.signals").defines(function(){function t(t,i,e,s,n){this._listener=i;this._isOnce=e;this.context=s;this._signal=t;this._priority=n||0}function i(t,i){if("function"!==typeof t)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",i))}t.prototype={active:!0,params:null,execute:function(t){var i;this.active&&this._listener&&(t=this.params?this.params.concat(t):t,i=this._listener.apply(this.context,t),this._isOnce&&this.detach());return i},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};ig.Signal=function(){this._bindings=[];this._prevParams=null;var t=this;this.dispatch=function(){ig.Signal.prototype.dispatch.apply(t,arguments)}};ig.Signal.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(i,e,s,n){var a=this._indexOfListener(i,s);if(-1!==a){if(i=this._bindings[a],i.isOnce()!==e)throw Error("You cannot add"+(e?"":"Once")+"() then add"+(!e?"":"Once")+"() the same listener without removing the relationship first.")}else i=new t(this,i,e,s,n),this._addBinding(i);this.memorize&&this._prevParams&&i.execute(this._prevParams);return i},_addBinding:function(t){var i=this._bindings.length;do--i;while(this._bindings[i]&&t._priority<=this._bindings[i]._priority);this._bindings.splice(i+1,0,t)},_indexOfListener:function(t,i){for(var e=this._bindings.length,s;e--;)if(s=this._bindings[e],s._listener===t&&s.context===i)return e;return-1},has:function(t,i){return-1!==this._indexOfListener(t,i)},add:function(t,e,s){i(t,"add");return this._registerListener(t,!1,e,s)},addOnce:function(t,e,s){i(t,"addOnce");return this._registerListener(t,!0,e,s)},remove:function(t,e){i(t,"remove");var s=this._indexOfListener(t,e);-1!==s&&(this._bindings[s]._destroy(),this._bindings.splice(s,1));return t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(t){if(this.active){var i=Array.prototype.slice.call(arguments),e=this._bindings.length,s;this.memorize&&(this._prevParams=i);if(e){s=this._bindings.slice();this._shouldPropagate=!0;do e--;while(s[e]&&this._shouldPropagate&&!1!==s[e].execute(i))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}}});ig.baked=!0;ig.module("plusplus.core.image").requires("impact.image","plusplus.helpers.signals").defines(function(){ig.Image.inject({width:1,height:1,data:null,dataContext:null,dataWidth:1,dataHeight:1,scale:1,scaleOfSystemScale:1,scaleMin:1,scaleMax:Infinity,ignoreSystemScale:!1,retainScaledData:!0,scaleCache:null,onLoaded:null,_scale:0,init:function(t,i){ig.merge(this,i);this.onLoaded=new ig.Signal;this.scaleCache={};this.parent(t)},onload:function(){this.width=Math.max(this.data.width|0,1);this.height=Math.max(this.data.height|0,1);this.loaded=!0;var t=ig.$new("canvas");t.width=this.width;t.height=this.height;t.style.width=this.width+"px";t.style.height=this.height+"px";t.retinaResolutionEnabled=!1;var i=t.getContext("2d");ig.System.scaleMode(t,i);i.drawImage(this.data,0,0);this.data=t;this.dataContext=this.data.getContext("2d");this.dataWidth=this.data.width;this.dataHeight=this.data.height;this.scaleCache||(this.scaleCache={});this.scaleCache.x1=this.data;this.loadCallback&&this.loadCallback(this.path,!0);this.onLoaded&&(this.onLoaded.dispatch(this),this.onLoaded.removeAll(),this.onLoaded.forget());!ig.global.wm&&(ig.game&&!ig.game._gameNeedsSetup)&&ig.game.resizeDeferred(!0)},resize:function(t){var i=this.scaleCache.x1;if(i&&t&&(t=Math.min(Math.max(Math.round(t*this.scaleOfSystemScale),this.scaleMin),this.scaleMax),this._scale!==t))if(this.scale=this._scale=t,this.scaleCache||(this.scaleCache={}),this.data=this.scaleCache["x"+t])this.dataContext=this.data.getContext("2d"),this.dataWidth=this.data.width,this.dataHeight=this.data.height;else{var i=ig.getImagePixels(i,0,0,this.width,this.height),e=this.width*t|0,s=this.height*t|0,n=this.data=ig.$new("canvas");n.width=e;n.height=s;n.style.width=e+"px";n.style.height=s+"px";n.retinaResolutionEnabled=!1;this.dataWidth=e;this.dataHeight=s;var a=this.dataContext=this.data.getContext("2d");ig.System.scaleMode(n,a);for(var n=a.getImageData(0,0,e,s),o=0;o<s;o++)for(var h=0;h<e;h++){var r=4*(Math.floor(o/t)*this.width+Math.floor(h/t)),l=4*(o*e+h);n.data[l]=i.data[r];n.data[l+1]=i.data[r+1];n.data[l+2]=i.data[r+2];n.data[l+3]=i.data[r+3]}a.putImageData(n,0,0);this.retainScaledData&&(this.scaleCache["x"+t]=this.data)}},draw:function(t,i,e,s,n,a,o){this.data&&(o?this.resize(o):(!this.ignoreSystemScale&&this._scale!==ig.system.scale?this.resize(ig.system.scale):this._scale!==this.scale&&this.resize(this.scale),o=this._scale),n=("undefined"!==typeof n?n:this.width)*o|0,a=("undefined"!==typeof a?a:this.height)*o|0,0===n||0===a||(ig.system.context.drawImage(this.data,e?e*o|0:0,s?s*o|0:0,n,a,ig.system.getDrawPos(t),ig.system.getDrawPos(i),n,a),ig.Image.drawCount++))},drawTile:function(t,i,e,s,n,a,o,h){n=n?n:s;if(this.data&&!(s>this.width||n>this.height)){h?this.resize(h):(!this.ignoreSystemScale&&this._scale!==ig.system.scale?this.resize(ig.system.scale):this._scale!==this.scale&&this.resize(this.scale),h=this._scale);var r=Math.floor(s*h),l=Math.floor(n*h),g,u,c,d;a?(g=-1,c=r):(g=1,c=0);o?(u=-1,d=l):(u=1,d=0);a||o?(ig.system.context.save(),ig.system.context.scale(g,u),ig.system.context.drawImage(this.data,Math.floor(e*s)%this.width*h,Math.floor(e*s/this.width)*n*h,r,l,ig.system.getDrawPos(t)*g-c,ig.system.getDrawPos(i)*u-d,r,l),ig.system.context.restore()):ig.system.context.drawImage(this.data,Math.floor(e*s)%this.width*h,Math.floor(e*s/this.width)*n*h,r,l,ig.system.getDrawPos(t)*g-c,ig.system.getDrawPos(i)*u-d,r,l);ig.Image.drawCount++}}});ig.global.wm&&ig.Image.inject({resize:function(t){t&&this._scale!==t&&(this.scaleCache.x1||(this.scaleCache.x1=this.data),this.parent(t))},draw:function(t,i,e,s,n,a,o){o||(o=ig.system.scale);this.parent(t,i,e,s,n,a,o)},drawTile:function(t,i,e,s,n,a,o,h){h||(h=ig.system.scale);this.parent(t,i,e,s,n,a,o,h)}})});ig.baked=!0;ig.module("plusplus.core.font").requires("impact.font","plusplus.core.config","plusplus.core.image").defines(function(){var t=ig.CONFIG;ig.Font.inject({scale:t.FONT.SCALE,scaleOfSystemScale:t.FONT.SCALE_OF_SYSTEM_SCALE,scaleMin:t.FONT.SCALE_MIN,scaleMax:t.FONT.SCALE_MAX,ignoreSystemScale:t.FONT.IGNORE_SYSTEM_SCALE,multilineForWidth:function(t,i){t=""+t;var e="",s=0,n=t.split(" ");t.replace("\n","");for(var a=0,o=n.length;a<o;a++){var h=n[a]+(a!==o-1?" ":""),r=this._widthForLine(h);0!==s&&s+r>i&&(e+="\n",s=0);e+=h;s+=r}return e},overflowForHeight:function(t,i){var e=t=""+t,s="",n=t.split("\n"),a=n.length*(this.height+this.lineSpacing);if(a>i)for(var a=Math.floor(n.length*i/a),e="",o=0,h=n.length;o<h;o++){var r=n[o];o<a?(e+=r,o<a-1&&(e+="\n")):(s+=r,o<h-1&&(s+="\n"))}return{display:e,overflow:s}},draw:function(t,i,e,s,n,a,o,h){if(this.loaded){t=""+t;if(!h&&(n=n||ig.system.context,a?(o=this.scale,this.resize(a),this.scale=o):(!this.ignoreSystemScale&&this._scale!==ig.system.scale?this.resize(ig.system.scale):this._scale!==this.scale&&this.resize(this.scale),a=this._scale),o=n===ig.system.context?a/ig.system.scale:1,-1!==t.indexOf("\n"))){t=t.split("\n");var r=(this.height+this.lineSpacing)*o;h=0;for(var l=t.length;h<l;h++)this.draw(t[h],i,e+h*r,s,n,a,o,!0);return}s===ig.Font.ALIGN.CENTER?i-=.5*this._widthForLine(t):s===ig.Font.ALIGN.RIGHT&&(i-=this._widthForLine(t));1!==this.alpha&&(n.globalAlpha=this.alpha);for(h=0;h<t.length;h++)s=t.charCodeAt(h)-this.firstChar,i+=this._drawChar(s,i,e,n,a)*o;1!==this.alpha&&(n.globalAlpha=1);ig.Image.drawCount+=t.length}},_drawChar:function(t,i,e,s,n){var a=this.widthMap[t],o=this.height-2;s===ig.system.context?s.drawImage(this.data,this.indices[t]*n,0,a*n,o*n,ig.system.getDrawPos(i),ig.system.getDrawPos(e),a*n,o*n):s.drawImage(this.data,this.indices[t]*n,0,a*n,o*n,i*n,e*n,a*n,o*n);return a+this.letterSpacing}});ig.Font.FONTS={};ig.Font.FONTS.MAIN=t.FONT.MAIN_PATH?new ig.Font(t.FONT.MAIN_PATH):null;ig.Font.FONTS.ALT=t.FONT.ALT_PATH?new ig.Font(t.FONT.ALT_PATH):ig.Font.FONTS.MAIN;ig.Font.FONTS.CHAT=t.FONT.CHAT_PATH?new ig.Font(t.FONT.CHAT_PATH):ig.Font.FONTS.MAIN});ig.baked=!0;ig.module("plusplus.core.image-drawing").requires("plusplus.core.image").defines(function(){ig.ImageDrawing=ig.Image.extend({loaded:!0,init:function(t){ig.merge(this,t);this.data=ig.$new("canvas");this.dataContext=this.data.getContext("2d");this.dataWidth=this.width*this.scale|0;this.dataHeight=this.height*this.scale|0;this.data.width=this.dataWidth;this.data.height=this.dataHeight;this.data.style.width=this.dataWidth+"px";this.data.style.height=this.dataHeight+"px";this.data.retinaResolutionEnabled=!1;ig.System.scaleMode(this.data,this.dataContext);this.scaleCache={};this.scaleCache.x1=this.data},load:function(){},reload:function(){},onload:function(){},setWidth:function(t){this.setDimensions(t,this.height)},setHeight:function(t){this.setDimensions(this.width,t)},setDimensions:function(t,i){this.width=Math.max(t|0,1);this.height=Math.max(i|0,1);this.data&&(this.dataWidth=this.data.width=this.width,this.dataHeight=this.data.height=this.height,ig.System.scaleMode(this.data,this.dataContext))},finalize:function(t){this.data&&(t?this.scale=this._scale=Math.min(Math.max(Math.round(t*this.scaleOfSystemScale),this.scaleMin),this.scaleMax):this._scale=t=1,this.scaleCache={},this.scaleCache["x"+t]=this.data,this.dataContext=this.data.getContext("2d"),this.dataWidth=this.data.width,this.dataHeight=this.data.height,this.width=Math.max(this.dataWidth/t|0,1),this.height=Math.max(this.dataHeight/t|0,1))}})});ig.baked=!0;ig.module("plusplus.helpers.shims").defines(function(){"function"!==typeof Date.now&&(Date.now=function(){return+new Date})});ig.baked=!0;ig.module("plusplus.helpers.utils").requires("plusplus.helpers.shims","plusplus.core.config").defines(function(){var t=ig.global,i=ig.CONFIG;ig.utils={};ig.utils.type=function(t){return null==t?t+"":Object.prototype.toString.call(t).slice(8,-1).toLowerCase()};ig.utils.isNumber=function(t){return!isNaN(t)&&isFinite(t)&&"boolean"!==typeof t};ig.utils.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)};ig.utils.toArray=function(t){return t?!0!==ig.utils.isArray(t)?[t]:t:[]};ig.utils.toNotArray=function(t,i){return!0===ig.utils.isArray(t)?t[i||0]:t};ig.utils.arrayCautiousAdd=function(t,i){-1===ig.utils.indexOfValue(t,i)&&t.push(i);return t};ig.utils.arrayCautiousAddMulti=function(t,i){var e,s;i=ig.utils.toArray(i);for(var n=0,a=i.length;n<a;n++)e=i[n],e!==t&&(s=ig.utils.indexOfValue(t,e),-1===s&&t.push(e));return t};ig.utils.arrayCautiousRemove=function(t,i){var e=ig.utils.indexOfValue(t,i);-1!==e&&t.splice(e,1);return t};ig.utils.arrayCautiousRemoveMulti=function(t,i){var e;i=ig.utils.toArray(i);for(var s=0,n=i.length;s<n;s++)e=i[s],e!==t&&(e=ig.utils.indexOfValue(t,e),-1!==e&&t.splice(e,1));return t};ig.utils.forEach=function(t,i,e){for(var s=0,n=t.length;s<n;s++)i.apply(t[s],e)};ig.utils.indexOfValue=function(t,i){for(var e=0,s=t.length;e<s;e++)if(i===t[e])return e;return-1};ig.utils.indexOfProperty=function(t,i,e){for(var s=0,n=t.length;s<n;s++)if(e===t[s][i])return s;return-1};ig.utils.indexOfProperties=function(t,i,e){for(var s=0,n=t.length;s<n;s++){for(var a=t[s],o=!1,h=0,r=i.length;h<r;h++)if(e[h]!==a[i[h]]){o=!0;break}if(!0!==o)return s}return-1};ig.utils.throttle=function(e,s,n){var a,o=0;!0!==ig.utils.isNumber(s)&&(s=i.DURATION_THROTTLE);return function(){function i(){o=Date.now();e.apply(h,l)}var h=this,r=Date.now()-o,l=arguments;r>s?(a&&t.clearTimeout(a),i()):!1!==n&&(a&&t.clearTimeout(a),a=t.setTimeout(i,s-r))}};ig.utils.debounce=function(e,s){var n;!0!==ig.utils.isNumber(s)&&(s=i.DURATION_THROTTLE);return function(){var i=this,a=arguments;n&&t.clearTimeout(n);n=t.setTimeout(function(){e.apply(i,a)},s)}};var e=Math.pow(2,32);ig.utils.getType=function(t,i,s){s=s||"TYPE";var n=t[s],a=s+"_LAST";if(!t[a]||!n)t[a]=1,n=t[s]={};i=i.toUpperCase();s=n[i];if(!s){s=0;for(var o=t[a],h=i.split(" "),r=0,l=h.length;r<l;r++){var g=h[r],u=n[g];if(!u){if(o>=e)throw new TypeError("Bitwise flag out of range / above 32 bits!");u=n[g]=o;t[a]=2*o}s|=u}n[i]=s}return s};ig.utils.addType=function(t,i,e,s,n){i[e]|=ig.utils.getType(t,s,n)}});ig.baked=!0;ig.module("plusplus.core.background-map").requires("impact.background-map","plusplus.core.config","plusplus.core.image-drawing","plusplus.helpers.utils").defines(function(){var t=ig.CONFIG,i=ig.utils;ig.BackgroundMapExtended=ig.BackgroundMap.extend({preRenderedScale:0,mergedMaps:[],parallaxX:t.BACKGROUNDS_PARALLAX_X,parallaxY:t.BACKGROUNDS_PARALLAX_Y,setScreenPos:function(t,i){this.scroll.x=this.parallaxX?t/this.distance:t;this.scroll.y=this.parallaxY?i/this.distance:i},setTileset:function(t){t instanceof ig.ImageDrawing?this.tiles=t:(this.tilesetName=t instanceof ig.Image?t.path:t,this.tiles=new ig.Image(this.tilesetName));this.preRenderedChunks=null},merge:function(t){return this.preRender&&!this.repeat&&t instanceof ig.BackgroundMap&&t.preRender&&!t.repeat&&t.distance===this.distance?(i.arrayCautiousAdd(this.mergedMaps,t),this.preRenderedChunks=null,!0):!1},preRenderMapToChunks:function(){this.preRenderedScale=ig.system.scale;if(0<this.mergedMaps.length){this.preRenderedChunks=[];for(var t=[this].concat(this.mergedMaps),i=0,e=0,s=0,n=0,a=0,o=t.length;a<o;a++)var h=t[a],i=Math.max(i,h.width*h.tilesize*ig.system.scale),e=Math.max(e,h.height*h.tilesize*ig.system.scale),s=Math.max(i,e),n=Math.max(n,Math.min(s,h.chunkSize));s=Math.ceil(i/n);a=Math.ceil(e/n);for(o=0;o<a;o++)for(var h=this.preRenderedChunks[o]=this.preRenderedChunks[o]||[],r=0;r<s;r++)h[r]=this.preRenderMergedChunk(t,n,r,o,r===s-1?i-r*n:n,o===a-1?e-o*n:n)}else this.parent()},preRenderMergedChunk:function(t,i,e,s,n,a){var o=ig.$new("canvas");o.width=n;o.height=a;o.style.width=n+"px";o.style.height=a+"px";o.retinaResolutionEnabled=!1;var h=ig.system.context,r=o.getContext("2d");ig.System.scaleMode(o,r);ig.system.context=r;for(var r=0,l=t.length;r<l;r++)this.preRenderChunk(e,s,n,a,t[r],i,o);ig.system.context=h;return o},preRenderChunk:function(t,i,e,s,n,a,o){n=n||this;a=a||this.chunkSize;var h;if(!o){o=ig.$new("canvas");o.width=e;o.height=s;o.style.width=e+"px";o.style.height=s+"px";o.retinaResolutionEnabled=!1;var r=o.getContext("2d");ig.System.scaleMode(o,r);h=ig.system.context;ig.system.context=r}e=e/n.tilesize/ig.system.scale+1;s=s/n.tilesize/ig.system.scale+1;var r=t*a/ig.system.scale%n.tilesize,l=i*a/ig.system.scale%n.tilesize;t=Math.floor(t*a/n.tilesize/ig.system.scale);i=Math.floor(i*a/n.tilesize/ig.system.scale);for(a=0;a<e;a++)for(var g=0;g<s;g++)if(a+t<n.width&&g+i<n.height){var u=n.data[g+i][a+t];u&&n.tiles.drawTile(a*n.tilesize-r,g*n.tilesize-l,u-1,n.tilesize)}h&&(ig.system.context=h);return o},draw:function(){this.setScreenPos(ig.game.screen.x,ig.game.screen.y);this.tiles.loaded&&this.enabled&&(this.preRender?(this.preRenderedScale!==ig.system.scale&&(this.preRenderedChunks=null),this.drawPreRendered()):this.drawTiled())}})});ig.baked=!0;ig.module("plusplus.core.collision-map").requires("impact.collision-map","plusplus.core.config").defines(function(){var t=ig.CONFIG;ig.CollisionMap.inject({trace:function(t,i,e,s,n,a,o){o.collision.x=o.collision.y=o.collision.slope=!1;o.pos.x=t;o.pos.y=i;o.tile.x=o.tile.y=0;var h=Math.ceil(Math.max(Math.abs(e),Math.abs(s))/this.tilesize);if(1<h)for(var r=e/h,l=s/h,g=0;g<h&&(r||l)&&!(this._traceStep(o,t,i,r,l,n,a,e,s,g),t=o.pos.x,i=o.pos.y,o.collision.x&&(e=r=0),o.collision.y&&(s=l=0),o.collision.slope);g++);else this._traceStep(o,t,i,e,s,n,a,e,s,0);return o},_traceStep:function(t,i,e,s,n,a,o,h,r,l){t.pos.x+=s;t.pos.y+=n;var g=0,u,c,d,p,m;if(s){var y=0<s?a:0,f=0>s?this.tilesize:0,g=Math.max(Math.floor(e/this.tilesize),0),E=Math.min(Math.ceil((e+o)/this.tilesize),this.height);s=Math.floor((t.pos.x+y)/this.tilesize);var T=Math.floor((i+y)/this.tilesize);if(0<l||s==T||0>T||T>=this.width)T=-1;if(0<=s&&s<this.width)for(var A=g;A<E&&!(-1!=T&&(g=this.data[A][T],1<g&&g<=this.lastSlope&&this._checkTileDef(t,g,i,e,h,r,a,o,T,A)&&0!==t.slope.ny));A++)if(g=this.data[A][s],1==g||g>this.lastSlope||1<g&&this._checkTileDef(t,g,i,e,h,r,a,o,s,A)){t.tile.x=g;t.tile.xPos.x=s;t.tile.xPos.y=A;if(1<g&&g<=this.lastSlope&&t.collision.slope){u=!0;c=t.slope.x;d=t.slope.y;p=t.slope.nx;m=t.slope.ny;break}t.collision.x=!0;i=t.pos.x=s*this.tilesize-y+f;h=0;break}}if(n){y=0<n?o:0;n=0>n?this.tilesize:0;g=Math.max(Math.floor(t.pos.x/this.tilesize),0);f=Math.min(Math.ceil((t.pos.x+a)/this.tilesize),this.width);A=Math.floor((t.pos.y+y)/this.tilesize);E=Math.floor((e+y)/this.tilesize);if(0<l||A==E||0>E||E>=this.height)E=-1;if(0<=A&&A<this.height)for(s=g;s<f&&!(-1!=E&&(g=this.data[E][s],1<g&&g<=this.lastSlope&&this._checkTileDef(t,g,i,e,h,r,a,o,s,E)&&0!==t.slope.nx));s++)if(g=this.data[A][s],1==g||g>this.lastSlope||1<g&&this._checkTileDef(t,g,i,e,h,r,a,o,s,A)){t.tile.y=g;t.tile.yPos.x=s;t.tile.yPos.y=A;if(1<g&&g<=this.lastSlope&&t.collision.slope)break;t.collision.y=!0;t.pos.y=A*this.tilesize-y+n;break}}u&&(t.slope.x=c,t.slope.y=d,t.slope.nx=p,t.slope.ny=m)},_checkTileDef:function(t,i,e,s,n,a,o,h,r,l){var g=this.tiledef[i];if(!g)return!1;i=(g[2]-g[0])*this.tilesize;var u=(g[3]-g[1])*this.tilesize,c=g[4];o=e+n+(0>u?o:0)-(r+g[0])*this.tilesize;h=s+a+(0<i?h:0)-(l+g[1])*this.tilesize;if(0<i*h-u*o){if(0>n*-u+a*i)return c;r=Math.sqrt(i*i+u*u);l=u/r;r=-i/r;var d=o*l+h*r,g=l*d,d=r*d;if(g*g+d*d>=n*n+a*a)return c||.5>i*(h-a)-u*(o-n);t.pos.x=e+n-g;t.pos.y=s+a-d;t.collision.slope=!0;t.slope.x=i;t.slope.y=u;t.slope.nx=l;t.slope.ny=r;return!0}}});var i=ig.CollisionMap.defaultTileDef,e;for(e in t.COLLISION.TILES_HASH_WALKABLE_STRICT)i[e]=null;i[t.COLLISION.TILE_SOLID]=[0,0,1,0,!0];i[t.COLLISION.TILE_CLIMBABLE_WITH_TOP]=[0,0,1,0,!1];i[t.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP]=[0,0,1,0,!1]});ig.baked=!0;ig.module("plusplus.core.pathfinding-map").requires("impact.map","plusplus.core.config","plusplus.core.image").defines(function(){var t=ig.CONFIG;ig.PathfindingMap=ig.Map.extend({tiledef:null,init:function(i,e,s){this.parent(i,e);this.tiledef=s||t.PATHFINDING.TILE_DEF}})});ig.baked=!0;ig.module("plusplus.core.animation").requires("impact.animation","plusplus.core.config","plusplus.core.image","plusplus.core.image-drawing","plusplus.helpers.signals").defines(function(){ig.AnimationSheet.inject({init:function(t,i,e){if(!i||0>i)i=this.width;if(!e||0>e)e=this.height;this.parent(t,i,e)}});ig.AnimationExtended=ig.Animation.extend({frameTime:1,sequence:[],pivot:null,stop:!1,changed:!1,once:!1,reverse:!1,texturing:null,textureWidth:0,textureHeight:0,opaqueOffset:null,onCompleted:null,_texturingDeferred:!1,init:function(t,i){this.sheet=t;this.pivot={x:.5*t.width,y:.5*t.height};ig.merge(this,i);this.tile=this.sequence[0];this.timer=new ig.Timer;this.onCompleted=new ig.Signal},getDuration:function(){return this.frameTime*this.sequence.length},texturize:function(t){if(this.sheet.image.loaded){var i=this.sheet.image.scaleCache&&this.sheet.image.scaleCache.x1||this.sheet.image.data,e=t.getSizeDrawX(),s=t.getSizeDrawY(),n=this.sheet.width,a=this.sheet.height,o=this.textureWidth!==e||this.textureHeight!==s;if(n<e||a<s){this.texturing=t;this.texturing.textures=this.texturing.textures||{};this.texturing.texturedAnimsCount=(this.texturing.texturedAnimsCount||0)+1;t=0;for(var h=this.sequence.length;t<h;t++){var r=this.sequence[t],l=this.texturing.textures[r],g;l?o&&(l.setDimensions(e,s),g=!0):(l=this.texturing.textures[r]=new ig.ImageDrawing({width:e,height:s}),g=!0);if(g){var u=ig.$new("canvas");u.width=n;u.height=a;u.style.width=n+"px";u.style.height=a+"px";u.retinaResolutionEnabled=!1;var c=u.getContext("2d");ig.System.scaleMode(u,c);c.drawImage(i,-Math.floor(r*n)%i.width,-Math.floor(r*a/i.width)*a);l.dataContext.fillStyle=l.dataContext.createPattern(u,"repeat");l.dataContext.fillRect(0,0,e,s);l.finalize()}}this.textureWidth=e;this.textureHeight=s}}else this._texturingDeferred=t,this.sheet.image.onLoaded.remove(this._texturizeDeferred,this),this.sheet.image.onLoaded.addOnce(this._texturizeDeferred,this)},_texturizeDeferred:function(){this.texturize(this._texturingDeferred);this._texturingDeferred=void 0},detexturize:function(){this.texturing&&(this.texturing.texturedAnimsCount=Math.max(0,this.texturing.texturedAnimsCount-1),this.texturing.texturedAnimsCount||(this.texturing.textures=void 0),this.sheet.image.onLoaded.remove(this._texturizeDeferred,this),this.texturing=this.textureWidth=this.textureHeight=this._texturingDeferred=void 0)},playFromStart:function(t,i){this.stop=!1;this.rewind(t,i)},rewind:function(t,i){this.once="undefined"!==typeof t?t:this.once;this.reverse="undefined"!==typeof i?i:this.reverse;return this.parent()},gotoFrame:function(t){var i=this.stop;this.stop=!1;this.parent(t);this.stop=i},update:function(){if(!this.stop){var t=this.loopCount,i=this.sequence.length,e=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(e/i);this.frame=this.reverse?this.sequence.length-1-e%i:e%i;this.loopCount>t&&(this.once&&(this.once=!1,this.stop=!0,this.frame=i-1),this.onCompleted.dispatch());t=this.tile;this.tile=this.sequence[this.frame];this.changed=1<i&&this.tile!==t?!0:!1}},draw:function(t,i,e,s){1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);if(s=s||this.texturing)if((this.texturing!==s||this.textureWidth!==this.texturing.sizeDraw.x||this.textureHeight!==this.texturing.sizeDraw.y)&&this.texturize(s),s=this.texturing&&this.texturing.textures&&this.texturing.textures[this.tile])s.draw(t,i,void 0,void 0,void 0,void 0,e);else return this.draw(t,i,e);else 0===this.angle?this.sheet.image.drawTile(t,i,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y,e):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(t+this.pivot.x),ig.system.getDrawPos(i+this.pivot.y)),ig.system.context.rotate(this.angle),this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y,e),ig.system.context.restore());1!==this.alpha&&(ig.system.context.globalAlpha=1)}});ig.global.wm&&ig.AnimationExtended.inject({computeDrawCount:5,computeDrawCountMax:5,draw:function(t,i){this.texturing&&(this.computeDrawCount>=this.computeDrawCountMax?(this.computeDrawCount=0,this.texturing.recordChanges(!0),(this.textureWidth*ig.system.scale!==this.texturing.getSizeDrawX()*ig.system.scale||this.textureHeight*ig.system.scale!==this.texturing.getSizeDrawY()*ig.system.scale)&&this.texturize(this.texturing)):this.computeDrawCount++);this.parent(t,i)}})});ig.baked=!0;ig.module("plusplus.helpers.tweens").requires("plusplus.core.config").defines(function(){var t=ig.CONFIG,i;if(!(i=n)){var e=[],s=!1;i={REVISION:"9",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){s?t.pause():t.unpause();e.push(t)},remove:function(t){t=e.indexOf(t);-1!==t&&e.splice(t,1)},pause:function(){if(!s){s=!0;for(var t=0,i=e.length;t<i;t++)e[t].pause()}},unpause:function(){if(s){s=!1;for(var t=0,i=e.length;t<i;t++)e[t].unpause()}},update:function(t){if(0===e.length||s)return!1;var i=0,n=e.length;for(t=void 0!==t?t:void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now();i<n;)e[i].update(t)?i++:(e.splice(i,1),n--);return!0}}}var n=i;n.Tween=function(i){var e={},s={},a={},o=t.DURATION_TWEEN,h=0,r=0,l=null,g=!1,u=0,c=n.Easing.Linear.None,d=n.Interpolation.Linear,p=[],m=null,y=!1,f=null,E=null;this.to=function(t,i){void 0!==i&&(o=i);s=t;return this};this.start=function(t){n.add(this);y=!1;l=void 0!==t?t:void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now();l+=r;for(var o in s)if(!(!1===o in i||null===i[o])){if(s[o]instanceof Array){if(0===s[o].length)continue;s[o]=[i[o]].concat(s[o])}e[o]=i[o];!1==e[o]instanceof Array&&(e[o]*=1);a[o]=e[o]}return this};this.stop=function(){n.remove(this);return this};this.pause=function(){g||(g=!0,u=void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now());return this};this.unpause=function(){g&&(g=!1,l+=(void 0!==ig.global.performance&&void 0!==ig.global.performance.now?ig.global.performance.now():Date.now())-u,u=0);return this};this.delay=function(t){r=t;return this};this.repeat=function(t){h=t;return this};this.easing=function(t){"function"===typeof t&&(c=t);return this};this.interpolation=function(t){"function"===typeof easing&&(d=t);return this};this.chain=function(){p=arguments;return this};this.onStart=function(t){m=t;return this};this.onUpdate=function(t){f=t;return this};this.onComplete=function(t){E=t;return this};this.update=function(t){if(g||t<l)return!0;!1===y&&(m&&m.call(i),y=!0);var n=(t-l)/o,n=1<n?1:n,u=c(n),T;for(T in e){var A=e[T],v=s[T];i[T]=v instanceof Array?d(v,u):A+(v-A)*u}f&&f.call(i,u);if(1==n)if(0<h){isFinite(h)&&h--;for(T in a)e[T]=a[T];l=t+r}else{E&&E.call(i);n=0;for(u=p.length;n<u;n++)p[n].start(t);return!1}return!0}};n.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return 1>(t*=2)?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:1>(t*=2)?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var i,e=.1;if(0===t)return 0;if(1===t)return 1;!e||1>e?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI);return-(e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*2*Math.PI/.4))},Out:function(t){var i,e=.1;if(0===t)return 0;if(1===t)return 1;!e||1>e?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI);return e*Math.pow(2,-10*t)*Math.sin((t-i)*2*Math.PI/.4)+1},InOut:function(t){var i,e=.1;if(0===t)return 0;if(1===t)return 1;!e||1>e?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI);return 1>(t*=2)?-.5*e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*2*Math.PI/.4):.5*e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*2*Math.PI/.4)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){return 1>(t*=2)?.5*t*t*(3.5949095*t-2.5949095):.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)}},Bounce:{In:function(t){return 1-n.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*n.Easing.Bounce.In(2*t):.5*n.Easing.Bounce.Out(2*t-1)+.5}}};var a=[1];n.Interpolation={Linear:function(t,i){var e=t.length-1,s=e*i,a=Math.floor(s),o=n.Interpolation.Utils.Linear;return 0>i?o(t[0],t[1],s):1<i?o(t[e],t[e-1],e-s):o(t[a],t[a+1>e?e:a+1],s-a)},Bezier:function(t,i){var e=0,s=t.length-1,a=Math.pow,o=n.Interpolation.Utils.Bernstein,h;for(h=0;h<=s;h++)e+=a(1-i,s-h)*a(i,h)*t[h]*o(s,h);return e},CatmullRom:function(t,i){var e=t.length-1,s=e*i,a=Math.floor(s),o=n.Interpolation.Utils.CatmullRom;return t[0]===t[e]?(0>i&&(a=Math.floor(s=e*(1+i))),o(t[(a-1+e)%e],t[a],t[(a+1)%e],t[(a+2)%e],s-a)):0>i?t[0]-(o(t[0],t[0],t[1],t[1],-s)-t[0]):1<i?t[e]-(o(t[e],t[e],t[e-1],t[e-1],s-e)-t[e]):o(t[a?a-1:0],t[a],t[e<a+1?e:a+1],t[e<a+2?e:a+2],s-a)},Utils:{Linear:function(t,i,e){return(i-t)*e+t
},Bernstein:function(t,i){var e=n.Interpolation.Utils.Factorial;return e(t)/e(i)/e(t-i)},Factorial:function(t){var i=1,e;if(a[t])return a[t];for(e=t;1<e;e--)i*=e;return a[t]=i},CatmullRom:function(t,i,e,s,n){t=.5*(e-t);s=.5*(s-i);var a=n*n;return(2*i-2*e+t+s)*n*a+(-3*i+3*e-2*t-s)*a+t*n+i}}};ig.TWEEN=n;ig.TWEEN.Tween;ig.TWEEN.tween=function(t,i,e){e=e||{};e.tween&&e.tween.stop();t=new ig.TWEEN.Tween(t).to(i,e.duration).easing(e.easing).onStart(e.onStart).onUpdate(e.onUpdate).onComplete(e.onComplete);e.stopped||t.start();return t}});ig.baked=!0;ig.module("plusplus.helpers.utilsvector2").requires("plusplus.core.config","plusplus.helpers.utilsmath").defines(function(){var t=ig.CONFIG,i=ig.utilsmath;ig.utilsvector2={};ig.utilsvector2.vector=function(t,i,e){e=e||{};ig.utilsvector2.set(e,t||0,i||0);return e};ig.utilsvector2.set=function(t,i,e){t.x=i;t.y=e;return t};ig.utilsvector2.setScalar=function(t,i){t.x=i;t.y=i;return t};ig.utilsvector2.clone=function(t){return ig.utilsvector2.vector(t.x,t.y)};ig.utilsvector2.copy=function(t,i){t.x=i.x;t.y=i.y;return t};ig.utilsvector2.zero=function(t){t.x=0;t.y=0;return t};ig.utilsvector2.isZero=function(t){return 0===t.x&&0===t.y};ig.utilsvector2.isAlmostZero=function(e){return i.almostEqual(e.x,0,t.PRECISION_ZERO)&&i.almostEqual(e.y,0,t.PRECISION_ZERO)};ig.utilsvector2.equal=function(t,i){return t.x===i.x&&t.y===i.y};ig.utilsvector2.inverse=function(t){t.x=-t.x;t.y=-t.y;return t};ig.utilsvector2.add=function(t,i){t.x+=i.x;t.y+=i.y;return t};ig.utilsvector2.addVectors=function(t,i){return{x:t.x+i.x,y:t.y+i.y}};ig.utilsvector2.addScalar=function(t,i){t.x+=i;t.y+=i;return t};ig.utilsvector2.subtract=function(t,i){t.x-=i.x;t.y-=i.y;return t};ig.utilsvector2.subtractVectors=function(t,i){return{x:t.x-i.x,y:t.y-i.y}};ig.utilsvector2.subtractScalar=function(t,i){t.x-=i;t.y-=i;return t};ig.utilsvector2.multiply=function(t,i){t.x*=i.x;t.y*=i.y;return t};ig.utilsvector2.multiplyVectors=function(t,i){return{x:t.x*i.x,y:t.y*i.y}};ig.utilsvector2.multiplyScalar=function(t,i){t.x*=i;t.y*=i;return t};ig.utilsvector2.divide=function(t,i){t.x/=i.x;t.y/=i.y;return t};ig.utilsvector2.divideVectors=function(t,i){return{x:t.x/i.x,y:t.y/i.y}};ig.utilsvector2.divideScalar=function(t,i){t.x/=i;t.y/=i;return t};ig.utilsvector2.min=function(t,i){return{x:t.x<i.x?t.x:i.x,y:t.y<i.y?t.y:i.y}};ig.utilsvector2.max=function(t,i){return{x:t.x>i.x?t.x:i.x,y:t.y>i.y?t.y:i.y}};ig.utilsvector2.abs=function(t){0>t.x&&(t.x=-t.x);0>t.y&&(t.y=-t.y);return t};ig.utilsvector2.length=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)};ig.utilsvector2.lengthSquared=function(t){return t.x*t.x+t.y*t.y};ig.utilsvector2.normalize=function(t){var i=ig.utilsvector2.length(t);i>=Number.MIN_VALUE&&(i=1/i,t.x*=i,t.y*=i);return t};ig.utilsvector2.dot=function(t,i){return t.x*i.x+t.y*i.y};ig.utilsvector2.cross=function(t,i){return t.x*i.y-t.y*i.x};ig.utilsvector2.crossVF=function(t,i){var e=t.x;t.x=i*t.y;t.y=-i*e;return t};ig.utilsvector2.crossFV=function(t,i){var e=t.x;t.x=-i*t.y;t.y=i*e;return t};ig.utilsvector2.rotate=function(t,i,e,s){var n=Math.sin(i);i=Math.cos(i);var a=t.x-e,o=t.y-s;t.x=e+a*i-o*n;t.y=s+a*n+o*i;return t};ig.utilsvector2.projectPoints=function(t,i,e,s,n,a,o,h){i=i||0;e=e||0;s=s||1;n=n||1;a=a||0;var r=[],l,g,u;if(0!==a){o=o||0;h=h||0;l=0;for(g=t.length;l<g;l++)u=t[l],u=ig.utilsvector2.rotate(u,a,o,h),r[l]={x:u.x*s+i,y:u.y*n+e}}else{l=0;for(g=t.length;l<g;l++)u=t[l],r[l]={x:u.x*s+i,y:u.y*n+e}}return r};ig.utilsvector2.centerOfPoints=function(t){for(var i=0,e=0,s,n=0,a=t.length;n<a;n++)s=t[n],i+=s.x,e+=s.y;return{x:i/a,y:e/a}};ig.utilsvector2.pointsCW=function(t,i,e){return(i.x-t.x)*(e.y-t.y)-(i.y-t.y)*(e.x-t.x)};ig.utilsvector2.radianBetweenPoints=function(t,i,e){var s=i.x-t.x;t=i.y-t.y;var n=i.x-e.x;i=i.y-e.y;return Math.atan2(s*i-t*n,s*n+t*i)};ig.utilsvector2.pointsToConvexHull=function(t){if(3>t.length)return t;var i,e,s=0,n=t[s],a;i=1;for(e=t.length;i<e;i++)a=t[i],a.y===n.y?a.x<n.x&&(s=i,n=a):a.y<n.y&&(s=i,n=a);var o=[],h;i=0;for(e=t.length;i<e;i++)i!==s&&(a=t[i],h={x:a.x,y:a.y},h.angle=Math.atan((a.y-n.y)/(a.x-n.x)),0>h.angle&&(h.angle+=Math.PI),h.distance=(a.x-n.x)*(a.x-n.x)+(a.y-n.y)*(a.y-n.y),h.index=i,o.push(h));o.sort(function(t,i){return t.angle<i.angle?-1:t.angle>i.angle?1:t.distance<i.distance?-1:t.distance>i.distance?1:0});o.unshift(o[o.length-1],{x:n.x,y:n.y,index:s});s=2;i=3;for(e=t.length;i<=e;i++){for(;0>=ig.utilsvector2.pointsCW(o[s-1],o[s],o[i]);)s--;s++;n=o[i];o[i]=o[s];o[s]=n}e=[];for(i=0;i<=s;i++)e[i]=t[o[i].index];return e};ig.utilsvector2.Q_1=1;ig.utilsvector2.Q_2=4;ig.utilsvector2.Q_3=8;ig.utilsvector2.Q_4=16;ig.utilsvector2.pointQuadrant=function(t,i,e,s){t=e-t;s-=i;0===t&&0===s?i=ig.utilsvector2.Q_1|ig.utilsvector2.Q_2|ig.utilsvector2.Q_3|ig.utilsvector2.Q_4:0===t?i=0>s?ig.utilsvector2.Q_3|ig.utilsvector2.Q_4:ig.utilsvector2.Q_1|ig.utilsvector2.Q_2:0===s?i=0>t?ig.utilsvector2.Q_2|ig.utilsvector2.Q_4:ig.utilsvector2.Q_1|ig.utilsvector2.Q_3:(i=1,0>t&&(i=2),0>s&&(i+=2),i=1<<i);return i};ig.utilsvector2.directionThreshold=function(t,e,s){e=e||0;s=s||0;s<e?(0!==t.y&&i.almostEqual(t.x,0,e)&&(t.x=0),0!==t.x&&i.almostEqual(t.y,0,s)&&(t.y=0)):(0!==t.x&&i.almostEqual(t.y,0,s)&&(t.y=0),0!==t.y&&i.almostEqual(t.x,0,e)&&(t.x=0));return t};ig.utilsvector2.directionToString=function(t){var e=i.direction(t.x);t=i.direction(t.y);for(var s in ig.utilsvector2.DIRECTION){var n=ig.utilsvector2.DIRECTION[s];if(n.x===e&&n.y===t)return s}return"NONE"};ig.utilsvector2.DIRECTION={NONE:ig.utilsvector2.vector(),LEFT:ig.utilsvector2.vector(-1,0),RIGHT:ig.utilsvector2.vector(1,0),UP:ig.utilsvector2.vector(0,-1),DOWN:ig.utilsvector2.vector(0,1),UPLEFT:ig.utilsvector2.vector(-1,-1),UPRIGHT:ig.utilsvector2.vector(1,-1),DOWNLEFT:ig.utilsvector2.vector(-1,1),DOWNRIGHT:ig.utilsvector2.vector(1,1)}});ig.baked=!0;ig.module("plusplus.helpers.utilsintersection").requires("plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2").defines(function(){var t=ig.utilsmath,i=ig.utilsvector2;ig.utilsintersection={};ig.utilsintersection.bounds=function(t,i,e,s,n){n=n||{};n.minX=t;n.minY=i;n.maxX=t+e;n.maxY=i+s;n.width=e;n.height=s;return n};ig.utilsintersection.boundsMinMax=function(t,i,e,s,n){n=n||{};n.minX=t;n.minY=i;n.maxX=e;n.maxY=s;n.width=e-t;n.height=s-i;return n};ig.utilsintersection.boundsOfPoints=function(t,i){var e,s,n=t[0],a=n.x,o=n.y,h=n.x,r=n.y;e=1;for(s=t.length;e<s;e++)n=t[e],n.x<a?a=n.x:n.x>h&&(h=n.x),n.y<o?o=n.y:n.y>r&&(r=n.y);i=i||{};i.minX=a;i.minY=o;i.maxX=h;i.maxY=r;i.width=h-a;i.height=r-o;return i};ig.utilsintersection.boundsClone=function(t,i,e,s){i=i||0;e=e||0;var n=t.minX+i,a=t.minY+e;i=t.maxX+i;t=t.maxY+e;s=s||{};s.minX=n;s.minY=a;s.maxX=i;s.maxY=t;s.width=i-n;s.height=t-a;return s};ig.utilsintersection.boundsCopy=function(t,i,e,s,n,a){e=e||0;s=s||0;n=n||1;a=a||1;t.minX=i.minX*n+e;t.maxX=i.maxX*n+e;t.minY=i.minY*a+s;t.maxY=i.maxY*a+s;t.width=t.maxX-t.minX;t.height=t.maxY-t.minY;return t};ig.utilsintersection.boundsCopyX=function(t,i,e,s){e=e||0;s=s||1;t.minX=i.minX*s+e;t.maxX=i.maxX*s+e;t.width=t.maxX-t.minX;return t};ig.utilsintersection.boundsCopyY=function(t,i,e,s){e=e||0;s=s||1;t.minY=i.minY*s+e;t.maxY=i.maxY*s+e;t.height=t.maxY-t.minY;return t};ig.utilsintersection.boundsCopyRotated=function(i,e,s){s%=t.TWOPI;s>Math.PI?s-=t.TWOPI:s<-Math.PI&&(s+=t.TWOPI);var n=Math.cos(s),a=Math.sin(s),o=e.width,h=e.height,r=h*n,l=o*n,h=h*a,o=o*a,g=e.minX,u=e.minY,c=g+.5*e.width;e=u+.5*e.height;g-=c;u-=e;c=c+g*n-u*a;n=e+g*a+u*n;0<s?s<t.HALFPI?(i.minY=n,i.maxY=n+r+o,i.minX=c-h,i.maxX=c+l):(i.minY=n+r,i.maxY=n+o,i.minX=c-h+l,i.maxX=c):s<-t.HALFPI?(i.minY=n+o,i.maxY=n+r,i.minX=c,i.maxX=c+l-h):(i.minY=n+o+r,i.maxY=n,i.minX=c+l,i.maxX=c-h);i.width=i.maxX-i.minX;i.height=i.maxY-i.minY;return i};ig.utilsintersection.AABBContains=function(t,i,e,s,n,a,o,h){return t>=n&&e<=o&&i>=a&&s<=h?!0:!1};ig.utilsintersection.AABBIntersect=function(t,i,e,s,n,a,o,h){return e<n||t>o||s<a||i>h?!1:!0};ig.utilsintersection.boundsIntersect=function(t,i){return t.maxX<i.minX||t.minX>i.maxX||t.maxY<i.minY||t.minY>i.maxY?!1:!0};ig.utilsintersection.boundsAABBIntersect=function(t,i,e,s,n){return t.maxX<i||t.minX>s||t.maxY<e||t.minY>n?!1:!0};ig.utilsintersection.pointInAABB=function(t,i,e,s,n,a){return t<e||t>n||i<s||i>a?!1:!0};ig.utilsintersection.pointInBounds=function(t,i,e){return t<e.minX||t>e.maxX||i<e.minY||i>e.maxY?!1:!0};ig.utilsintersection.pointInCircle=function(t,i,e,s,n){t=e-t;i=s-i;return t*t+i*i<n*n};ig.utilsintersection.pointInPolygon=function(t,i,e){var s,n=e.length-1,a=!1;for(s=0;s<e.length;s++){var n=e[n],o=e[s];if(n.x===t&&n.y===i||o.x===t&&o.y===i){a=!0;break}else if((o.y<i&&n.y>=i||n.y<i&&o.y>=i)&&(o.x<=t||n.x<=t))o.x+(i-o.y)/(n.y-o.y)*(n.x-o.x)<t&&(a=!a);n=s}return a};ig.utilsintersection.entitiesInAABB=function(t,i,e,s,n,a,o){var h=[],r,l;if(a){r=ig.game.layersMap[a];n=n?r.itemsTargetable:r.items;a=0;for(l=n.length;a<l;a++){r=n[a];var g;if(r.fixed){g=ig.game.screen.x;var u=ig.game.screen.y;g=ig.utilsintersection.AABBIntersect(r.pos.x+g,r.pos.y+u,r.pos.x+r.size.x*r.scaleMod+g,r.pos.y+r.size.y*r.scaleMod+u,t,i,e,s)}else g=ig.utilsintersection.AABBIntersect(r.pos.x,r.pos.y,r.pos.x+r.size.x*r.scaleMod,r.pos.y+r.size.y*r.scaleMod,t,i,e,s);g&&h.push(r)}}else{a=0;for(l=ig.game.layers.length;a<l;a++)if(r=ig.game.layers[a],r.name&&r.numEntities&&(!n||r.itemsTargetable.length))h=h.concat(ig.utilsintersection.entitiesInAABB(t,i,e,s,n,r.name,!0))}1<h.length&&!o&&ig.utilsintersection.sortByDistance(t+.5*(e-t),i+.5*(s-i),h);return h};ig.utilsintersection.getIsAABBInScreen=function(t,i,e,s){t-=ig.game.screen.x;i-=ig.game.screen.y;return ig.utilsintersection.AABBIntersect(t,i,t+e,i+s,0,0,ig.system.width,ig.system.height)};ig.utilsintersection.sortByDistance=function(t,e,s){var n=i.set(ig.utilsintersection._utilVec2Sort,t,e);s.sort(function(t,i){var e=t.distanceSquaredEdgeTo(n),s=i.distanceSquaredEdgeTo(n);return e-s||t.distanceSquaredTo(n)-i.distanceSquaredTo(n)});return s};ig.utilsintersection._utilVec2Sort={x:.1,y:.1}});ig.baked=!0;ig.module("plusplus.helpers.utilsdraw").requires("plusplus.helpers.utilsintersection").defines(function(){var t=ig.utilsintersection;ig.utilsdraw={};ig.utilsdraw.pixelFillPolygon=function(i,e,s,n,a,o,h,r,l,g,u,c,d){e|=0;s|=0;var p,m;c?(p=c.minX|0,m=c.minY|0,n=Math.ceil(c.maxX),a=Math.ceil(c.maxY)):(p=e,m=s,n=Math.ceil(n),a=Math.ceil(a));!1!==d?(e=p-e-1,s=m-s-1,n=n-p+1,d=a-m+1):(e=p-e,s=m-s,n-=p,d=a-m);h=255*h|0;r=255*r|0;l=255*l|0;g=255*g|0;a=i.getImageData(e,s,n,d);if(!0===u)for(u=0;u<n;u++)for(c=0;c<d;c++){if(t.pointInPolygon(u+p,c+m,o)){var y=4*(u+c*n);a.data[y]+=h;a.data[y+1]+=r;a.data[y+2]+=l;a.data[y+3]+=g}}else for(u=0;u<n;u++)for(c=0;c<d;c++)t.pointInPolygon(u+p,c+m,o)&&(y=4*(u+c*n),a.data[y]=h,a.data[y+1]=r,a.data[y+2]=l,a.data[y+3]=g);i.putImageData(a,e,s)};ig.utilsdraw.fillPolygon=function(t,i,e,s,n){e=e||0;s=s||0;n=n||1;var a=i[0];t.beginPath();t.moveTo((a.x+e)*n,(a.y+s)*n);for(var o=1,h=i.length;o<h;o++)a=i[o],t.lineTo((a.x+e)*n,(a.y+s)*n);t.fill()};ig.utilsdraw.fillRoundedRect=function(t,i,e,s,n,a){t.beginPath();t.moveTo(i+a,e);t.lineTo(i+s-a,e);t.quadraticCurveTo(i+s,e,i+s,e+a);t.lineTo(i+s,e+n-a);t.quadraticCurveTo(i+s,e+n,i+s-a,e+n);t.lineTo(i+a,e+n);t.quadraticCurveTo(i,e+n,i,e+n-a);t.lineTo(i,e+a);t.quadraticCurveTo(i,e,i+a,e);t.closePath();t.fill()};ig.utilsdraw.pixelFillRoundedRect=function(t,i,e,s,n,a,o,h,r,l,g,u,c,d,p,m,y){"undefined"===typeof p&&(p=Math.round(.25*l));var f=.5*Math.PI/(p+1),E=function(t,i,e){for(var s=0;s<p;s++)e+=f,T.push({x:t+l*Math.cos(e),y:i+l*Math.sin(e)})},T=[];T.push({x:a+l,y:o});T.push({x:a+h-l,y:o});0<p&&E(a+h-l,o+l,1.5*Math.PI);T.push({x:a+h,y:o+l});T.push({x:a+h,y:o+r-l});0<p&&E(a+h-l,o+r-l,0);T.push({x:a+h-l,y:o+r});T.push({x:a+l,y:o+r});0<p&&E(a+l,o+r-l,.5*Math.PI);T.push({x:a,y:o+r-l});T.push({x:a,y:o+l});0<p&&E(a+l,o+l,Math.PI);ig.utilsdraw.pixelFillPolygon(t,i,e,s,n,T,g,u,c,d,m,ig.utilsintersection.bounds(a,o,h,r),y)}});ig.baked=!0;ig.module("plusplus.helpers.utilscolor").defines(function(){ig.utilscolor={};ig.utilscolor.hexToRGBA=function(t){t=Math.floor(t);var i={};i.r=(t>>24&255)/255;i.g=(t>>16&255)/255;i.b=(t>>8&255)/255;i.a=(t&255)/255;return i};ig.utilscolor.RGBAToHex=function(t,i,e,s){return 255*t<<24^255*i<<16^255*e<<8^255*s<<0};ig.utilscolor.RGBToHex=function(t,i,e){return 255*t<<16^255*i<<8^255*e<<0};var t=ig.utilscolor,i=ig.$new("canvas");i.width=i.height=1;var e=i.getContext("2d");t.CSSToRGBA=function(t,i){e.clearRect(0,0,1,1);e.fillStyle=t;e.fillRect(0,0,1,1);var s=e.getImageData(0,0,1,1).data,n={};n.r=s[0]/255;n.g=s[1]/255;n.b=s[2]/255;n.a=i;return n};ig.utilscolor.RGBAToCSS=function(t,i,e,s){return"rgba("+(255*t|0)+","+(255*i|0)+","+(255*e|0)+","+s+")"};ig.utilscolor.RGBToCSS=function(t,i,e){return"rgb("+(255*t|0)+","+(255*i|0)+","+(255*e|0)+")"};ig.utilscolor.linearGradient=function(t,i,e,s,n){t=ig.system.context.createLinearGradient(t,i,e,s);i=1/(n.length-1);e=0;for(s=n.length;e<s;e++){var a=n[e],a="object"===typeof a?"undefined"!==typeof a.a?ig.utilscolor.RGBAToCSS(a.r,a.g,a.b,a.a):ig.utilscolor.RGBToCSS(a.r,a.g,a.b):a;t.addColorStop(e*i,a)}return t};ig.utilscolor.radialGradient=function(t,i){for(var e=ig.system.context.createRadialGradient(t,t,0,t,t,t),s=1/(i.length-1),n=0,a=i.length;n<a;n++){var o=i[n],o="object"===typeof o?"undefined"!==typeof o.a?ig.utilscolor.RGBAToCSS(o.r,o.g,o.b,o.a):ig.utilscolor.RGBToCSS(o.r,o.g,o.b):o;e.addColorStop(n*s,o)}return e}});ig.baked=!0;ig.module("plusplus.helpers.utilstile").requires("plusplus.core.config","plusplus.core.collision-map","plusplus.helpers.utils","plusplus.helpers.utilsintersection","plusplus.helpers.utilsvector2").defines(function(){var t=ig.CONFIG,i=ig.utils,e=ig.utilsintersection,s=ig.utilsvector2,n=t.COLLISION.TILE_ONE_WAY_DOWN,a=t.COLLISION.TILE_ONE_WAY_RIGHT,o=t.COLLISION.TILE_ONE_WAY_LEFT,h=t.COLLISION.TILES_HASH_WALKABLE,r=t.COLLISION.TILES_HASH_WALKABLE_STRICT,l=t.COLLISION.TILES_HASH_ONE_WAY,g=t.COLLISION.TILES_HASH_CLIMBABLE,u=t.COLLISION.TILES_HASH_CLIMBABLE_ONE_WAY,c=t.COLLISION.TILES_HASH_CLIMBABLE_STAIRS;ig.utilstile={};ig.utilstile.defaultTileVerticesDef={};ig.utilstile.defaultTileSegmentsDef={};var d=null,p=null;ig.utilstile.rebuild=function(t){if(t instanceof ig.CollisionMap&&t.tiledef!==p){ig.utilstile.unload();d=t;p=d.tiledef||ig.CollisionMap.defaultTileDef;for(var i in p)ig.utilstile.shapeFromTile(i,p);ig.utilstile.shapeFromTile(1,p)}else d=t};ig.utilstile.unload=function(){d=null;p=ig.CollisionMap.defaultTileDef;ig.utilstile.defaultTileVerticesDef={};ig.utilstile.defaultTileSegmentsDef={}};ig.utilstile.isTileWalkable=function(t){return h[t]};ig.utilstile.isTileWalkableStrict=function(t){return r[t]};ig.utilstile.isTileOneWay=function(t){return l[t]};ig.utilstile.isTileClimbable=function(t){return g[t]};ig.utilstile.isTileClimbableStairs=function(t){return c[t]};ig.utilstile.isTileClimbableOneWay=function(t){return u[t]};ig.utilstile.shapesFromCollisionMap=function(t,i){var e={oneWays:[],solids:[],climbables:[]};if(t instanceof ig.CollisionMap){i=i?ig.copy(i,{}):{};var s=ig.copy(t.data),h=t.tilesize,r=t.width,d=t.height,p=[],m=[],y=[],f,E,T,A,v,x,_,I,C,S;for(x=0;x<d;x++)for(v=0;v<r;v++){S=ig.utilstile.shapeFromTile(t.data[x][v],t.tiledef);C={id:t.data[x][v],ix:v,iy:x,x:v*h,y:x*h,width:h,height:h,shape:S};if(0<S.vertices.length){E=[];f=S.vertices;T=S.segments;_=0;for(I=T.length;_<I;_++){A=T[_];var O=f[A.a];E[A.a]={x:C.x+O.x*h,y:C.y+O.y*h}}S.vertices=E;g[C.id]?i.ignoreClimbables||m.push(C):l[C.id]?i.ignoreOneWays||y.push(C):i.ignoreSolids||p.push(C)}s[x][v]=C}h=i.rectangles;e.solids=e.solids.concat(ig.utilstile.shapedTilesToShapes(p,s,i));"undefined"===typeof i.groupByTileId&&(i.groupByTileId=!0);i.rectangles="undefined"!==typeof h?h:!i.contourClimbables;e.climbables=e.climbables.concat(ig.utilstile.shapedTilesToShapes(m,s,i));_=0;for(I=e.climbables.length;_<I;_++)S=e.climbables[_],u[S.id]?S.settings.oneWay=!0:S.settings.sensor=!0,c[S.id]&&(S.settings.climbableStairs=!0);i.rectangles="undefined"!==typeof h?h:!i.contourOneWays;e.oneWays=e.oneWays.concat(ig.utilstile.shapedTilesToShapes(y,s,i));_=0;for(I=e.oneWays.length;_<I;_++)S=e.oneWays[_],l[S.id]&&(S.settings.oneWay=!0,S.id===n?S.settings.oneWayFacing={x:0,y:1}:S.id===a?S.settings.oneWayFacing={x:1,y:0}:S.id===o&&(S.settings.oneWayFacing={x:-1,y:0}))}return e};ig.utilstile.shapedTilesToShapes=function(t,e,s){s=s||{};var n=[],a=[],o=[],h,r,l,g;if(s.groupByTileId){delete s.groupByTileId;var o=[],u={};h=0;for(r=t.length;h<r;h++)a=t[h],u[a.id]?u[a.id].push(a):(o.push(a.id),u[a.id]=[a]);h=0;for(r=o.length;h<r;h++)t=o[h],a=u[t],s.id=t,n=n.concat(ig.utilstile.shapedTilesToShapes(a,e,s))}else{if(s.rectangles){h=t.slice(0);for(t=[];0<h.length;){r=ig.utilstile.findShapedTileLine(h);i.arrayCautiousRemoveMulti(h,r);a=r.length;u=r;for(l=!0;l;)if(l=!1,g=r[0],g=e[g.iy][g.ix+1])g=i.indexOfValue(h,g),-1!==g&&(r=ig.utilstile.findShapedTileLine(h,!1,g,a),r.length===a&&(i.arrayCautiousRemoveMulti(h,r),u=u.concat(r),l=!0));0<u.length&&t.push(u)}l=0;for(g=t.length;l<g;l++){u=t[l];a=[];h=0;for(r=u.length;h<r;h++)a=a.concat(ig.utilstile.getNonDuplicateSegmentVertices(u[h],e,u));o=o.concat(ig.utilstile.verticesToContours(a,s))}}else{h=0;for(r=t.length;h<r;h++)a=a.concat(ig.utilstile.getNonDuplicateSegmentVertices(t[h],e,t));o=ig.utilstile.verticesToContours(a,s)}h=0;for(r=o.length;h<r;h++)e=o[h],n.push({id:s.id,x:e.minX,y:e.minY,settings:{size:{x:e.width,y:e.height},vertices:e.vertices}})}return n};ig.utilstile.findShapedTileLine=function(t,i,e,s){s=s||0;e=t[e||0];for(var n=[],a=!0;a;){a=!1;n.push(e);if(n.length===s)break;var o=i?ig.utilstile.stepShapedTileHorizontally(t,e):ig.utilstile.stepShapedTileVertically(t,e);e!==o&&(a=!0,e=o)}return n};ig.utilstile.stepShapedTileHorizontally=function(t,i){for(var e=0,s=t.length;e<s;e++){var n=t[e];if(i.iy===n.iy&&i.ix+1===n.ix)return n}return i};ig.utilstile.stepShapedTileVertically=function(t,i){for(var e=0,s=t.length;e<s;e++){var n=t[e];if(i.ix===n.ix&&i.iy+1===n.iy)return n}return i};ig.utilstile.verticesToContours=function(t,n){var a=[];if(1<t.length){n=n||{};for(var o=t.slice(0),h={vertices:[],minX:Number.MAX_VALUE,minY:Number.MAX_VALUE,maxX:-Number.MAX_VALUE,maxY:-Number.MAX_VALUE},r=h.vertices,l=o.pop(),g=o.pop(),u,c,d,p,m,y;-2<o.length;){g=!1;d=r[0];if(2>=r.length||l.x!==d.x||l.y!==d.y){p=0;for(m=o.length;p<m;p+=2)if(u=o[p],c=o[p+1],l.x===u.x&&l.y===u.y){g=!0;break}}r.push(l);l.x<h.minX&&(h.minX=l.x);l.x>h.maxX&&(h.maxX=l.x);l.y<h.minY&&(h.minY=l.y);l.y>h.maxY&&(h.maxY=l.y);if(!0===g)o.splice(p,2),g=u,l=c;else if(3<=h.vertices.length&&a.push(h),0<o.length)h={vertices:[]},h.minX=h.minY=Number.MAX_VALUE,h.maxX=h.maxY=-Number.MAX_VALUE,r=h.vertices,l=o.pop(),g=o.pop();else break}p=0;for(m=a.length;p<m;p++)h=a[p],h.width=h.maxX-h.minX,h.height=h.maxY-h.minY;a.sort(function(t,i){return i.width*i.width+i.height*i.height-(t.width*t.width+t.height*t.height)});m=a.slice(0);r=[];g=[];for(h=m.pop();-1<m.length;){l=!1;if(h){for(p=a.length-1;-1<p;p--)if(y=a[p],h!==y&&e.AABBContains(h.minX,h.minY,h.maxX,h.maxY,y.minX,y.minY,y.maxX,y.maxY)){l=!0;break}g.push(h)}if(l)i.arrayCautiousRemove(m,y),h=y;else if(1<g.length&&r.push(g),0<m.length)g=[],h=m.pop();else break}d=[];o=[];p=0;for(m=r.length;p<m;p++){g=r[p];u=g[g.length-1];c=g[g.length-2];y=0===g.length%2?0:1;for(l=g.length;y<l;y+=2)h=g[y],-1===i.indexOfValue(d,h)&&(h.vertices.reverse(),d.push(h));!n.retainBoundaryOuter&&-1===i.indexOfValue(o,u)&&(o.push(u),i.arrayCautiousRemove(a,u));n.discardBoundaryInner&&-1===i.indexOfValue(o,c)&&(o.push(c),i.arrayCautiousRemove(a,c));n.discardEdgesInner&&2<g.length&&(h=g.slice(0,g.length-2),o=o.concat(h),i.arrayCautiousRemoveMulti(a,h))}p=0;for(m=a.length;p<m;p++){h=a[p];r=h.vertices;if(!n.discardCollinear){d=r[0];for(y=r.length-1;0<y;y--)g=r[y],l=r[y-1],0===s.pointsCW(d,g,l)?r.splice(y,1):d=g,g=l;0===s.pointsCW(r[y+1],r[y],r[r.length-1])&&r.splice(0,1)}n.reverse&&r.reverse();d=h.minX;o=h.minY;u=h.width;h=h.height;y=0;for(l=r.length;y<l;y++)g=r[y],g.x-=d+.5*u,g.y-=o+.5*h}}return a};ig.utilstile.shapeFromTile=function(t,i){var e,s,n=ig.utilstile.verticesFromTile(t,i),a;if(n)if(ig.utilstile.defaultTileSegmentsDef[t])a=ig.utilstile.defaultTileSegmentsDef[t];else{ig.utilstile.defaultTileSegmentsDef[t]=a=[];e=0;for(s=n.length;e<s;e++){var o=n[e],h=e===s-1?0:e+1,r=n[h],l=r.x-o.x,r=r.y-o.y,o=Math.sqrt(l*l+r*r);0<o?(r/=o,l=-l/o):r=l=0;a.push({a:e,b:h,normal:{x:r,y:l}})}}return{vertices:n,segments:a||[]}};ig.utilstile.verticesFromTile=function(t,i){"undefined"===i&&(i=p);var e;if(ig.utilstile.defaultTileVerticesDef[t])e=ig.utilstile.defaultTileVerticesDef[t];else{if(1===parseInt(t)||g[t])e=[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1}];else{e=[];var n=i[t];if(n){var a=e[0]={x:n[0],y:n[1]},o=e[1]={x:n[2],y:n[3]},n=a.x,a=a.y,h=o.x,o=o.y,r=h-n,l=o-a,u=e[2]={x:0>l?1:0,y:0<r?1:0},c=u.x,u=u.y,d;d=!1;if(1>Math.abs(r)&&1>Math.abs(l)){var r=s.pointQuadrant(n,a,.5,.5),l=s.pointQuadrant(h,o,.5,.5),m=s.pointQuadrant(c,u,.5,.5);!(r&m)&&!(l&m)&&(d=!0)}!0===d?(c!==u?(d=c,l=u,1==c?(u=1,r=0):(u=0,r=1)):(r=c,l=1==c?d=0:d=1),e[3]={x:d,y:u},e[4]={x:r,y:l}):(c!==u?(d=c,l=u,1==c?(u=Math.max(a,o),r=Math.min(n,h)):(u=Math.min(a,o),r=Math.max(n,h))):(r=c,1==c?(d=Math.min(n,h),l=Math.min(a,o)):(d=Math.max(n,h),l=Math.max(a,o))),d===n&&u===a||d===h&&u===o?r===n&&l===a||r===h&&l===o||(e[3]={x:r,y:l}):e[3]={x:d,y:u});e=s.pointsToConvexHull(e)}}ig.utilstile.defaultTileVerticesDef[t]=e}return e};ig.utilstile.getNonDuplicateSegmentVertices=function(t,i,e){var s=t.shape,n=s.vertices,s=s.segments,a=[],o,h,r,l;o=0;for(h=s.length;o<h;o++){r=s[o];var g=n[r.a],u=n[r.b],c=r.normal,d=!1;if(0===c.x&&0!==c.y||0!==c.x&&0===c.y){var p=ig.utilstile.getTouchingTilesByDirection(t,c,i,e);r=0;for(l=p.length;r<l;r++){var m=p[r];if(0<m.shape.vertices.length&&(d=ig.utilstile.getSegmentOverlapWithTile(g,u,c,m)))break}}!1===d?a.push(g,u):d.segmentA&&a.push(d.segmentA.va,d.segmentA.vb)}return a};ig.utilstile.getTouchingTilesByDirection=function(t,e,s,n){var a=t.ix;t=t.iy;var o=e.x;e=e.y;var h=[],r;0!==o&&(r=s[t],0<o?a<r.length-1&&(o=r[a+1],(!n||-1!==i.indexOfValue(n,o))&&h.push(o)):0<a&&(o=r[a-1],(!n||-1!==i.indexOfValue(n,o))&&h.push(o)));0!==e&&(0<e?t<s.length-1&&(o=s[t+1][a],(!n||-1!==i.indexOfValue(n,o))&&h.push(o)):0<t&&(o=s[t-1][a],(!n||-1!==i.indexOfValue(n,o))&&h.push(o)));return h};ig.utilstile.getSegmentOverlapWithTile=function(t,i,e,s){var n=!1,a=s.shape;s=a.vertices;var a=a.segments,o,h,r,l,g;o=0;for(h=a.length;o<h;o++)if(r=a[o],l=r.normal,e.x===-l.x&&e.y===-l.y){g=r;break}if(g){e=s[g.a];g=s[g.b];o=t.x;h=t.y;s=i.x;a=i.y;l=e.x;var u=e.y,c=g.x,d=g.y,p=s-o;r=a-h;var m=Math.sqrt(p*p+r*r),p=p/m,m=r/m;r=l-c;var y=u-d,f=Math.sqrt(r*r+y*y);0===p*(y/f)-m*(r/f)&&(0!==p?(r=Math.min(o,c),d=Math.max(o,c),c=Math.min(s,l),u=Math.max(s,l),l=p,h=s,s="x"):(r=Math.min(h,d),d=Math.max(h,d),c=Math.min(a,u),u=Math.max(a,u),l=m,o=h,h=a,s="y"),r===d&&c===u?n=!0:(a=0>l?r-u:c-d,0<a&&(n={segmentA:{va:{x:t.x,y:t.y},vb:{x:i.x,y:i.y}},segmentB:{va:{x:e.x,y:e.y},vb:{x:g.x,y:g.y}}},t=!0,0>l?(i=r===d?0:r===o?2:1,e=c===u?0:u===h?2:1,1===i?(n.segmentA.vb[s]+=a,t=!1):2===i&&(n.segmentB.va[s]+=a),1===e?(n.segmentA.va[s]-=a,t=!1):2===e&&(n.segmentB.vb[s]-=a)):(i=r===d?0:r===o?1:2,e=c===u?0:u===h?1:2,1===i?(n.segmentA.vb[s]-=a,t=!1):2===i&&(n.segmentB.va[s]-=a),1===e?(n.segmentA.va[s]+=a,t=!1):2===e&&(n.segmentB.vb[s]+=a)),!0===t&&(n=!0))))}return n}});ig.baked=!0;ig.module("plusplus.core.entity").requires("impact.entity","plusplus.core.config","plusplus.core.image","plusplus.core.background-map","plusplus.core.animation","plusplus.helpers.signals","plusplus.helpers.tweens","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2","plusplus.helpers.utilsintersection","plusplus.helpers.utilsdraw","plusplus.helpers.utilscolor","plusplus.helpers.utilstile").defines(function(){var t=ig.CONFIG,i=ig.TWEEN,e=ig.utils,s=ig.utilsmath,n=ig.utilsvector2,a=ig.utilsintersection,o=ig.utilsdraw,h=ig.utilscolor,r=ig.utilstile;ig.EntityExtended=ig.Entity.extend({layerName:"entities",pos:{x:.01,y:.01},size:{x:t.ENTITY.SIZE_EFFECTIVE_X,y:t.ENTITY.SIZE_EFFECTIVE_Y},offset:{x:t.ENTITY.SIZE_OFFSET_X,y:t.ENTITY.SIZE_OFFSET_Y},posDraw:{x:.01,y:.01},sizeDraw:{x:0,y:0},scale:t.ENTITY.SCALE,scaleOfSystemScale:t.ENTITY.SCALE_OF_SYSTEM_SCALE,scaleMin:t.ENTITY.SCALE_MIN,scaleMax:t.ENTITY.SCALE_MAX,scaleMod:1,ignoreSystemScale:t.ENTITY.IGNORE_SYSTEM_SCALE,collides:0,collidesChanges:!1,collisionMapResult:null,checkAgainst:0,type:0,group:0,frozen:!1,controllable:!0,performance:t.STATIC,highPerformance:!1,fixed:!1,facing:{x:1,y:0},canFlipX:t.ENTITY.CAN_FLIP_X,canFlipY:t.ENTITY.CAN_FLIP_Y,friction:{x:t.ENTITY.FRICTION_X,y:t.ENTITY.FRICTION_Y},maxVel:{x:t.ENTITY.MAX_VEL_X,y:t.ENTITY.MAX_VEL_Y},angle:0,bounciness:t.ENTITY.BOUNCINESS,minBounceVelocity:t.ENTITY.MIN_BOUNCE_VEL,currentAnim:null,overridingAnim:null,animSheetPath:"",animSheetWidth:0,animSheetHeight:0,animSettings:null,animationType:0,animationTypes:null,animSequenceCount:1,animTileOffset:0,animFrameTime:1,animInit:"",textured:!1,persistent:!1,targetable:!1,climbable:!1,climbableStairs:!1,oneWay:!1,oneWayFacing:null,opaque:t.ENTITY.OPAQUE,opaqueOffset:t.ENTITY.OPAQUE_OFFSET,opaqueVertices:null,opaqueFromVertices:t.ENTITY.OPAQUE_FROM_VERTICES,diffuse:t.ENTITY.DIFFUSE,hollow:!0,activated:!1,alwaysToggleActivate:!1,activateCallback:null,activateContext:null,deactivateCallback:!1,deactivateContext:!1,alpha:1,hidden:!1,health:t.ENTITY.HEALTH,healthMax:t.ENTITY.HEALTH,invulnerable:!1,rangeInteractableX:0,rangeInteractableY:0,paused:!1,visible:!1,changed:!1,checking:!1,wasChecking:!1,intersecting:!1,added:!1,dieing:!1,dieingSilently:!1,canDieInstantly:!0,flip:{x:!1,y:!1},grounded:t.TOP_DOWN,standing:t.TOP_DOWN,gravityFactor:t.TOP_DOWN?0:1,hasGravity:t.TOP_DOWN?!1:!0,collidingWithMap:!1,collidingWithEntitiesBelow:!1,slope:null,slopeSticking:t.ENTITY.SLOPE_STICKING,slopeSpeedMod:t.ENTITY.SLOPE_SPEED_MOD,slopeStanding:{min:s.degreesToRadians(t.ENTITY.SLOPE_STANDING_MIN),max:s.degreesToRadians(t.ENTITY.SLOPE_STANDING_MAX)},moving:!1,movingX:!1,movingY:!1,movingTo:null,movedTo:!0,movingToOnce:!1,movingToTweening:!1,movingToTweenPct:0,linkedTo:null,managed:!1,tweens:{},resetState:{},needsVertices:t.ENTITY.NEEDS_VERTICES,vertices:null,verticesWorld:null,onAdded:null,onRemoved:null,onMovedTo:null,onRefreshed:null,needsRebuild:!0,_posLast:{x:0,y:0},_sizeLast:{x:0,y:0},_angleLast:0,_changedAdd:!1,_verticesFound:!1,_overridedAnim:!1,_cleanupPersistent:!1,init:function(t,i,e){this.id=++ig.Entity._lastId;this.initTypes();this.initProperties();this.reset(t,i,e)},initTypes:function(){},initProperties:function(){this.collisionMapResult={collision:{x:!1,y:!1,slope:!1},pos:{x:0,y:0},slope:{x:0,y:0,nx:0,ny:0},tile:{x:0,y:0,xPos:{x:0,y:0},yPos:{x:0,y:0}}};this.onAdded=new ig.Signal;this.onRemoved=new ig.Signal;this.onMovedTo=new ig.Signal;this.onRefreshed=new ig.Signal},reset:function(t,i,e){this.resetCore(t,i,e);this.resetExtras()},resetCore:function(t,i,s){ig.merge(this,this.resetState);t&&(this.pos.x=t);i&&(this.pos.y=i);s&&!ig.global.wm&&("string"===typeof s.type&&(e.addType(ig.EntityExtended,this,"type",s.type),delete s.type),"string"===typeof s.checkAgainst&&(e.addType(ig.EntityExtended,this,"checkAgainst",s.checkAgainst),delete s.checkAgainst),"string"===typeof s.group&&(e.addType(ig.EntityExtended,this,"group",s.group,"GROUP"),delete s.group));ig.merge(this,s);this._killed=this.dieing=this.dieingSilently=!1},resetExtras:function(){this.healthMax=this.health;this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.fixed=!1);this.fixed&&(this.collides=ig.EntityExtended.COLLIDES.NEVER);this.hasGravity||this.setGrounded(!0);this.animSheetPath&&(this.animSheet=new ig.AnimationSheet(t.PATH_TO_MEDIA+this.animSheetPath,this.animSheetWidth,this.animSheetHeight),this.animSheetPath="");if(this.animSettings){this.anims={};this.resetState.currentAnim=null;if(!0===this.animSettings)this.createAnim();else for(var i in this.animSettings)this.createAnim(i,this.animSettings[i]);delete this.animSettings}this.recordResetState();ig.global.wm||ig.system.onResized.add(this.refresh,this);this.refresh(!0);this.changed=this.frozen?this._changedAdd=!1:this._changedAdd=!0;this.activated&&(this.activated=!1,this.activate())},recordResetState:function(){var t=this.resetState;t.pos||(t.pos={x:0,y:0});n.copy(t.pos,this.pos);t.vel||(t.vel={x:0,y:0});n.copy(t.vel,this.vel);t.accel||(t.accel={x:0,y:0});n.copy(t.accel,this.accel);t.layerName=this.layerName;t.frozen=this.frozen;t.alpha=this.alpha;t.type=this.type;t.checkAgainst=this.checkAgainst;t.collides=this.collides;t.performance=this.performance;t.health=this.health},createAnim:function(t,i){i=i||{};var s=i.sequence,n=i.tileOffset||this.animTileOffset,a,o;if(!s||!s.length){s=i.sequence=[];o=i.sequenceCount||this.animSequenceCount;var h=0;if((a=i.type||this.animationType)&&this.animationTypes)a=e.indexOfValue(this.animationTypes,a),-1!==a&&(h+=o*a);for(a=0;a<o;a++)s[a]=h+a}if(n){a=0;for(o=s.length;a<o;a++)s[a]+=n}i.frameTime=i.frameTime||this.animFrameTime;t?this.addAnim(t,i):(s=this.addAnim("idle",i),this.anims.idleX=s,this.anims.idleY=s,this.anims.idleLeft=s,this.anims.idleRight=s,this.anims.idleUp=s,this.anims.idleDown=s)},addAnim:function(t,i){if(!this.animSheet)throw"No animSheet to add the animation "+t+" to.";var e=new ig.AnimationExtended(this.animSheet,i);this.anims[t]=e;this.currentAnim||(this.currentAnim=e);return e},getDirectionalAnimName:function(t){return 0!==this.facing.y?this.canFlipY?t+"Y":0>this.facing.y?t+"Up":t+"Down":this.canFlipX?t+"X":0>this.facing.x?t+"Left":t+"Right"},refresh:function(t){if(!this.ignoreSystemScale){var i=Math.min(Math.max(Math.round(ig.system.scale*this.scaleOfSystemScale),this.scaleMin),this.scaleMax);this.scale!==i&&(this.scale=i,t=!0)}this.needsRebuild&&(t=!0);this.scaleMod=this.scale/ig.system.scale;if((t=this.resize(t)||t)||this.needsRebuild)this.sizeDraw.x=this.getSizeDrawX(),this.sizeDraw.y=this.getSizeDrawY();t=this.reposition(t)||t;this.recordChanges(t);this.recordLast();n.copy(this.last,this.pos);(t||this.needsRebuild)&&this.rebuild();this.movingTo&&this.moveToUpdate();this.onRefreshed.dispatch(this);this.frozen?(this.changed=this.moving=this.movingX=this.movingY=!1,this.facing.x=this.facing.y=0):this.performance===ig.EntityExtended.PERFORMANCE.STATIC&&this.changed&&(this.moving=this.movingX=this.movingY=!1,this._changedAdd=!0)},resize:function(t){return t},reposition:function(t){this.movingTo&&(this.movedTo=!1);return t},rebuild:function(){this.needsRebuild=!1},adding:function(){this.ready();this.onAdded.dispatch(this)},ready:function(){this.changePerformance();if(this.linkedTo){var t=this.linkedTo;this.linkedTo=null;this.link(t,t.added)}t=this.getDirectionalAnimName("spawn");this.anims[t]?this.animOverride(t,{callback:this.spawn}):this.spawn()},spawn:function(){this.resetToInitAnim()},resetToInitAnim:function(){if(this.currentAnim=this.animInit instanceof ig.Animation?this.animInit:this.animInit?this.anims[this.animInit]:this.anims.idle||this.currentAnim){this.resetState.currentAnim=this.currentAnim;var t=this.currentAnim.stop;this.currentAnim.playFromStart();this.currentAnim.stop=t}},setPerformance:function(t){this.performance=t;this.performance!==this.performanceLast&&this.changePerformance()},changePerformance:function(){this.performanceLast=this.performance;this.performance===ig.EntityExtended.PERFORMANCE.MOVABLE?this.changePerformanceMovable():this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC?this.changePerformanceDynamic():this.changePerformanceStatic()},changePerformanceStatic:function(){},changePerformanceMovable:function(){},changePerformanceDynamic:function(){},setControllable:function(t){"undefined"===typeof t&&(t=!0);t?this.addControl():this.removeControl()},addControl:function(){this.controllable=!0},removeControl:function(){this.controllable=!1;this.applyAntiVelocity()},getLayer:function(){return ig.game.layersMap[this.layerName]},getVertices:function(){var t=.5*this.size.x,i=.5*this.size.y;return[{x:-t,y:-i},{x:t,y:-i},{x:t,y:i},{x:-t,y:i}]},getVerticesWorld:function(){this.vertices||(this.vertices=this.getVertices());
return n.projectPoints(this.vertices,this.pos.x+.5*this.size.x,this.pos.y+.5*this.size.y,1,1,this.angle)},getSizeDrawX:function(){return this.size.x+2*this.offset.x},getSizeDrawY:function(){return this.size.y+2*this.offset.y},getPosDrawX:function(){return this.pos.x-this.offset.x},getPosDrawY:function(){return this.pos.y-this.offset.y},getCenterX:function(){return this.pos.x+.5*this.size.x},getCenterY:function(){return this.pos.y+.5*this.size.y},getIsVisible:function(){if(0>=this.alpha)return!1;if(this.fixed)return a.AABBIntersect(this.posDraw.x,this.posDraw.y,this.posDraw.x+this.sizeDraw.x,this.posDraw.y+this.sizeDraw.y,0,0,ig.system.width,ig.system.height);var t=this.posDraw.x-ig.game.screen.x,i=this.posDraw.y-ig.game.screen.y;return a.AABBIntersect(t,i,t+this.sizeDraw.x,i+this.sizeDraw.y,0,0,ig.system.width,ig.system.height)},getNewVelocity:function(t,i,e,n){return i?s.clamp(t+i*ig.system.tick,-n,n):e?(i=e*ig.system.tick,0<t-i?Math.min(t-i,n):0>t+i?Math.max(t+i,-n):0):s.clamp(t,-n,n)},getIsMovingSelf:function(){return this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC||this.movingTo},getIsCollidingWithOneWay:function(i){if(0!==i.oneWayFacing.x)if(0>i.oneWayFacing.x){if(this.pos.x+this.size.x-i.pos.x<=Math.max(i.size.x,this.size.x)*t.PRECISION_PCT_ONE_SIDED+Math.max(this.vel.x*ig.system.tick,0)-Math.min(i.vel.x*ig.system.tick,0))return!0}else if(i.pos.x+i.size.x-this.pos.x<=Math.max(i.size.x,this.size.x)*t.PRECISION_PCT_ONE_SIDED-Math.min(this.vel.x*ig.system.tick,0)+Math.max(i.vel.x*ig.system.tick,0))return!0;if(0!==i.oneWayFacing.y)if(0>i.oneWayFacing.y){if(this.pos.y+this.size.y-i.pos.y<=i.size.y*t.PRECISION_PCT_ONE_SIDED+Math.max(this.vel.y*ig.system.tick,0)-Math.min(i.vel.y*ig.system.tick,0)+(i.slope&&0!==i.accel.x&&0>=i.slope.nx*i.vel.x?i.vel.x*ig.system.tick:0))return!0}else if(i.pos.y+i.size.y-this.pos.y<=Math.max(i.size.y,this.size.y)*t.PRECISION_PCT_ONE_SIDED-Math.min(this.vel.y*ig.system.tick,0)+Math.max(i.vel.y*ig.system.tick,0))return!0},touches:function(t){return a.AABBIntersect(this.pos.x,this.pos.y,this.pos.x+this.size.x,this.pos.y+this.size.y,t.pos.x,t.pos.y,t.pos.x+t.size.x,t.pos.y+t.size.y)},distanceTo:function(t){var i=this.pos.x+.5*this.size.x,e=this.pos.y+.5*this.size.y;this.fixed&&(i+=ig.game.screen.x,e+=ig.game.screen.y);if(t instanceof ig.EntityExtended){var s=t.pos.x+.5*t.size.x,n=t.pos.y+.5*t.size.y;t.fixed&&(s+=ig.game.screen.x,n+=ig.game.screen.y);i-=s;t=e-n}else i-=t.x,t=e-t.y;return Math.sqrt(i*i+t*t)},distanceSquaredTo:function(t){var i=this.pos.x+.5*this.size.x,e=this.pos.y+.5*this.size.y;this.fixed&&(i+=ig.game.screen.x,e+=ig.game.screen.y);if(t instanceof ig.EntityExtended){var s=t.pos.x+.5*t.size.x,n=t.pos.y+.5*t.size.y;t.fixed&&(s+=ig.game.screen.x,n+=ig.game.screen.y);i-=s;t=e-n}else i-=t.x,t=e-t.y;return i*i+t*t},distanceEdgeTo:function(t){var i,e,s,n;this.fixed?(i=this.pos.x+ig.game.screen.x,e=i+this.size.x,s=this.pos.y+ig.game.screen.y):(i=this.pos.x,e=i+this.size.x,s=this.pos.y);n=s+this.size.y;var a,o,h;t instanceof ig.EntityExtended?(t.fixed?(a=t.pos.x+ig.game.screen.x,o=a+t.size.x,h=t.pos.y+ig.game.screen.y):(a=t.pos.x,o=a+t.size.x,h=t.pos.y),t=h+t.size.y):(a=o=t.x,h=t=t.y);i=e<a?a-e:i>o?i-o:0;s=n<h?h-n:s>t?s-t:0;return Math.sqrt(i*i+s*s)},distanceSquaredEdgeTo:function(t){var i,e,s,n;this.fixed?(i=this.pos.x+ig.game.screen.x,e=i+this.size.x,s=this.pos.y+ig.game.screen.y):(i=this.pos.x,e=i+this.size.x,s=this.pos.y);n=s+this.size.y;var a,o,h;t instanceof ig.EntityExtended?(t.fixed?(a=t.pos.x+ig.game.screen.x,o=a+t.size.x,h=t.pos.y+ig.game.screen.y):(a=t.pos.x,o=a+t.size.x,h=t.pos.y),t=h+t.size.y):(a=o=t.x,h=t=t.y);i=e<a?a-e:i>o?i-o:0;s=n<h?h-n:s>t?s-t:0;return i*i+s*s},angleTo:function(t){return t instanceof ig.EntityExtended?Math.atan2(this.pos.x+.5*this.size.x-(t.pos.x+.5*t.size.x),this.pos.y+.5*this.size.y-(t.pos.y+.5*t.size.y)):Math.atan2(this.pos.x+.5*this.size.x-t.x,this.pos.y+.5*this.size.y-t.y)},applyAntiVelocity:function(){this.applyAntiVelocityX();this.applyAntiVelocityY()},applyAntiVelocityX:function(){this.vel.x=0;this.movingX=!1;this.moving=this.movingY},applyAntiVelocityY:function(){this.vel.y=0;this.movingY=!1;this.moving=this.movingX},applyAntiGravity:function(){0!==this.gravityFactor&&(this.vel.y-=ig.game.gravity*ig.system.tick*this.gravityFactor)},setGrounded:function(i){t.TOP_DOWN?this.standing=this.grounded=!0:(this.standing=this.grounded=this.hasGravity,i||(this.vel.y=this.slopeSticking&&this.hasGravity?this.maxVel.y:0))},setUngrounded:function(){t.TOP_DOWN||(this.grounded=this.standing=!1)},animOverride:function(t,i){if(this.overridingAnimName!==t&&(i&&i.entity||this).anims[t]){i=i||{};var e=i.entity||this;this.animRelease();this.overridingAnimName=t;this.overridingAnimCallback=i.callback;this.overridingAnimContext=i.context;this.overridingAnimFrozen=this.frozen;this._overridedAnim=this.currentAnim;this.currentAnim=this.overridingAnim=e.anims[t];!i.loop&&(!i.lock&&!i.stop)&&this.overridingAnim.onCompleted.addOnce(this.animRelease,this);this.frozen&&(this.frozen=!1);i.frame?(this.overridingAnim.gotoFrame(i.frame),"boolean"===typeof i.reverse&&(this.overridingAnim.reverse=i.reverse)):this.overridingAnim.playFromStart(!i.loop,i.reverse);"boolean"===typeof i.stop&&(this.overridingAnim.stop=i.stop)}else i&&"function"===typeof i.callback&&(this.animRelease(t,!0),i.callback.call(i.context||this))},animRelease:function(t,i){if(!t||this.overridingAnimName===t){var e=this.overridingAnimCallback,s=this.overridingAnimContext;this.overridingAnimFrozen&&(this.frozen=this.overridingAnimFrozen);this.overridingAnim&&(this.overridingAnim.onCompleted.remove(this.animRelease,this),this.currentAnim=this._overridedAnim,this.overridingAnimName=this.overridingAnim=this._overridedAnim=this.overridingAnimCallback=this.overridingAnimContext=void 0);!i&&e&&e.call(s||this)}},initOpaqueVertices:function(){this.opaqueVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]},getOpaqueVertices:function(){var t=this.size.x,i=this.size.y,e=this.pos.x,s=this.pos.y,n=this.opaqueOffset;this.currentAnim&&this.currentAnim.opaqueOffset&&(n=this.currentAnim.opaqueOffset.tiles&&this.currentAnim.opaqueOffset.tiles[this.currentAnim.tile]||this.currentAnim.opaqueOffset);var a=e+n.left,o=s+n.top,h=e+t+n.right,n=s+i+n.bottom,t=e+.5*t,i=s+.5*i,s=this.opaqueVertices[0],e=this.opaqueVertices[1],r=this.opaqueVertices[2],l=this.opaqueVertices[3];if(0!==this.angle){var g=Math.cos(this.angle),u=Math.sin(this.angle),a=a-t,o=o-i,h=h-t,n=n-i;s.x=t+a*g-o*u;s.y=i+a*u+o*g;e.x=t+h*g-o*u;e.y=i+h*u+o*g;r.x=t+h*g-n*u;r.y=i+h*u+n*g;l.x=t+a*g-n*u;l.y=i+a*u+n*g}else s.x=a,s.y=o,e.x=h,e.y=o,r.x=h,r.y=n,l.x=a,l.y=n;return this.opaqueVertices},castShadow:function(t,i,e,s,r,l){this._contours||(this._utilVec2Cast1={x:0,y:0},this._utilVec2Cast2={x:0,y:0},this._utilVec2Cast3={x:0,y:0},this._utilVec2Cast4={x:0,y:0},this._utilVec2Project1={x:0,y:0},this._utilVec2Project2={x:0,y:0},this._utilVec2Project3={x:0,y:0},this._utilVec2Project4={x:0,y:0},this._contourPool=[],this._contours=[]);this.opaqueFromVertices?this._verticesFound||(this.opaqueVertices=this.verticesWorld=this.getVerticesWorld()):(this.opaqueVertices||this.initOpaqueVertices(),this._verticesFound||this.getOpaqueVertices());this._verticesFound=!0;if(this.hollow||!a.pointInPolygon(e.x,e.y,this.opaqueVertices)){var g=1<=this.diffuse||1<=t.diffuse?1:this.diffuse*t.diffuse,u=this.opaqueVertices,c=s+2*l,d=r+2*l,p=!1,m=this._contourPool,y=this._contours,f,E,T,A,v,x,_,I=u[u.length-1],C,S,O,w,N,b;w=0;for(N=u.length;w<N;w++)C=u[w],I.x<C.x?(f=I.x,T=C.x):(f=C.x,T=I.x),I.y<C.y?(E=I.y,A=C.y):(E=C.y,A=I.y),a.AABBIntersect(f,E,T,A,s,r,c,d)&&(p=!0,f=n.copy(this._utilVec2Cast1,C),n.subtract(f,I),T=n.set(this._utilVec2Cast2,f.y,-f.x),E=n.copy(this._utilVec2Cast3,I),n.subtract(E,e),0<n.dot(T,E)&&(T=n.copy(this._utilVec2Cast4,C),n.subtract(T,e),m.push({vertices:this.projectShadow(e,l,I,C,E,T,f),verticesActual:[I,C],verticesHollow:[]}))),I=C;if(p){w=0;for(N=m.length;w<N;w++){l=m[w];p=l.vertices;_=!1;I=p[0];C=p[1];S=p[p.length-2];O=p[p.length-1];for(e=w+1;e<N;e++)if(f=m[e],E=f.vertices,T=E[0],A=E[1],v=E[E.length-2],x=E[E.length-1],n.equal(I,x)&&n.equal(C,v)){_=!0;m[e]={vertices:E.slice(0,-1).concat(p.slice(2)),verticesActual:f.verticesActual.slice(0,-1).concat(l.verticesActual),verticesHollow:l.verticesHollow.concat(I,f.verticesHollow)};break}else if(n.equal(S,A)&&n.equal(O,T)){_=!0;m[e]={vertices:p.slice(0,-1).concat(E.slice(2)),verticesActual:l.verticesActual.slice(0,-1).concat(f.verticesActual),verticesHollow:f.verticesHollow.concat(O,l.verticesHollow)};break}!0!==_&&y.push(l)}if(this.hollow){w=0;for(N=y.length;w<N;w++)l=y[w],l.vertices=l.vertices.concat(l.verticesHollow)}else{I=u.slice(0);u={};C=[];p=!1;w=0;for(N=I.length;w<N;w++){f=I[w];E=!1;e=0;for(b=y.length;e<b;e++){l=y[e];A=l.verticesActual;l=0;for(T=A.length;l<T;l++)if(v=A[l],f.x===v.x&&f.y===v.y){E=!0;C&&(u[0===e?b-1:e-1]=C,C=void 0,p=!0);break}if(!0===E)break}!1===E&&(C||(C=[]),C.push(f))}C&&(u[b-1]=C!==u[b-1]?C.concat(u[b-1]||[]):C);if(p){b={vertices:[]};w=0;for(N=y.length;w<N;w++)l=y[w],b.vertices=b.vertices.concat(l.vertices,u[w]||[]);y=[b]}else y.push({vertices:I})}if(t.pixelPerfect){w=0;for(N=y.length;w<N;w++)l=y[w],o.pixelFillPolygon(i,s,r,c,d,l.vertices,1,1,1,g,!0,a.boundsOfPoints(l.vertices))}else{i.fillStyle=h.RGBAToCSS(1,1,1,g);w=0;for(N=y.length;w<N;w++)l=y[w],o.fillPolygon(i,l.vertices,-s,-r,t.scale)}m.length=y.length=0}}},projectShadow:function(t,i,e,s,a,o,h){var r=this._utilVec2Project1,l=n.copy(this._utilVec2Project2,a);n.inverse(l);l=n.dot(h,l)/n.lengthSquared(h);0>l?n.copy(r,e):1<l?n.copy(r,s):(n.copy(r,e),h=n.copy(this._utilVec2Project3,h),n.multiplyScalar(h,l),n.add(r,h));r=n.copy(this._utilVec2Project4,r);n.subtract(r,t);n.normalize(r);n.multiplyScalar(r,i);n.normalize(a);n.multiplyScalar(a,i);n.normalize(o);n.multiplyScalar(o,i);t=n.clone(e);n.add(t,a);a=n.clone(s);n.add(a,o);if(0>l)return l=n.clone(s),n.add(l,r),[e,t,l,a,s];if(1<l)return o=n.clone(e),n.add(o,r),[e,t,o,a,s];o=n.clone(e);n.add(o,r);l=n.clone(s);n.add(l,r);return[e,t,o,l,a,s]},activate:function(t){this.activated=!0;this.activateCallback&&this.activateCallback.call(this.activateContext||this,t)},deactivate:function(t){this.activated=!1;this.deactivateCallback&&this.deactivateCallback.call(this.deactivateContext||this,t)},toggleActivate:function(t){!this.alwaysToggleActivate&&this.activated?this.deactivate(t):this.activate(t)},setHidden:function(t){t?this.hide():this.unhide()},hide:function(){this.hidden=!0},unhide:function(){this.hidden=!1},fadeTo:function(i,e){if(this.alpha!==i)return e=ig.merge({name:"fade",duration:t.DURATION_FADE},e),this.tween({alpha:i||0},e);if(e){if(e.onUpdate)e.onUpdate();if(e.onComplete)e.onComplete()}},fadeIn:function(t){return this.fadeTo(1,t)},fadeOut:function(t){return this.fadeTo(0,t)},fadeToDeath:function(t){t=t||{};var i=this,e=t.onComplete;t.onComplete=function(){ig.game.removeEntity(i);e&&e()};return this.fadeTo(0,t)},tween:function(t,e){var s=this;e=e||{};var n=e.name||"tween",a=this.tweens[n];a&&a.stop();if(!e.noComplete){var o=e.onComplete;e.onComplete=function(){delete s.tweens[n];"function"===typeof o&&o()}}return this.tweens[n]=i.tween(this,t,e)},tweenEnd:function(t){if("string"===typeof t){var i=this.tweens[t];i&&(i.stop(),delete this.tweens[t])}else for(t in this.tweens)this.tweenEnd(t)},moveTo:function(t,i){if(t&&this.movingTo!==t){this.moveToStop();i=i||{};if(e.isArray(t)){if(0===t.length)return;this.movingToSequence=t.slice(0);t=this.movingToSequence.shift();if(this.movingTo===t)return;this.movingToOnce=!0}"undefined"!==typeof i.once&&(this.movingToOnce=i.once);var s=!this.fixed&&this.performance===ig.EntityExtended.PERFORMANCE.STATIC;if(t instanceof ig.EntityExtended&&(i.matchPerformance||this.ignoreSystemScale||this.scale!==ig.system.scale)&&this.performance!==ig.EntityExtended.PERFORMANCE.MOVABLE)this.setPerformance(ig.EntityExtended.PERFORMANCE.MOVABLE),s=!1;if(i.randomOffsetPct){i.baseOffsetPct=i.baseOffsetPct||i.offsetPct||{x:0,y:0};var n=i.randomOffsetPct;n.x=n.x||0;n.y=n.y||0;i.offsetPct={x:i.baseOffsetPct.x+(2*Math.random()*n.x-n.x),y:i.baseOffsetPct.y+(2*Math.random()*n.y-n.y)}}if(s&&!i.lerp&&!i.tween)this.moveToPosition(t,i),this.recordChanges();else return this.frozen=!1,this.movingTo=t,this.movedTo=!1,this.movingToSettings=i,i.tween&&this.performance!==ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.movingToTweening=!0,this.movingToTweenPct=0,this.movingToTweenX=this.pos.x,this.movingToTweenY=this.pos.y,s=i.tweenSettings=i.tweenSettings||{},s.name="movingTo",s.onComplete=function(){this.moveToUpdate();this.moveToComplete()}.bind(this),this.tween({movingToTweenPct:1},s)),!0}return!1},moveToSequenceNext:function(){this.movingToSequence&&(0<this.movingToSequence.length?(this.movingTo=null,this.moveTo(this.movingToSequence.shift(),this.movingToSettings)):(this.movingToSequence=void 0,this.moveToComplete(),this.moveToStop()))},moveToUpdate:function(){this.movingTo&&(!this.movedTo||this.movingTo.changed)&&this.moveToPosition(this.movingTo,this.movingToSettings)},moveToPosition:function(i,e){var n=0,a=0,o=.5,h=.5;if(i instanceof ig.EntityExtended){if(e){var r=e.align;r&&("undefined"!==typeof r.x&&(o=r.x),"undefined"!==typeof r.y&&(h=r.y));if(r=e.offset)n+=r.x*i.scaleMod||0,a+=r.y*i.scaleMod||0;var l=e.offsetPct;l&&(r=l.x||0,l=l.y||0,n+=r*(.5*i.size.x*i.scaleMod+.5*this.size.x*this.scaleMod)*(i.flip.x?-1:1),a+=l*(.5*i.size.y*i.scaleMod+.5*this.size.y*this.scaleMod));e.flipWith&&(this.flip.x=i.flip.x,this.flip.y=i.flip.y)}n+=i.pos.x+o*(i.size.x*i.scaleMod-this.size.x*this.scaleMod);a+=i.pos.y+h*(i.size.y*i.scaleMod-this.size.y*this.scaleMod);this.fixed?i.fixed||(n-=ig.game.screen.x,a-=ig.game.screen.y):i.fixed&&(n+=ig.game.screen.x,a+=ig.game.screen.y)}else{if(e){if(r=e.align)"undefined"!==typeof r.x&&(o=r.x),"undefined"!==typeof r.y&&(h=r.y);if(r=e.offset)n+=r.x||0,a+=r.y||0;if(l=e.offsetPct)r=l.x||0,l=l.y||0,n+=.5*r*this.size.x,a+=.5*l*this.size.y}n+=i.x+o*this.size.x;a+=i.y+h*this.size.y;this.fixed&&(n-=ig.game.screen.x,a-=ig.game.screen.y)}o=n-this.pos.x;h=a-this.pos.y;this.movingToTweening?(this.pos.x=this.movingToTweenX+(n-this.movingToTweenX)*this.movingToTweenPct,this.pos.y=this.movingToTweenY+(a-this.movingToTweenY)*this.movingToTweenPct):e&&e.lerp?(this.pos.x+=o*e.lerp,this.pos.y+=h*e.lerp):(this.pos.x=n,this.pos.y=a);s.almostEqual(o,0,t.PRECISION_ZERO)&&s.almostEqual(h,0,t.PRECISION_ZERO)&&this.moveToComplete()},moveToComplete:function(){if(this.movingToSequence)this.moveToSequenceNext();else return this.movingToOnce&&this.moveToStop(),this.movedTo=!0,this.onMovedTo.dispatch(this),!0},moveToStop:function(){this.movingTo&&(this.movingToTweening&&(this.tweenEnd("movingTo"),this.movingToTweenPct=this.movingToTweenX=this.movingToTweenY=0),this.movedTo=this.movingToTweening=this.movingToOnce=!1,this.movingTo=this.movingToSettings=this.movingToSequence=null)},moveAllStop:function(){this.moveToStop();this.applyAntiVelocity()},lookAt:function(i){if(i&&this!==i&&!i.fixed){var e=this.pos.x+.5*this.size.x,s,n;t.TOP_DOWN?(s=this.pos.y+.5*this.size.y,i instanceof ig.EntityExtended?(n=i.pos.x+.5*i.size.x,i=i.pos.y+.5*i.size.y):(n=i.x,i=i.y),e-=n,s-=i,Math.abs(e)>Math.abs(s)?(this.facing.y=0,0<e?(this.flip.x=this.canFlipX,this.facing.x=-1):(this.flip.x=!1,this.facing.x=1)):(this.facing.x=0,0<s?(this.flip.y=this.canFlipY,this.facing.y=-1):(this.flip.y=!1,this.facing.y=1))):(n=i instanceof ig.EntityExtended?i.pos.x+.5*i.size.x:i.x,e>n?(this.flip.x=this.canFlipX,this.facing.x=-1):(this.flip.x=!1,this.facing.x=1))}},lineOfSight:function(t){if(t.hidden)return!1;var i=ig.game.collisionMap,e=i.tilesize,s=(this.pos.x+.5*this.size.x)/e|0,n=(this.pos.y+.5*this.size.y)/e|0,a=((t.pos.x+.5*t.size.x)/e|0)-s,e=((t.pos.y+.5*t.size.y)/e|0)-n;t=Math.sqrt(a*a+e*e);var a=a/t,e=e/t,s=Math.round(s+a),n=Math.round(n+e),o=0;for(t=(t|0)-2;o<t;o++){if(!r.isTileWalkableStrict(i.data[n|0][s|0]))return!1;s+=a;n+=e}return!0},receiveDamage:function(t,i,e){return(!this.invulnerable||e)&&t?(this.health-=t,0>=this.health&&this.kill(),!0):!1},manageStart:function(){this.managed=!0},manageStop:function(){this.managed=!1},pause:function(){this.paused=!0;var t,i;for(t in this.anims)(i=this.anims[t])&&i.timer.pause();for(t in this.tweens)(i=this.tweens[t])&&i.pause()},unpause:function(){this.paused=!1;var t,i;for(t in this.anims)(i=this.anims[t])&&i.timer.unpause();for(t in this.tweens)(i=this.tweens[t])&&i.unpause()},link:function(t,i){if(t!==this){this.unlink(!1);if(this.linkedTo=t)ig.system.onResized.remove(this.refresh,this),this._killed||(this.linkedTo.onRefreshed.add(this.refresh,this),this.linkedTo.onRemoved.add(this.unlink,this));!1!==i&&!this._killed&&this.refresh(!0)}},unlink:function(t){this.linkedTo&&(this.linkedTo.onRefreshed.remove(this.refresh,this),this.linkedTo.onRemoved.remove(this.unlink,this),this._killed||ig.system.onResized.add(this.refresh,this),this.linkedTo=null);!1!==t&&!this._killed&&this.refresh(!0)},kill:function(t){this.dieing||(this.dieing=!0,this.dieingSilently=t||!1,t?this.die():this.death())},death:function(t){if(!t||!this.anims[t])t=this.getDirectionalAnimName("death");this.anims[t]?(ig.game.flagAsKilled(this),this.applyAntiVelocity(),this.animOverride(t,{callback:this.die})):this.die()},die:function(){ig.game.removeEntity(this)},cleanup:function(){this._cleanupPersistent&&(this._cleanupPersistent=!1,this.cleanupPersistent());this.unhide();this.tweenEnd();this.moveAllStop();this.unlink(!1);this.animRelease();this.currentAnim=null;this.onRemoved.dispatch(this);ig.system.onResized.remove(this.refresh,this);if(!ig.game.hasLevel){this.onAdded.removeAll();this.onAdded.forget();this.onRemoved.removeAll();this.onRemoved.forget();this.onMovedTo.removeAll();this.onMovedTo.forget();this.onRefreshed.removeAll();this.onRefreshed.forget();for(var t in this.anims){var i=this.anims[t];i.onCompleted.removeAll();i.onCompleted.forget()}}},cleanupPersistent:function(){},cleanupCollision:function(){this.wasChecking=this.checking;this.checking=this.intersecting=this.collidingWithEntitiesBelow=!1},intersectWith:function(){this.intersecting=!0},check:function(){this.checking=!0},collideWith:function(t,i,e,n,a,o){if(o){if(this===o){if(0!==i)this.vel.x=s.oppositeSidesOfZero(this.vel.x,i)?this.vel.x+t.vel.x:-this.vel.x*this.bounciness+t.vel.x,t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,n,0,this.size.x,this.size.y,this.collisionMapResult);else{this.vel.y=-this.vel.y*this.bounciness+t.vel.y;i=0;if(0<e&&(this.collidingWithEntitiesBelow=!0,(t.collides>=ig.EntityExtended.COLLIDES.FIXED||this.collides===ig.EntityExtended.COLLIDES.LITE)&&Math.abs(this.vel.y-t.vel.y)<this.minBounceVelocity))this.setGrounded(),t.moving&&(i=t.pos.x-t.last.x);t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,i,n,this.size.x,this.size.y,this.collisionMapResult)}if(t.pos.x!==this.pos.x||t.pos.y!==this.pos.y)this.pos.x=t.pos.x,this.pos.y=t.pos.y,this.recordChanges(!0)}}else{if(0!==i)this.vel.x=a,t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,.5*n,0,this.size.x,this.size.y,this.collisionMapResult);else{var h;if(0<e)this.collidingWithEntitiesBelow=!0,i=t.collides>=ig.EntityExtended.COLLIDES.FIXED||this.collides===ig.EntityExtended.COLLIDES.LITE?t.vel.x*ig.system.tick:0,h=t.grounded&&t.collidingWithMap;else{if(this.grounded&&this.collidingWithMap)return;i=0}h?(t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,i,n,this.size.x,this.size.y,this.collisionMapResult),0<this.bounciness&&this.vel.y>this.minBounceVelocity?this.vel.y*=-this.bounciness:this.setGrounded()):(this.vel.y=a,t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,i,.5*n,this.size.x,this.size.y,this.collisionMapResult))}if(t&&(t.pos.x!==this.pos.x||t.pos.y!==this.pos.y))this.pos.x=t.pos.x,this.pos.y=t.pos.y,this.recordChanges(!0)}},handleMovementTrace:function(t){var i=this.grounded,e,n;this.hasGravity&&(this.standing=!1,0!==this.vel.y&&!this.collidingWithEntitiesBelow&&(this.grounded=!1));this.collidingWithMap=!1;t.tile.x&&r.isTileClimbable(t.tile.x)?t.pos.x=this.pos.x+this.vel.x*ig.system.tick:t.collision.x&&(this.collidingWithMap=!0,this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(t.tile.y&&r.isTileClimbable(t.tile.y))if(this.climbing||!this.hasGravity||this._climbingIntentUp)t.pos.y=this.pos.y+this.vel.y*ig.system.tick,t.collision.y=t.collision.slope=!1;else if(this._climbingIntentDown){e=ig.game.collisionMap;var a=(n=e.data[Math.floor((this.pos.y+this.size.y+.5*e.tilesize)/e.tilesize)])&&n[Math.floor(this.pos.x/e.tilesize)];e=n&&n[Math.floor((this.pos.x+this.size.x)/e.tilesize)];if(("undefined"===typeof a||r.isTileWalkable(a))&&("undefined"===typeof e||r.isTileWalkable(e)))t.pos.y=this.pos.y+this.vel.y*ig.system.tick,t.collision.y=t.collision.slope=!1}t.collision.y&&(this.collidingWithMap=!0,0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:0>this.vel.y?this.vel.y=0:this.setGrounded());t.collision.slope?(a=this.slope=t.slope,this.collidingWithMap=!0,a.angle=Math.atan2(a.ny,a.nx),a.angle>this.slopeStanding.min&&a.angle<this.slopeStanding.max?(this.setGrounded(),0!==this.accel.x&&(!s.oppositeSidesOfZero(this.accel.x,this.vel.x)&&0>=a.nx*this.vel.x)&&(this.vel.y=0,t.pos.y+=-Math.abs((a.angle+s.HALFPI)*this.vel.x)*this.slopeSpeedMod*ig.system.tick)):0>this.vel.y&&(this.vel.y=0)):this.slope&&(this.jumping||this.setGrounded(),this.slope=null);if(i&&(i!==this.grounded&&!this.jumping)&&(e=ig.game.collisionMap,i=(n=e.data[Math.floor((this.pos.y+this.size.y+1)/e.tilesize)])&&n[Math.floor((this.pos.x+.5*this.size.x)/e.tilesize)],"undefined"===typeof i||r.isTileWalkableStrict(i)))this.vel.y=0,t.pos.y=this.pos.y;if(!this.slopeSticking||!(this.slope&&0===this.vel.x))this.pos.x=t.pos.x,this.pos.y=t.pos.y},update:function(){this.paused?ig.game.camera&&!ig.game.camera.paused&&(this.visible=this.getIsVisible()):this.frozen||(this.performance===ig.EntityExtended.PERFORMANCE.STATIC?this._changedAdd&&this.changed&&(this.updateBounds(),this.changed=!1):(this.controllable&&!this._killed&&(this.updateChanges(),this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&this.updateDynamics()),this.recordChanges(),this.recordLast()),(this.visible=this.getIsVisible())?this.updateVisible():this.dieing&&this.canDieInstantly&&this.die(),this.currentAnim&&this.currentAnim.update())},recordLast:function(){n.copy(this.last,this._posLast);n.copy(this._posLast,this.pos);n.copy(this._sizeLast,this.size);this._angleLast=this.angle},recordChanges:function(i){if(!0===i||this.pos.x!==this.last.x||this.pos.y!==this.last.y||this.size.x!==this._sizeLast.x||this.size.y!==this._sizeLast.y||this.angle!==this._angleLast){this.changed=!0;0!==this.vel.x?(this.movingX=!0,this.flip.x=0>this.vel.x?this.canFlipX:!1):this.movingX=!1;if(0!==this.vel.y){if(this.movingY=!this.hasGravity||0>this.vel.y||!this.grounded||!!this.slope&&this.movingX,t.TOP_DOWN||this.canFlipY)this.flip.y=0>this.vel.y?this.canFlipY:!1}else this.movingY=!1;this.moving=this.movingX||this.movingY;this.updateBounds()}else this.changed=this.moving=this.movingX=this.movingY=!1},updateBounds:function(){this.posDraw.x=this.getPosDrawX();this.posDraw.y=this.getPosDrawY();this.sizeDraw.x=this.getSizeDrawX();this.sizeDraw.y=this.getSizeDrawY();this.needsVertices?(this._verticesFound=!0,this.verticesWorld=this.getVerticesWorld()):this._verticesFound=!1},updateChanges:function(){this.moveToUpdate()},updateDynamics:function(){0===this.gravityFactor||0===ig.game.gravity?this.hasGravity=!1:(this.hasGravity=!0,this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor);this.updateVelocity();var t=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*ig.system.tick,this.size.x,this.size.y,this.collisionMapResult);this.handleMovementTrace(t)},updateVelocity:function(){this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y)},updateVisible:function(){this.overridingAnim&&this.currentAnim!==this.overridingAnim&&(this._overridedAnim=this.currentAnim,this.currentAnim=this.overridingAnim);this._changedAdd&&(this._changedAdd=!1,this.updateBounds())},draw:function(){if(this.currentAnim&&this.visible){var t=this.posDraw.x,i=this.posDraw.y,e=this.currentAnim.alpha,s=this.currentAnim.flip;this.currentAnim.alpha*=this.alpha;this.currentAnim.flip=this.flip;var n;0!==this.angle&&(n=this.currentAnim.angle,this.currentAnim.angle=this.angle,t+=.5*(this.sizeDraw.x-this.currentAnim.sheet.width),i+=.5*(this.sizeDraw.y-this.currentAnim.sheet.height));this.fixed?this.currentAnim.draw(t,i,this.scale,this.textured?this:void 0):this.currentAnim.draw(t-ig.game.screen.x,i-ig.game.screen.y,this.scale,this.textured?this:void 0);this.currentAnim.alpha=e;this.currentAnim.flip=s;0!==this.angle&&(this.currentAnim.angle=n)}}});ig.EntityExtended.PERFORMANCE={};ig.EntityExtended.PERFORMANCE.STATIC=t.STATIC||"static";ig.EntityExtended.PERFORMANCE.MOVABLE=t.MOVABLE||"movable";ig.EntityExtended.PERFORMANCE.DYNAMIC=t.DYNAMIC||"dynamic";var l=ig.EntityExtended,g=[],u=[],c,d;for(c in ig.Entity.TYPE)g.push({name:c,flag:ig.Entity.TYPE[c]});g.sort(function(t,i){return t.flag-i.flag});for(var p=0,m=g.length;p<m;p++){var y=g[p];c=y.name;d=y.flag;0===d||0!==(d&d-1)?u.push(y):e.getType(ig.EntityExtended,c)}p=0;for(m=u.length;p<m;p++)y=u[p],c=y.name,d=y.flag,ig.EntityExtended.TYPE[c]=d;l.TYPE=ig.EntityExtended.TYPE;ig.EntityExtended.TYPE.NONE;ig.EntityExtended.TYPE.A;ig.EntityExtended.TYPE.B;ig.EntityExtended.TYPE.BOTH;e.getType(ig.EntityExtended,"INTERACTIVE");ig.EntityExtended.TYPE.INTERACTIVE;e.getType(ig.EntityExtended,"DAMAGEABLE");ig.EntityExtended.TYPE.DAMAGEABLE;e.getType(ig.EntityExtended,"DANGEROUS");ig.EntityExtended.TYPE.DANGEROUS;ig.EntityExtended.GROUP={};ig.EntityExtended.GROUP.NONE=0;e.getType(ig.EntityExtended,"FRIEND","GROUP");ig.EntityExtended.GROUP.FRIEND;e.getType(ig.EntityExtended,"ENEMY","GROUP");ig.EntityExtended.GROUP.ENEMY;ig.EntityExtended.COLLIDES=ig.merge({},ig.Entity.COLLIDES);ig.EntityExtended.COLLIDES.DOUBLEFIXED=ig.EntityExtended.COLLIDES.FIXED+ig.EntityExtended.COLLIDES.FIXED;var f=ig.EntityExtended.COLLIDES.ACTIVE,E=ig.EntityExtended.COLLIDES.DOUBLEFIXED;ig.EntityExtended.checkPair=function(i,e){i.intersectWith(e);e.intersectWith(i);0===(i.group&e.group)&&(i.checkAgainst&e.type&&i.check(e),e.checkAgainst&i.type&&e.check(i),i.collides&&(e.collides&&i.collides+e.collides>f&&(t.COLLISION.ALLOW_FIXED||i.collides+e.collides<E)&&(!i.oneWay||e.getIsCollidingWithOneWay(i))&&(!e.oneWay||i.getIsCollidingWithOneWay(e)))&&ig.EntityExtended.solveCollision(i,e))};ig.EntityExtended.solveCollision=function(t,i){var e=null;if(t.collides===ig.EntityExtended.COLLIDES.LITE||i.collides===ig.EntityExtended.COLLIDES.FIXED)e=t;else if(i.collides===ig.EntityExtended.COLLIDES.LITE||t.collides===ig.EntityExtended.COLLIDES.FIXED)e=i;var s,n,a,o,h,r;t.pos.x<i.pos.x?(a=t,o=i,h=t.pos.x+t.size.x-i.pos.x):(a=i,o=t,h=i.pos.x+i.size.x-t.pos.x);t.pos.y<i.pos.y?(s=t,n=i,r=t.pos.y+t.size.y-i.pos.y):(s=i,n=t,r=i.pos.y+i.size.y-t.pos.y);var l;r>h||n.grounded&&s.collides===ig.EntityExtended.COLLIDES.FIXED?a.collides+o.collides>=E?(a.collideWith(o,1,0,-h,0),o.collideWith(a,-1,0,h,0)):(l=.5*(a.vel.x-o.vel.x),a.collideWith(o,1,0,-h,-l,e),o.collideWith(a,-1,0,h,l,e)):s.collides+n.collides>=E?(s.collideWith(n,0,1,-r,0),n.collideWith(s,0,-1,r,0)):(l=.5*(s.vel.y-n.vel.y),s.collideWith(n,0,1,-r,-l,e),n.collideWith(s,0,-1,r,l,e))};ig.global.wm&&ig.EntityExtended.inject({visible:!0,touches:function(t){return a.pointInAABB(t.pos.x,t.pos.y,this.pos.x,this.pos.y,this.pos.x+this.size.x,this.pos.y+this.size.y)},activate:function(){},draw:function(){this.refresh(!0);this.updateVisible();if(this.textured)for(var t in this.anims)this.anims[t].texturize(this);this.parent()}})});ig.baked=!0;ig.module("plusplus.entities.light").requires("plusplus.core.entity","plusplus.core.config","plusplus.core.image-drawing","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2","plusplus.helpers.utilsintersection","plusplus.helpers.utilscolor").defines(function(){var t=ig.CONFIG,i=ig.utils,e=ig.utilsmath,s=ig.utilsvector2,n=ig.utilsintersection,a=ig.utilscolor;ig.EntityLight=ig.global.EntityLight=ig.EntityExtended.extend({_wmScalable:!0,_wmScalableLinked:!0,layerName:"lights",size:{x:10,y:10},radius:10,r:t.LIGHT.R,g:t.LIGHT.G,b:t.LIGHT.B,alpha:t.LIGHT.ALPHA,dynamicColor:!1,pixelPerfect:t.LIGHT.PIXEL_PERFECT,gradient:t.LIGHT.GRADIENT,castsShadows:t.LIGHT.CASTS_SHADOWS,castsShadowsMovable:t.LIGHT.CASTS_SHADOWS_MOVABLE,items:[],diffuse:t.LIGHT.DIFFUSE,samples:t.LIGHT.SAMPLES,image:null,imageBase:null,imageCast:null,imageColor:null,_shadowCastingInitialized:!1,_dirtySize:!1,_dirtyColor:!1,_scaleComputedAt:0,_rLast:0,_gLast:0,_bLast:0,_alphaLast:0,_sizeLast:{x:0,y:0},_radiusLast:0,initTypes:function(){this.parent();i.addType(ig.EntityExtended,this,"type","LIGHT")},initProperties:function(){this.image=new ig.ImageDrawing;this.imageBase=new ig.ImageDrawing;this.imageCast=new ig.ImageDrawing;this.imageColor=new ig.ImageDrawing;this.parent()},resetCore:function(t,i,e){e&&e.radius&&(this.size.x=this.size.y=2*e.radius);this.parent(t,i,e);this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.performance=ig.EntityExtended.PERFORMANCE.MOVABLE)},resize:function(t){this.recordChanges();this.changed&&(t=this.needsRebuild=!0);return t},rebuild:function(){this.compute();this.parent()},ready:function(){ig.system.onResized.add(this.resize,this);this.parent()},getRadius:function(){return.5*Math.max(this.size.x,this.size.y)},getSizeDrawX:function(){return 2*this.radius},getSizeDrawY:function(){return 2*this.radius},compute:function(){this.castsShadows&&(this.performance===ig.EntityExtended.PERFORMANCE.MOVABLE||this._changedAdd)&&this.findItems();if(this.changed||this._changedAdd){this.performance===ig.EntityExtended.PERFORMANCE.STATIC&&(this.changed=!1);if(this._dirtySize||this.castsShadows&&!this.imageCast)this._dirtySize=!1,this._scaleComputedAt=this.scale,this.resizeCache(),this.drawLight();this.castsShadows&&this.drawShadows()}},resizeCache:function(){var t=2*this.radius;this.pixelPerfect||(t*=this.scale);this.castsShadows?(this.image.setDimensions(t,t),this.imageBase.setDimensions(t,t),this.imageCast.setDimensions(t,t)):(this.image.setDimensions(t,t),(0!==this.imageBase.width||0!==this.imageBase.height)&&this.imageBase.setDimensions(0,0),(0!==this.imageCast.width||0!==this.imageCast.height)&&this.imageCast.setDimensions(0,0));this.dynamicColor&&(this.imageColor.setDimensions(t,t),this._dirtyColor=!0)},drawLight:function(){var t=this.castsShadows?this.imageBase:this.image,i,s,o,h,r;this.dynamicColor?r=h=o=1:(o=this.r,h=this.g,r=this.b);i=t.dataContext;if(this.pixelPerfect){var l=2*this.radius;s=i.createImageData(l,l);for(var g=0;g<l;g++)for(var u=0;u<l;u++)if(n.pointInCircle(g,u,this.radius,this.radius,this.radius)){var c=4*(g+u*l);s.data[c]=255*o|0;s.data[c+1]=255*h|0;s.data[c+2]=255*r|0;if(this.gradient){var d=this.radius-g,p=this.radius-u,d=1-Math.sqrt(d*d+p*p)/this.radius;s.data[c+3]=255*d|0}else s.data[c+3]=255}i.putImageData(s,0,0);t.finalize(1)}else l=this.radius*this.scale,this.gradient?(s=2*l,o=a.radialGradient(l,[{r:o,g:h,b:r},{r:o,g:h,b:r,a:0}]),i.fillStyle=o,i.fillRect(0,0,s,s)):(i.fillStyle=a.RGBToCSS(o,h,r),i.arc(l,l,l,0,e.TWOPI,!1),i.fill()),t.finalize(this.scale)},findItems:function(){for(var t=this.pos.x,i=this.pos.y,e=t+this.size.x,s=i+this.size.y,a=this.items.length,o=this.items.length=0,h=ig.game.layers.length;o<h;o++){var r=ig.game.layers[o];if(r.numEntities)for(var r=r.itemsOpaque,l=0,g=r.length;l<g;l++){var u=r[l];if(!0!==u._killed&&(u.performance===ig.EntityExtended.PERFORMANCE.STATIC||this.castsShadowsMovable&&!this.pixelPerfect)&&n.AABBIntersect(t,i,e,s,u.pos.x,u.pos.y,u.pos.x+u.size.x,u.pos.y+u.size.y)){this.items.push(u);var c=u.currentAnim;if(u.changed)this.changed=!0;else if(c&&(c!==u._animCastShadow&&(c.opaqueOffset||u._animCastShadow&&u._animCastShadow.opaqueOffset)||c.changed&&c.opaqueOffset&&c.opaqueOffset.tiles))this.changed=!0,u.opaqueFromVertices||(u._verticesFound=!1);
u._animCastShadow=c}}}a!==this.items.length&&(this.changed=!0)},_initShadowCasting:function(){this._shadowCastingInitialized||(this._utilVec2Samples1={x:0,y:0},this._utilVec2Samples2={x:0,y:0},this._utilVec2Samples3={x:0,y:0})},drawShadows:function(){this._initShadowCasting();var t=this.imageCast.dataContext,i=2*this.radius;this.pixelPerfect?(t.clearRect(0,0,i,i),this.castShadows(),this.imageCast.finalize(1)):(i*=this.scale,t.clearRect(0,0,i,i),this.castShadows(),this.imageCast.finalize(this.scale));var t=this.image.dataContext,e=t.globalCompositeOperation;t.clearRect(0,0,i,i);t.drawImage(this.imageBase.data,0,0);t.globalCompositeOperation="destination-out";t.drawImage(this.imageCast.data,0,0);t.globalCompositeOperation=e;this.image.finalize(this.pixelPerfect?1:this.scale)},castShadows:function(){var t=this.imageCast.dataContext,i=this.pos.x,n=this.pos.y,a=this.radius,o=s.set(this._utilVec2Samples1,i+a,n+a),h,r;if(1===this.samples){h=0;for(r=this.items.length;h<r;h++)this.items[h].castShadow(this,t,o,i,n,a)}else for(var l=0;l<this.samples;++l){h=l*e.GOLDEN_ANGLE;r=Math.sqrt(l/this.samples)*this.radius;h=s.set(this._utilVec2Samples2,Math.cos(h)*r,Math.sin(h)*r);s.copy(this._utilVec2Samples3,o);s.add(this._utilVec2Samples3,h);h=0;for(r=this.items.length;h<r;h++)this.items[h].castShadow(this,t,this._utilVec2Samples3,i,n,a)}},cleanup:function(){ig.system.onResized.remove(this.resize,this);this.parent()},recordChanges:function(t){if(0===this.alpha)this.visible=!1;else{this._dirtySize=this._scaleComputedAt!==this.scale||0!==this.radius-this._radiusLast||0!==this.size.x-this._sizeLast.x|0!==this.size.y-this._sizeLast.y;if(0!==this.alpha-this._alphaLast||this._dirtySize)t=!0;if(this.dynamicColor){var i=this.g-this._gLast,e=this.b-this._bLast;if(0!==this.r-this._rLast||0!==i||0!==e)t=this._dirtyColor=!0;this._rLast=this.r;this._gLast=this.g;this._bLast=this.b}s.copy(this._sizeLast,this.size);this._radiusLast=this.radius;this._alphaLast=this.alpha}this.parent(t)},updateBounds:function(){this.radius=this.getRadius();this.posDraw.x=this.pos.x;this.posDraw.y=this.pos.y},updateVisible:function(){this.compute();this.parent()},draw:function(){var t=this.image;if(this.visible&&t){if(this.dynamicColor){if(this._dirtyColor){this._dirtyColor=!1;t=2*this.radius;this.pixelPerfect||(t*=this.scale);var i=this.imageColor.dataContext;i.fillStyle=a.RGBToCSS(this.r,this.g,this.b);i.fillRect(0,0,t,t);i.globalCompositeOperation="destination-atop";i.drawImage(this.image.data,0,0);this.imageColor.finalize(this.pixelPerfect?1:this.scale)}t=this.imageColor}i=ig.system.context;1!==this.alpha&&(i.globalAlpha=this.alpha);this.fixed?t.draw(this.posDraw.x,this.posDraw.y,void 0,void 0,void 0,void 0,this.scale):t.draw(this.posDraw.x-ig.game.screen.x,this.posDraw.y-ig.game.screen.y,void 0,void 0,void 0,void 0,this.scale);1!==this.alpha&&(i.globalAlpha=1)}}});ig.global.wm&&ig.EntityLight.inject({dynamicColor:!0,init:function(t,i,e){this.parent(t,i,e);this.performance=ig.EntityExtended.PERFORMANCE.MOVABLE},findItems:function(){},resizeCache:function(){var t=2*this.radius;this.pixelPerfect||(t*=this.scale);this.imageBase=this.imageCast=this.image;this.image.setDimensions(t,t);this.imageColor.setDimensions(t,t);this._dirtyColor=!0},drawShadows:function(){},draw:function(){this.refresh();this.parent()}})});ig.baked=!0;ig.module("plusplus.core.layer").requires("plusplus.core.config","plusplus.core.entity","plusplus.core.background-map","plusplus.entities.light","plusplus.helpers.utils").defines(function(){var t=ig.CONFIG,i=ig.utils;ig.Layer=ig.Class.extend({name:"",zIndex:0,clearOnLoad:!0,noUpdate:!1,noDraw:!1,preRender:t.PRERENDER_MAPS,items:[],itemsTargetable:[],itemsInteractive:[],itemsOpaque:[],itemsLight:[],itemsChecking:[],spatialHash:{},spatialHashCellSize:64,autoSort:t.AUTO_SORT_LAYERS,sortBy:!1,numEntities:0,numBackgroundMaps:0,changed:!0,paused:!1,ignorePause:!1,_dirtySort:!1,_dirtyItems:!1,_itemsToAdd:[],init:function(t,i){this.name=t;ig.merge(this,i);this.reset()},reset:function(){this.changed=!0;this._dirtySort=this.paused=!1;this.sortBy=this.sortBy||ig.game.sortBy;if(0<this.items.length){var t=this.items,i,e,s;if(!this.clearOnLoad){this._itemsToAdd=this.items.slice(0);e=0;for(s=this._itemsToAdd.length;e<s;e++)i=this._itemsToAdd[e],i.linkedTo&&(i._wasLinkedTo=i.linkedTo)}this.items=[];e=this.itemsTargetable.length=this.itemsInteractive.length=this.itemsOpaque.length=this.itemsLight.length=this.itemsChecking.length=this.numBackgroundMaps=this.numEntities=0;for(s=t.length;e<s;e++)i=t[e],i instanceof ig.EntityExtended?ig.game.removeEntity(i):ig.game.removeItem(i)}},ready:function(){var t,i,e;if(0<this._itemsToAdd.length){t=0;for(i=this._itemsToAdd.length;t<i;t++)e=this._itemsToAdd[t],e._wasLinkedTo?(ig.game.spawnEntity(e,e.pos.x,e.pos.y,{linkedTo:e._wasLinkedTo}),delete e._wasLinkedTo):ig.game.spawnEntity(e,e.pos.x,e.pos.y,e._wasLinkedTo?{linkedTo:e._wasLinkedTo}:void 0);this._itemsToAdd.length=0}if(0<this.items.length){this.items.sort(this.sortBy);if(this.preRender&&1<this.numBackgroundMaps){var s=[],n,a;t=0;for(i=this.items.length;t<i;t++)if(e=this.items[t],e instanceof ig.BackgroundMap){if(e.preRender&&!e.repeat){if(e.distance!==a||!n)n=[];n.push(e)}else n&&1<n.length&&(s.push(n),n=void 0);a=e.distance}n&&1<n.length&&s.push(n);t=0;for(i=s.length;t<i;t++){n=s[t];a=n[0];a instanceof ig.BackgroundMapExtended||(a=n[0]=new ig.BackgroundMapExtended(a.tilesize,a.data,a.tilesetName));for(var o=1,h=n.length;o<h;o++)e=n[o],a.merge(e)&&this.removeItem(e)}}t=0;for(i=this.items.length;t<i;t++)e=this.items[t],e.adding&&e.adding()}},addItem:function(t){this._dirtyItems=!0;this.items.push(t);t.highPerformance?this._addEntity(t):(t.targetable&&this.itemsTargetable.push(t),t.type&ig.EntityExtended.TYPE.INTERACTIVE&&this.itemsInteractive.push(t),t instanceof ig.EntityLight?this.itemsLight.push(t):t.opaque&&this.itemsOpaque.push(t),t instanceof ig.EntityExtended?this._addEntity(t):t instanceof ig.BackgroundMap&&(this.numBackgroundMaps++,this.preRender&&(t.preRender=!0)),this.autoSort&&this.sort())},removeItem:function(t){var e=this.items.length;0<e&&(this._dirtyItems=!0,i.arrayCautiousRemove(this.items,t),e!==this.items.length&&(t.highPerformance?this._removeEntity(t):(i.arrayCautiousRemove(this.itemsInteractive,t),i.arrayCautiousRemove(this.itemsTargetable,t),i.arrayCautiousRemove(this.itemsOpaque,t),t instanceof ig.EntityLight&&i.arrayCautiousRemove(this.itemsLight,t),t instanceof ig.EntityExtended?this._removeEntity(t):t instanceof ig.BackgroundMap&&(this.numBackgroundMaps=Math.max(0,this.numBackgroundMaps-1)),this.autoSort&&this.sort())))},_addEntity:function(t){this.numEntities++;(t.type!==ig.Entity.TYPE.NONE||t.checkAgainst!==ig.EntityExtended.TYPE.NONE||t.collides!==ig.EntityExtended.COLLIDES.NEVER||t.collidesChanges)&&this.itemsChecking.push(t)},_removeEntity:function(t){this.numEntities=Math.max(0,this.numEntities-1);var e=this.itemsChecking.length;i.arrayCautiousRemove(this.itemsChecking,t);this.itemsChecking.length!==e&&0===this.itemsChecking.length&&(this.spatialHash={})},pause:function(){if(!this.ignorePause){this.paused=!0;for(var t=this.items,i=0,e=t.length;i<e;i++){var s=t[i];s.pause&&s.pause()}}},unpause:function(){this.paused=!1;for(var t=this.items,i=0,e=t.length;i<e;i++){var s=t[i];s.unpause&&s.unpause()}},sort:function(){this._dirtySort=!0},update:function(){var t,i,e;this.changed=this.changedLights=!1;this._dirtySort&&(this.items.sort(this.sortBy),this._dirtySort=!1);if(!this.noUpdate&&0<this.items.length){this._dirtyItems&&(this.changed=!0,this._dirtyItems=!1);t=0;for(i=this.items.length;t<i;t++)if(e=this.items[t],e.update(),!e.highPerformance&&!e.paused&&(e.changed||e.intersecting||e.checking))this.changed=!0,e instanceof ig.EntityLight&&(this.changedLights=!0);this.changed&&(0<this.itemsChecking.length&&this.checkEntities(),this.autoSort&&this.sort())}},draw:function(){if(!this.noDraw&&0<this.items.length)for(var t=0,i=this.items.length;t<i;t++)this.items[t].draw()},checkEntities:function(){for(var t=this.spatialHash={},i=this.spatialHashCellSize,e=0,s=this.itemsChecking.length;e<s;e++){var n=this.itemsChecking[e];n.cleanupCollision();for(var a={},o=Math.floor(n.pos.y/i),h=Math.floor((n.pos.x+n.size.x)/i)+1,r=Math.floor((n.pos.y+n.size.y)/i)+1,l=Math.floor(n.pos.x/i);l<h;l++)for(var g=o;g<r;g++){var u=t[l];u||(u=t[l]={});var c=u[g];if(c){for(var u=0,d=c.length;u<d;u++){var p=c[u];a[p.id]||(a[p.id]=!0,n.touches(p)&&ig.EntityExtended.checkPair(n,p))}c.push(n)}else u[g]=[n]}}}})});ig.baked=!0;ig.module("plusplus.core.input").requires("impact.input","plusplus.core.config","plusplus.helpers.utils","plusplus.helpers.utilsintersection").defines(function(){var t=ig.CONFIG.GESTURE,i=ig.utils,e=ig.utilsintersection;ig.Input.inject({inputPoints:[],initMouse:function(){this.parent();ig.system.canvas.addEventListener("mouseout",this.keycancel.bind(this),!1);ig.system.canvas.addEventListener("mouseleave",this.keycancel.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchcancel",this.keycancel.bind(this),!1),ig.system.canvas.addEventListener("MSPointerOut",this.keycancel.bind(this),!1),ig.system.canvas.addEventListener("MSPointerLeave",this.keycancel.bind(this),!1))},keydown:function(t){if("mousedown"==t.type||"touchstart"==t.type){var i;if(t.changedTouches)for(var e=0,s=t.changedTouches.length;e<s;e++)i=this.getInputPoint(t.changedTouches[e]),i.touch=!0,i.setDown();else i=this.getInputPoint(t),i.setDown()}this.parent(t)},keyup:function(t){if("mouseup"===t.type||"touchend"===t.type||"mouseout"===t.type||"mouseleave"===t.type||"touchcancel"===t.type){var i;if(t.changedTouches)for(var e=0,s=t.changedTouches.length;e<s;e++)i=this.getInputPoint(t.changedTouches[e]),i.setUp();else i=this.getInputPoint(t),i.setUp();this.mousemove(t,!0)}this.parent(t)},keycancel:function(t){var i=this.bindings[2===t.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1];i&&this.actions[i]&&this.keyup(t)},mousemove:function(t){var i=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,i=ig.system.scale*(i/ig.system.realWidth),e;ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());if(t.changedTouches)for(var s=0,n=t.changedTouches.length;s<n;s++)this.inputPointMove(t.changedTouches[s],i,e);else this.inputPointMove(t,i,e);t=this.inputPoints[0];ig.input.mouse.x=t.x;ig.input.mouse.y=t.y},inputPointMove:function(t,i,e){var s=t.clientX,n=t.clientY;e&&(s-=e.left,n-=e.top);s/=i;n/=i;this.getInputPoint(t,s,n).reposition(s,n)},getInputPointId:function(t){if("string"===typeof t)return t;if(t){if("string"===typeof t.identifier)return t.identifier;if(t.properties&&t.values)return i.indexOfProperties(this.inputPoints,t.properties,t.values)}return 0},getInputPoint:function(t){t=this.getInputPointId(t);var i=this.inputPoints[t];i||(i=this.inputPoints[t]=new ig.InputPoint(0,0,t));return i},getInputPoints:function(t,i){for(var e=[],s=0,n=this.inputPoints.length;s<n;s++){for(var a=this.inputPoints[s],o,h=0,r=t.length;h<r;h++)if(i[h]!==a[t[h]]){o=!0;break}!0!==o&&e.push(a)}return e},removeInputPoint:function(t){t=this.getInputPointId(t);var i=this.inputPoints[t];i&&(i.setUp(),this.inputPoints.splice(t,1))},inputPressed:function(t){if(t=this.bindings[t])this.actions[t]=!0,this.locks[t]||(this.presses[t]=!0,this.locks[t]=!0)},inputReleased:function(t){(t=this.bindings[t])&&(this.delayedKeyup[t]=!0)},update:function(){for(var t=0,i=this.inputPoints.length;t<i;t++)this.inputPoints[t].update()}});ig.InputPoint=ig.Class.extend({id:0,x:0,y:0,lastX:0,lastY:0,worldX:0,worldY:0,deltaX:0,deltaY:0,directionX:0,directionY:0,downDeltaX:0,downDeltaY:0,swipeDistanceX:0,swipeDistanceY:0,swipeTotalDeltaX:0,swipeTotalDeltaY:0,duration:0,targets:null,targetsUp:null,targetsDown:null,targetsDownStart:null,down:!1,tapped:!1,holding:!1,holdingActivate:!1,moved:!1,swipingX:!1,swipingY:!1,swipingLeft:!1,swipingRight:!1,swipingUp:!1,swipingDown:!1,_taps:0,_downTotalDeltaX:0,_downTotalDeltaY:0,_directionDeltaTotalX:0,_directionDeltaTotalY:0,_durationReleased:0,_durationSwipeTry:0,_unpositioned:!0,_movedWithReposition:!1,_holdingActivatable:!0,_downLast:!1,_blockTap:!1,init:function(t,i,e){this.x=t||0;this.y=i||0;this.id=e||0;this.targets=[];this.targetsUp=[];this.targetsDown=[];this.targetsDownStart=[];this.lastX=this.x;this.lastY=this.y;this.worldX=this.x+ig.game.screen.x;this.worldY=this.y+ig.game.screen.y},reset:function(){this._unpositioned=!0;this.lastX=this.x;this.lastY=this.y;this.worldX=this.x+ig.game.screen.x;this.worldY=this.y+ig.game.screen.y;this._taps=this._durationReleased=this.deltaX=this.deltaY=this.directionX=this.directionY=this._directionDeltaTotalX=this._directionDeltaTotalY=0;this.moved=this._movedWithReposition=!1;this.resetTargets();this.resetDown()},resetTargets:function(){this.targets.length=this.targetsUp.length=this.targetsDown.length=this.targetsDownStart.length=0},resetDown:function(){!1!==this.down&&(this.holding&&ig.input.inputReleased(ig.KEY.HOLD),this.duration=this.downDeltaX=this.downDeltaY=this._downTotalDeltaX=this._downTotalDeltaY=0,this.down=this._downLast=this.holding=this._blockTap=this.holdingActivate=!1,this._holdingActivatable=!0,this.resetSwipe())},resetSwipe:function(){!1!==this.swiping&&(ig.input.inputReleased(ig.KEY.SWIPE),this.releaseSwipeX(),this.releaseSwipeY(),this.swiping=!1,this.resetSwipeValues())},resetSwipeValues:function(){this._durationSwipeTry=this.swipeDistanceX=this.swipeDistanceY=this.swipeTotalDeltaX=this.swipeTotalDeltaY=0},releaseSwipeX:function(){this.swipingX&&(ig.input.inputReleased(ig.KEY.SWIPE_X),this.swipingLeft?(ig.input.inputReleased(ig.KEY.SWIPE_LEFT),this.swipingLeft=!1):this.swipingRight&&(ig.input.inputReleased(ig.KEY.SWIPE_RIGHT),this.swipingRight=!1),this.swipingX=!1)},releaseSwipeY:function(){this.swipingY&&(ig.input.inputReleased(ig.KEY.SWIPE_Y),this.swipingUp?(ig.input.inputReleased(ig.KEY.SWIPE_UP),this.swipingUp=!1):this.swipingDown&&(ig.input.inputReleased(ig.KEY.SWIPE_DOWN),this.swipingDown=!1),this.swipingY=!1)},setDown:function(){this.resetDown();this.down=!0},setUp:function(){this.down&&(this._blockTap?(this._taps=0,this.tapped=!1):(this.tapped=!0,this._taps++,this._durationReleased=0,ig.input.inputReleased(ig.KEY.TAP),2===this._taps&&this._downTotalDeltaX*this._downTotalDeltaX+this._downTotalDeltaY*this._downTotalDeltaY<=this.screenSize*this.screenSize*t.TAP_MULTI_DISTANCE_PCT&&(this._taps=0,ig.input.inputReleased(ig.KEY.TAP_DOUBLE)),t.TARGET_TAP&&(this.targets=t.TARGET_DOWN_START?this.targetsDownStart:this.getTargets())),this.resetDown())},getTargets:function(){var i=t.TARGET_SEARCH_RADIUS/ig.system.scale;return e.entitiesInAABB(this.worldX-i,this.worldY-i,this.worldX+i,this.worldY+i,!0)},reposition:function(i,e){var s,n;this.screenSize=Math.min(ig.system.width,ig.system.height);if(this._unpositioned)this.x=i,this.y=e,this._unpositioned=!1;else{this.deltaX=i-this.x;this.deltaY=e-this.y;if(0!==this.deltaX){var a=0>this.deltaX?-1:1;this.directionX!==a&&(this._directionDeltaTotalX+=this.deltaX*a,this._directionDeltaTotalX>=this.screenSize*t.DIRECTION_SWITCH_PCT&&(s=!0,this._directionDeltaTotalX=0,this.directionX=a))}0!==this.deltaY&&(a=0>this.deltaY?-1:1,this.directionY!==a&&(this._directionDeltaTotalY+=this.deltaY*a,this._directionDeltaTotalY>=this.screenSize*t.DIRECTION_SWITCH_PCT&&(n=!0,this._directionDeltaTotalY=0,this.directionY=a)));this._movedWithReposition=0!==this.deltaX||0!==this.deltaY;this.x=i;this.y=e}this.worldX=this.x+ig.game.screen.x;this.worldY=this.y+ig.game.screen.y;t.TARGET_UP&&(this.targetsUp=this.getTargets());this.down&&(t.TARGET_DOWN&&(this.targetsDown=t.TARGET_UP?this.targetsUp:this.getTargets()),this._downLast!==this.down&&(this._downLast=this.down,t.TARGET_DOWN_START&&(this.targetsDownStart=t.TARGET_DOWN?this.targetsDown:t.TARGET_UP?this.targetsUp:this.getTargets())),this.downDeltaX=this.deltaX,this.downDeltaY=this.deltaY,this._downTotalDeltaX+=this.downDeltaX,this._downTotalDeltaY+=this.downDeltaY,this._holdingActivatable&&this._downTotalDeltaX*this._downTotalDeltaX+this._downTotalDeltaY*this._downTotalDeltaY>=this.screenSize*this.screenSize*t.HOLD_ACTIVATE_DISTANCE_PCT&&(this._holdingActivatable=!1),this.swipeTotalDeltaX+=this.downDeltaX,this.swipeTotalDeltaY+=this.downDeltaY,this.swipeDistanceX=0>this.swipeTotalDeltaX?-this.swipeTotalDeltaX:this.swipeTotalDeltaX,this.swipeDistanceY=0>this.swipeTotalDeltaY?-this.swipeTotalDeltaY:this.swipeTotalDeltaY,!0!==this.swiping&&this._durationSwipeTry>t.SWIPE_DURATION_TRY?this.resetSwipeValues():(!0!==this.swipingX&&this.swipeDistanceX>=this.screenSize*t.SWIPE_DISTANCE_PCT&&(this.swiping=this._blockTap=!0,this._holdingActivatable=!1,ig.input.inputPressed(ig.KEY.SWIPE),this.swipingX=s=!0,ig.input.inputPressed(ig.KEY.SWIPE_X)),this.swipingX&&s&&(-1===this.directionX?(this.swipingRight&&(this.swipingRight=!1,ig.input.inputReleased(ig.KEY.SWIPE_RIGHT)),this.swipingLeft=!0,ig.input.inputPressed(ig.KEY.SWIPE_LEFT)):1===this.directionX&&(this.swipingLeft&&(this.swipingLeft=!1,ig.input.inputReleased(ig.KEY.SWIPE_LEFT)),this.swipingRight=!0,ig.input.inputPressed(ig.KEY.SWIPE_RIGHT))),!0!==this.swipingY&&this.swipeDistanceY>=this.screenSize*t.SWIPE_DISTANCE_PCT&&(this.swiping=this._blockTap=!0,this._holdingActivatable=!1,ig.input.inputPressed(ig.KEY.SWIPE),this.swipingY=n=!0,ig.input.inputPressed(ig.KEY.SWIPE_Y)),this.swipingY&&n&&(-1===this.directionY?(this.swipingDown&&(this.swipingDown=!1,ig.input.inputReleased(ig.KEY.SWIPE_DOWN)),this.swipingUp=!0,ig.input.inputPressed(ig.KEY.SWIPE_UP)):1===this.directionY&&(this.swipingUp&&(this.swipingUp=!1,ig.input.inputReleased(ig.KEY.SWIPE_UP)),this.swipingDown=!0,ig.input.inputPressed(ig.KEY.SWIPE_DOWN)))))},update:function(){this.moved=0!==this.x-this.lastX||0!==this.y-this.lastY;this.lastX=this.x;this.lastY=this.y;this.worldX=this.x+ig.game.screen.x;this.worldY=this.y+ig.game.screen.y;this.down?(this.duration+=ig.system.tick,this._durationSwipeTry+=ig.system.tick,!this.holding&&this.duration>=t.HOLD_DELAY&&(this.holding=!0,ig.input.inputPressed(ig.KEY.HOLD)),!this._blockTap&&this.duration>=t.HOLD_DELAY_BLOCK_TAP&&(this._blockTap=!0),this._holdingActivatable&&(!this.holdingActivate&&this.duration>=t.HOLD_DELAY_ACTIVATE)&&(this.holdingActivate=!0,ig.input.inputPressed(ig.KEY.HOLD_ACTIVATE)),!this.moved&&this._durationSwipeTry>t.SWIPE_DURATION_RESET&&this.resetSwipe()):0<this._taps&&(this._durationReleased+=ig.system.tick,this._durationReleased>=t.RELEASE_DELAY&&(this.touch?ig.input.removeInputPoint(this.id):this._taps=0))}});ig.KEY.TAP=-6;ig.KEY.TAP_DOUBLE=-7;ig.KEY.HOLD=-9;ig.KEY.HOLD_ACTIVATE=-10;ig.KEY.SWIPE=-11;ig.KEY.SWIPE_X=-12;ig.KEY.SWIPE_Y=-13;ig.KEY.SWIPE_LEFT=-14;ig.KEY.SWIPE_RIGHT=-15;ig.KEY.SWIPE_UP=-16;ig.KEY.SWIPE_DOWN=-17});ig.baked=!0;ig.module("plusplus.ui.ui-element").requires("plusplus.core.config","plusplus.core.entity","plusplus.helpers.signals","plusplus.helpers.utils").defines(function(){var t=ig.CONFIG,i=ig.utils;ig.UIElement=ig.global.UIElement=ig.EntityExtended.extend({layerName:"ui",frozen:!0,visible:!0,fixed:!0,canFlipX:t.UI.CAN_FLIP_X,canFlipY:t.UI.CAN_FLIP_Y,posAsPct:t.UI.POS_AS_PCT,posPct:{x:0,y:0},align:{x:0,y:0},margin:{x:0,y:0},marginAsPct:!0,marginAsPctSmallest:t.UI.MARGIN_AS_PCT_SMALLEST,marginScaleless:t.UI.MARGIN_SCALELESS,totalMarginX:0,totalMarginY:0,scale:t.UI.SCALE,scaleOfSystemScale:t.UI.SCALE_OF_SYSTEM_SCALE,scaleMin:t.UI.SCALE_MIN,scaleMax:t.UI.SCALE_MAX,ignoreSystemScale:t.UI.IGNORE_SYSTEM_SCALE,linkAlign:{x:0,y:0},linkAlignInside:!1,autoDeactivate:!0,initTypes:function(){this.parent();i.addType(ig.EntityExtended,this,"type","UI")},changePerformanceDynamic:function(){"ui"===this.layerName&&(ig.game.removeItem(this,{layerName:this.layerName}),this.layerName="entities",ig.game.addItem(this))},cleanup:function(){this.autoDeactivate&&this.deactivate();this.parent()},reposition:function(t){var i=this.linkAlignInside?-1:1;if(!this.getIsMovingSelf()){if(this.linkedTo){var e=this.scale/ig.system.scale,s=this.sizeDraw.x*e,e=this.sizeDraw.y*e,n=this.linkedTo.scale/ig.system.scale,a=this.linkedTo.sizeDraw.x*n,n=this.linkedTo.sizeDraw.y*n;this.pos.x=this.linkedTo.posDraw.x+.5*(a-s);this.pos.y=this.linkedTo.posDraw.y+.5*(n-e);this.pos.x+=this.linkAlign.x*.5*(a+s*i);this.pos.y+=this.linkAlign.y*.5*(n+e*i)}else this.posAsPct?(this.pos.x=this.posPct.x*ig.system.width,this.pos.y=this.posPct.y*ig.system.height):(this.pos.x=this.resetState.pos.x,this.pos.y=this.resetState.pos.y);this.totalMarginX=Math.round(this.marginAsPct?this.margin.x*(this.marginAsPctSmallest?ig.system.size:ig.system.width):this.margin.x);this.totalMarginY=Math.round(this.marginAsPct?this.margin.y*(this.marginAsPctSmallest?ig.system.size:ig.system.height):this.margin.y);this.marginScaleless&&(this.totalMarginX/=this.scale,this.totalMarginY/=this.scale);this.linkedTo?(this.pos.x+=this.linkAlign.x*this.totalMarginX*i,this.pos.y+=this.linkAlign.y*this.totalMarginY*i):(this.pos.x=this.pos.x-this.align.x*this.sizeDraw.x*this.scaleMod+((1-this.align.x)*this.totalMarginX-this.align.x*this.totalMarginX),this.pos.y=this.pos.y-this.align.y*this.sizeDraw.y*this.scaleMod+((1-this.align.y)*this.totalMarginY-this.align.y*this.totalMarginY))}return this.parent(t)},moveTo:function(t,i){this.align.x=this.align.y=this.margin.x=this.margin.y=0;this.unlink(!1);return this.parent(t,i)},link:function(t,i){this.movingTo?this.unlink(!1):this.parent(t,i)},unlink:function(t){if(this.linkedTo&&!this._killed&&!1!==t){var i=this.pos.x,e=this.pos.y,i=i+(this.align.x*this.sizeDraw.x*this.scaleMod-((1-this.align.x)*this.totalMarginX-this.align.x*this.totalMarginX)),e=e+(this.align.y*this.sizeDraw.y*this.scaleMod-((1-this.align.y)*this.totalMarginY-this.align.y*this.totalMarginY));this.posAsPct?(this.posPct.x=i/ig.system.width,this.posPct.y=e/ig.system.height):(this.resetState.pos.x=i,this.resetState.pos.y=e)}this.parent(t)}});i.getType(ig.EntityExtended,"UI");ig.EntityExtended.TYPE.UI});ig.baked=!0;ig.module("plusplus.ui.ui-text").requires("plusplus.core.config","plusplus.core.font","plusplus.core.image-drawing","plusplus.ui.ui-element").defines(function(){var t=ig.CONFIG;ig.UIText=ig.global.UIText=ig.UIElement.extend({align:{x:0,y:0},linkAlign:{x:0,y:0},font:null,scale:t.FONT.SCALE,scaleOfSystemScale:t.FONT.SCALE_OF_SYSTEM_SCALE,scaleMin:t.FONT.SCALE_MIN,scaleMax:t.FONT.SCALE_MAX,ignoreSystemScale:t.FONT.IGNORE_SYSTEM_SCALE,text:"",textDisplay:"",textOverflow:"",autoRefreshText:!0,changedText:!1,textImage:null,textAlign:ig.Font.ALIGN.CENTER,maxWidth:0,maxHeight:0,_text:"",refresh:function(t){this.font=this.font||ig.Font.FONTS.MAIN;this.text&&this.font?this.textImage||(this.textImage=new ig.ImageDrawing):this.textImage&&(this.textImage=null);this.parent(t)},resize:function(t){this._text!==this.text&&(this.changedText=!0,this._text=this.text);if(this._text&&this.font){var i=this._text,e="",s=this.font.widthForString(i),n=this.font.heightForString(i);0<this.maxWidth&&s>this.maxWidth&&(i=this.font.multilineForWidth(i,this.maxWidth),s=this.font.widthForString(i),n=this.font.heightForString(i));0<this.maxHeight&&n>this.maxHeight&&(e=this.font.overflowForHeight(i,this.maxHeight),i=e.display,e=e.overflow,s=this.font.widthForString(i),n=this.font.heightForString(i));if(this.textDisplay!==i||this.textOverflow!==e)this.needsRebuild=this.changedText=!0,this.textDisplay=i,this.textOverflow=e;this.size.x!==s&&(this.size.x=s,t=this.needsRebuild=this.changedText=!0);this.size.y!==n&&(this.size.y=n,t=this.needsRebuild=this.changedText=!0)}return t},rebuild:function(){this.parent();this.textDisplay&&this.font&&(this.textImage.setDimensions(this.size.x,this.size.y),this.font.draw(this.textDisplay,this.textAlign===ig.Font.ALIGN.CENTER?.5*this.size.x:this.textAlign===ig.Font.ALIGN.RIGHT?this.size.x:0,0,this.textAlign,this.textImage.dataContext,1),this.textImage.finalize())},update:function(){this.autoRefreshText&&this._text!==this.text?this.refresh(!0):this.changedText=!1;this.parent()},draw:function(){this.parent();this.visible&&this.textImage&&(1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha),this.fixed?this.textImage.draw(this.posDraw.x,this.posDraw.y,void 0,void 0,void 0,void 0,this.scale):this.textImage.draw(this.posDraw.x-ig.game.screen.x,this.posDraw.y-ig.game.screen.y,void 0,void 0,void 0,void 0,this.scale),1!==this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;ig.module("plusplus.ui.ui-overlay").requires("plusplus.core.font","plusplus.core.config","plusplus.core.image-drawing","plusplus.ui.ui-element","plusplus.ui.ui-text","plusplus.helpers.utilsdraw","plusplus.helpers.utilscolor").defines(function(){var t=ig.CONFIG,i=ig.utilsdraw,e=ig.utilscolor;ig.UIOverlay=ig.global.UIOverlay=ig.UIElement.extend({layerName:"overlay",zIndex:t.Z_INDEX_BELOW_ALL,scaleMin:t.ENTITY.SCALE_MIN,scaleMax:t.ENTITY.SCALE_MAX,scaleOfSystemScale:t.ENTITY.SCALE_OF_SYSTEM_SCALE,ignoreSystemScale:!1,sizeAsPct:!0,sizePct:{x:1,y:1},fill:null,filled:!0,r:t.OVERLAY.R,g:t.OVERLAY.G,b:t.OVERLAY.B,alpha:t.OVERLAY.ALPHA,fillStyle:"",fillColors:null,gradientRadial:!1,gradientHorizontal:!1,cover:!1,cornerRadius:0,cornerRadiusAsPct:!1,pixelPerfect:t.OVERLAY.PIXEL_PERFECT,message:null,messageEntity:ig.UIText,textSettings:null,textMoveToSettings:{matchPerformance:!0},resetExtras:function(){this.fill=this.filled?new ig.ImageDrawing:null;"string"===typeof this.text&&(this.textSettings=this.textSettings||{},this.textSettings.text=this.text,this.text=void 0);"string"===typeof this.message&&(this.textSettings=this.textSettings||{},this.textSettings.text=this.message,this.message=void 0);!this.message&&(this.textSettings&&this.textSettings.text&&0<this.textSettings.text.length)&&(this.message=new this.messageEntity(0,0,ig.merge({layerName:this.layerName,fixed:this.fixed,alpha:this.alpha,linkedTo:this,autoRefreshText:!1},this.textSettings)));this.parent()},resize:function(t){if(this.sizeAsPct){var i=ig.system.width*this.sizePct.x,e=ig.system.height*this.sizePct.y;this.size.x!==i&&(this.size.x=i,t=this.needsRebuild=!0);this.size.y!==e&&(this.size.y=e,t=this.needsRebuild=!0)}return t},rebuild:function(){this.refill();this.fill&&this.fill.finalize(this.pixelPerfect?1:this.scale);this.parent()},refill:function(t,e){if(this.fill){"undefined"===typeof t&&(t=this.sizeDraw.x);"undefined"===typeof e&&(e=this.sizeDraw.y);var s=this.fill.dataContext;this.pixelPerfect?(this.fill.setDimensions(this.sizeDraw.x,this.sizeDraw.y),0<this.cornerRadius?i.pixelFillRoundedRect(s,0,0,this.fill.width,this.fill.height,0,0,t,e,this.cornerRadiusAsPct?Math.min(t,e)*this.cornerRadius:this.cornerRadius,this.r,this.g,this.b,1):(s.fillStyle=this.getFillStyle(),s.fillRect(0,0,t,e))):(this.fill.setDimensions(this.sizeDraw.x*this.scale,this.sizeDraw.y*this.scale),s.fillStyle=this.getFillStyle(),t*=this.scale,e*=this.scale,0<this.cornerRadius?i.fillRoundedRect(s,0,0,t,e,this.cornerRadiusAsPct?Math.min(t,e)*this.cornerRadius:this.cornerRadius):s.fillRect(0,0,t,e))}},getFillStyle:function(){var t;this.pixelPerfect||(this.fillStyle?t=this.fillStyle:this.fillColors&&(t=this.gradientRadial?e.radialGradient(this.cover?Math.max(this.sizeDraw.x,this.sizeDraw.y):Math.min(this.sizeDraw.x,this.sizeDraw.y),this.fillColors):this.gradientHorizontal?e.linearGradient(0,0,this.sizeDraw.x,0,this.fillColors):e.linearGradient(0,0,0,this.sizeDraw.y,this.fillColors)));t||(t=e.RGBToCSS(this.r,this.g,this.b));return t},ready:function(){this.message&&ig.game.spawnEntity(this.message,this.message.pos.x,this.message.pos.y);this.parent()},moveTo:function(t,i){var e=this.parent(t,i);this.message&&this.message.moveTo(this,this.textMoveToSettings);return e},moveToStop:function(){this.message&&this.message.moveToStop();this.parent()},pause:function(){this.parent();this.message&&this.message.pause()},unpause:function(){this.parent();this.message&&this.message.unpause()},cleanup:function(){this.message&&ig.game.removeEntity(this.message);this.parent()},update:function(){if(this.message){var t=this.textSettings&&this.textSettings.text||this.text;t&&this.message.text!==t&&(this.message.text=t);this.message._text!==this.message.text&&this.refresh(!0)}this.parent()},draw:function(){this.message&&(this.message.alpha=this.alpha);this.visible&&(this.fill&&(1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha),this.fixed?this.fill.draw(this.posDraw.x,this.posDraw.y,void 0,void 0,void 0,void 0,this.scale):this.fill.draw(this.posDraw.x-ig.game.screen.x,this.posDraw.y-ig.game.screen.y,void 0,void 0,void 0,void 0,this.scale),1!==this.alpha&&(ig.system.context.globalAlpha=1)),this.parent())}})});ig.baked=!0;ig.module("plusplus.core.camera").requires("plusplus.core.config","plusplus.core.timer","plusplus.core.image-drawing","plusplus.ui.ui-overlay","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsvector2","plusplus.helpers.utilsintersection","plusplus.helpers.signals","plusplus.helpers.tweens").defines(function(){var t=ig.CONFIG,i=ig.utils,e=ig.utilsmath,s=ig.utilsvector2,n=ig.utilsintersection,a=ig.TWEEN;ig.Camera=ig.Class.extend({boundsTrapAsPct:t.CAMERA.BOUNDS_TRAP_AS_PCT,boundsTrap:n.boundsMinMax(t.CAMERA.BOUNDS_TRAP_MINX,t.CAMERA.BOUNDS_TRAP_MINY,t.CAMERA.BOUNDS_TRAP_MAXX,t.CAMERA.BOUNDS_TRAP_MAXY),boundsTrapPct:n.boundsMinMax(t.CAMERA.BOUNDS_TRAP_PCT_MINX,t.CAMERA.BOUNDS_TRAP_PCT_MINY,t.CAMERA.BOUNDS_TRAP_PCT_MAXX,t.CAMERA.BOUNDS_TRAP_PCT_MAXY),keepCentered:t.CAMERA.KEEP_CENTERED,keepInsideLevel:{x:t.CAMERA.KEEP_INSIDE_LEVEL,y:t.CAMERA.KEEP_INSIDE_LEVEL},boundsLevel:n.boundsMinMax(0,0,0,0),paused:!1,changed:!1,entity:null,entityFallback:null,autoFollowPlayer:t.CAMERA.AUTO_FOLLOW_PLAYER,snapFirstFollow:t.CAMERA.SNAP_FIRST_FOLLOW,centerFirstFollow:t.CAMERA.CENTER_FIRST_FOLLOW,lerp:t.CAMERA.LERP,transitionDuration:t.CAMERA.TRANSITION_DURATION,transitionDurationMin:t.CAMERA.TRANSITION_DURATION_MIN,transitionDurationMax:t.CAMERA.TRANSITION_DURATION_MAX,transitionDistance:t.CAMERA.TRANSITION_DISTANCE,transitioning:!1,transitioningInstantly:!1,transitioningCenter:!1,transitionPct:0,screenLast:{x:0,y:0},atmosphere:!1,atmosphereOverlay:null,atmosphereSettings:{r:0,g:0,b:0,alpha:.9},atmosphereFadeDuration:1e3,lightAmplification:3,lightBaseOnly:!0,lightsCutout:!0,onTransitioned:null,shaking:!1,shakeStrength:8,shakeDuration:2,shakeFunction:!1,shakeOffset:null,shakeTimer:null,_transitionTime:0,_transitionDuration:0,_transitionFrom:{x:0,y:0},_snap:!0,_center:!0,_entityInvulnerable:!1,_entityPaused:!1,_entityAlpha:1,_boundsScreen:n.boundsMinMax(0,0,0,0),_rLast:0,_gLast:0,_bLast:0,_alphaLast:0,init:function(t){ig.merge(this,t);this._snap=this.snapFirstFollow;this._center=this.centerFirstFollow;this.onTransitioned=new ig.Signal;this.shakeTimer=new ig.Timer;ig.system.onResized.add(this.resize,this,-1)},reset:function(){this.screenLast.x=ig.game.screen.x=0;this.screenLast.y=ig.game.screen.y=0;this.shakeStop();this.removeAtmosphere(0);this.unfollow();this.unfollowFallback();this.onTransitioned.removeAll();this.onTransitioned.forget();this._snap=this.snapFirstFollow;this._center=this.centerFirstFollow},ready:function(){this.getBoundsLevel();this.autoFollowPlayer&&this.followPlayer()},pause:function(){this.paused=!0;this.shakeTimer.pause()},unpause:function(){this.paused=!1;this.shakeTimer.unpause()},getBoundsLevel:function(t){t="undefined"!=typeof t?t:ig.game.collisionMap;if((this.keepInsideLevel.x||this.keepInsideLevel.y)&&t&&t.width&&t.height&&t.tilesize)this.boundsLevel=n.boundsMinMax(0,0,t.width*t.tilesize-ig.system.width,t.height*t.tilesize-ig.system.height,this.boundsLevel),0>this.boundsLevel.maxX&&(this.boundsLevel.minX=this.boundsLevel.maxX*=.5),0>this.boundsLevel.maxY&&(this.boundsLevel.minY=this.boundsLevel.maxY*=.5)},shake:function(t,i,e){this.shaking||(this.shaking=!0,this.shakeDuration=t||this.shakeDuration,this.shakeStrength=i||this.shakeStrength,this.shakeFunction=e||this.shakeFunction,this.shakeOffset?s.zero(this.shakeOffset):this.shakeOffset={x:0,y:0},this.shakeTimer.set(this.shakeDuration))},shakeStop:function(){this.shaking&&(this.shaking=!1,ig.game.screen.x-=this.shakeOffset.x,ig.game.screen.y-=this.shakeOffset.y)
},updateShake:function(){if(this.shaking){ig.game.screen.x-=this.shakeOffset.x;ig.game.screen.y-=this.shakeOffset.y;var t=this.shakeTimer.delta();if(0<=t)this.shakeStop();else{var t=-t/this.shakeDuration,i=this.shakeFunction?this.shakeFunction():this.shakeStrength*Math.pow(t,2);.5<i&&(this.shakeOffset.x+=e.map(Math.random(),0,1,-i,i),this.shakeOffset.y+=e.map(Math.random(),0,1,-i,i));s.multiplyScalar(this.shakeOffset,t)}}},toggleAtmosphere:function(t,i){this.atmosphere?this.removeAtmosphere(t):this.addAtmosphere(t,i)},addAtmosphere:function(t,e){if(!this.atmosphere||e)this.atmosphere&&this.removeAtmosphere(t),this.atmosphere=!0,this.atmosphereFadeDuration=i.isNumber(t)?t:this.atmosphereFadeDuration,this.atmosphereOverlay=ig.game.spawnEntity(ig.UIOverlay,0,0,e?ig.merge(ig.merge({},this.atmosphereSettings),e):this.atmosphereSettings),this.atmosphereOverlay.added?this._showAtmosphere():this.atmosphereOverlay.onAdded.addOnce(this._showAtmosphere,this)},_showAtmosphere:function(){this.atmosphereOverlay&&(this.atmosphereOverlay.alpha=0,this.atmosphereOverlay.fadeTo(this.atmosphereOverlay.resetState.alpha,{duration:this.atmosphereFadeDuration}),this.changed=!0,this.updateAtmosphere())},removeAtmosphere:function(t){this.atmosphere=!1;this.atmosphereOverlay&&(this.atmosphereOverlay.added?this.atmosphereOverlay.fadeToDeath({duration:i.isNumber(t)?t:this.atmosphereFadeDuration}):(this.atmosphereOverlay.onAdded.remove(this._showAtmosphere,this),ig.game.removeEntity(this.atmosphereOverlay)),this.atmosphereOverlay=void 0)},updateAtmosphere:function(){if(this.atmosphere&&(this.changed||this.lightsCutout&&(ig.game.dirtyLights||ig.game.changedLights))){this.atmosphereOverlay.refresh(!0);var t=this.atmosphereOverlay.fill.dataContext;if(this.lightsCutout){t.globalCompositeOperation="destination-out";var i=ig.game.lights,e,s;e=0;for(s=i.length;e<s;e++){var n=i[e];n.visible&&n.image&&(t.globalAlpha=Math.min(1,n.alpha*this.lightAmplification),t.drawImage(this.lightBaseOnly&&n.castsShadows?n.imageBase.data:n.image.data,ig.system.getDrawPos(n.posDraw.x-ig.game.screen.x),ig.system.getDrawPos(n.posDraw.y-ig.game.screen.y)))}t.globalCompositeOperation="source-over"}}},follow:function(t,i,e){i=i||this._snap;e=e||this._center;if(this.entity!==t||i||e)if(this._snap=this._center=!1,this.unfollow(),this.entity=t)this.transitioning=!0,this.transitioningInstantly=i,this.transitioningCenter=e,this._transitionTime=0,s.copy(this._transitionFrom,ig.game.screen),this.transitioningCenter?n.bounds(ig.game.screen.x,ig.game.screen.y,0,0,this._boundsScreen):n.boundsCopy(this._boundsScreen,this.boundsTrap,ig.game.screen.x,ig.game.screen.y);this.transitioning?this.transitioningInstantly&&this.updateFollow():this.entity&&this.transitionComplete()},followFallback:function(t,i,e){this.entityFallback!==t&&(this.entityFallback=t,this.entity||this.follow(this.entityFallback,i,e))},followRespawnable:function(t){this.followFallback(t);this.transitioning&&(t.invulnerable||(t.invulnerable=this._entityInvulnerable=!0),t.paused||(this._entityPaused=!0,t.pause(),this._entityAlpha=t.alpha,t.alpha=0))},followPlayer:function(t,i){var e=ig.game.getPlayer();e&&(this.unfollow(),this.followFallback(e,t,i),e.onRemoved.add(this.unfollowFallback,this),e.onAdded.add(this.followRespawnable,this))},unfollow:function(){this.entity&&(this.entity=void 0);this.transitioning&&(this.transitioning=!1,this._transitionTime=0,n.boundsCopy(this._boundsScreen,this.boundsTrap,ig.game.screen.x,ig.game.screen.y))},unfollowFallback:function(){this.entityFallback&&(this.entityFallback===this.entity&&this.unfollow(),this.entityFallback=void 0);this.transitioning&&(this.transitioning=!1,n.boundsCopy(this._boundsScreen,this.boundsTrap,ig.game.screen.x,ig.game.screen.y))},transitionComplete:function(){this.transitioning=this.transitioningInstantly=this.transitioningCenter=!1;this._entityInvulnerable&&this.entity.invulnerable&&(this.entity.invulnerable=this._entityInvulnerable=!1);this._entityPaused&&this.entity.paused&&(this._entityPaused=!1,this.entity.unpause(),this.entity.alpha=this._entityAlpha);this.onTransitioned.dispatch()},updateFollow:function(){var t=ig.game.screen;!this.entity&&this.entityFallback&&this.follow(this.entityFallback);if(this.entity){s.copy(this.screenLast,t);var i=this.entity.pos.x+.5*this.entity.size.x-.5*ig.system.width,o=this.entity.pos.y+.5*this.entity.size.y-.5*ig.system.height,h,r;if(this.transitioning){this.changed=!0;if(this.transitioningInstantly)this.transitionPct=1;else{if(0===this._transitionTime)if(0<this.transitionDistance){var l=i-this._boundsScreen.minX,g=o-this._boundsScreen.minY,l=Math.sqrt(l*l+g*g);this._transitionDuration=e.clamp(this.transitionDuration*(l/this.transitionDistance),this.transitionDurationMin,this.transitionDurationMax)}else this._transitionDuration=this.transitionDuration;this._transitionTime+=ig.system.tick;this.transitionPct=this._transitionTime/this._transitionDuration}l=a.Easing.Quadratic.InOut(this.transitionPct);i<this._boundsScreen.minX?t.x=this._transitionFrom.x+(i-(this._boundsScreen.minX+(this.transitioningCenter?.5*this._boundsScreen.width:0)))*l:i>this._boundsScreen.maxX?t.x=this._transitionFrom.x+(i-(this._boundsScreen.maxX-(this.transitioningCenter?.5*this._boundsScreen.width:0)))*l:h=!0;o<this._boundsScreen.minY?t.y=this._transitionFrom.y+(o-(this._boundsScreen.minY+(this.transitioningCenter?.5*this._boundsScreen.height:0)))*l:o>this._boundsScreen.maxY?t.y=this._transitionFrom.y+(o-(this._boundsScreen.maxY-(this.transitioningCenter?.5*this._boundsScreen.height:0)))*l:r=!0;(1<=this.transitionPct||h&&r)&&this.transitionComplete()}else if(this.keepCentered?(t.x+=(i-t.x)*this.lerp,t.y+=(o-t.y)*this.lerp):(i<this._boundsScreen.minX?t.x+=i-this._boundsScreen.minX:i>this._boundsScreen.maxX&&(t.x+=i-this._boundsScreen.maxX),o<this._boundsScreen.minY?t.y+=o-this._boundsScreen.minY:o>this._boundsScreen.maxY&&(t.y+=o-this._boundsScreen.maxY)),0!==t.x-this.screenLast.x||0!==t.y-this.screenLast.y)this.changed=!0}this.changed&&(this.screenLast.x=this.keepInsideLevel.x?t.x=e.clamp(t.x,this.boundsLevel.minX,this.boundsLevel.maxX):t.x,this.screenLast.y=this.keepInsideLevel.y?t.y=e.clamp(t.y,this.boundsLevel.minY,this.boundsLevel.maxY):t.y,this.transitioning||n.boundsCopy(this._boundsScreen,this.boundsTrap,t.x,t.y));this.shaking&&(t.x+=this.shakeOffset.x,t.y+=this.shakeOffset.y,this.changed=!0)},update:function(){this.changed=!1;this.paused||(this.updateShake(),this.updateFollow(),this.updateAtmosphere())},resize:function(){this.changed=!0;this.getBoundsLevel();this.boundsTrapAsPct&&n.boundsCopy(this.boundsTrap,this.boundsTrapPct,0,0,.5*ig.system.width,.5*ig.system.height);this.entity&&this.follow(this.entity,!0,!0);this.updateAtmosphere()}})});ig.baked=!0;ig.module("plusplus.ui.ui-dpad").requires("plusplus.ui.ui-element","plusplus.helpers.utilsvector2").defines(function(){var t=ig.CONFIG,i=ig.utilsvector2;ig.UIDpad=ig.global.UIDpad=ig.UIElement.extend({size:{x:t.PLAYER_MANAGER.TOUCH_DPAD_SIZE,y:t.PLAYER_MANAGER.TOUCH_DPAD_SIZE},zIndex:5,animSheet:new ig.AnimationSheet(t.PATH_TO_MEDIA+"dpad_"+t.PLAYER_MANAGER.TOUCH_DPAD_SIZE+".png",t.PLAYER_MANAGER.TOUCH_DPAD_SIZE,t.PLAYER_MANAGER.TOUCH_DPAD_SIZE),align:{x:.5,y:.5},posAsPct:!1,pos:{x:0,y:0},inputPoint:null,direction:null,deadZoneSize:t.PLAYER_MANAGER.TOUCH_DPAD_DEAD_ZONE_SIZE,animInit:"none",layerName:"overlay",animSettings:{none:{sequence:[0]},left:{sequence:[1]},right:{sequence:[2]},up:{sequence:[3]},down:{sequence:[4]},upleft:{sequence:[5]},upright:{sequence:[6]},downleft:{sequence:[7]},downright:{sequence:[8]}},setDirection:function(){this.direction=null==this.inputPoint?{x:0,y:0}:{x:this.inputPoint._downTotalDeltaX>this.deadZoneSize||this.inputPoint._downTotalDeltaX<-this.deadZoneSize?this.inputPoint._downTotalDeltaX:0,y:this.inputPoint._downTotalDeltaY>this.deadZoneSize||this.inputPoint._downTotalDeltaY<-this.deadZoneSize?this.inputPoint._downTotalDeltaY:0};this.directionName=i.directionToString(this.direction).toLowerCase();this.currentAnim=this.anims[this.directionName]},update:function(){this.parent();this.inputPoint&&!this.inputPoint.holding&&(ig.game.playerManager.touchDpad=null,this.kill())}})});ig.baked=!0;ig.module("plusplus.core.player-manager").requires("plusplus.core.config","plusplus.core.entity","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsintersection","plusplus.ui.ui-dpad").defines(function(){var t=ig.CONFIG,i=ig.utils,e=ig.utilsmath,s=ig.utilsintersection;ig.PlayerManager=ig.global.PlayerManager=ig.Class.extend({autoManagePlayer:t.PLAYER_MANAGER.AUTO_MANAGE_PLAYER,entity:null,entityFallback:null,zIndex:0,type:"",group:"",holdToMove:t.PLAYER_MANAGER.HOLD_TO_MOVE,swipeToJump:t.PLAYER_MANAGER.SWIPE_TO_JUMP,touchDpadEnabled:t.PLAYER_MANAGER.TOUCH_DPAD_ENABLED,touchDpadDeadZoneSize:t.PLAYER_MANAGER.TOUCH_DPAD_DEAD_ZONE_SIZE,touchDpadBoundsPctMinX:t.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MINX,touchDpadBoundsPctMinY:t.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MINY,touchDpadBoundsPctMaxX:t.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MAXX,touchDpadBoundsPctMaxY:t.PLAYER_MANAGER.TOUCH_DPAD_BOUNDS_PCT_MAXY,touchDpad:null,onManageStarted:null,onManageStopped:null,_zIndex:0,_type:ig.EntityExtended.TYPE.NONE,_group:ig.EntityExtended.GROUP.NONE,init:function(t){ig.merge(this,t);this.onManageStarted=new ig.Signal;this.onManageStopped=new ig.Signal},ready:function(){this.autoManagePlayer&&this.managePlayer()},reset:function(){this.onManageStarted.removeAll();this.onManageStarted.forget();this.onManageStopped.removeAll();this.onManageStopped.forget();this.manageReleaseFallback();this.manageRelease()},manage:function(t){this.entity!==t&&(this.manageRelease(),t instanceof ig.EntityExtended&&this.manageStart(t))},manageFallback:function(t){this.entityFallback!==t&&(this.entityFallback=t,this.entity||this.manage(t))},managePlayer:function(){var t=ig.game.getPlayer();t&&this.entity!==t&&(this.manageRelease(),this.manageFallback(t),t.onRemoved.add(this.manageReleaseFallback,this),t.onAdded.add(this.managePlayer,this))},manageStart:function(t){this.entity=t;this.entity.onRemoved.addOnce(this.manageRelease,this);this.zIndex&&t.zIndex!==this.zIndex&&(this._zIndex=t.zIndex,t.zIndex=this.zIndex,ig.game.sortEntitiesDeferred(t.layerName));this.type&&(this._type=t.type,i.addType(ig.EntityExtended,t,"type",this.type));this.group&&(this._group=t.group,i.addType(ig.EntityExtended,t,"group",this.group,"GROUP"));ig.game.camera&&ig.game.camera.autoFollowPlayer&&ig.game.camera.entity!==t?(t===ig.game.getPlayer()?ig.game.camera.followPlayer():ig.game.camera.follow(t),ig.game.camera.onTransitioned.addOnce(this.highlightManaged,this)):this.highlightManaged();"function"===typeof t.manageStart&&t.manageStart();this.onManageStarted.dispatch(t)},manageRelease:function(t){(!t&&this.entity||t&&this.entity===t)&&this.manageStop()},manageReleaseFallback:function(t){if(!t&&this.entityFallback||t&&this.entityFallback===t)this.entity===this.entityFallback&&this.manageRelease(),this.entityFallback=null},manageStop:function(){var t=this.entity;ig.game.camera&&ig.game.camera.onTransitioned.remove(this.highlightManaged,this);t.onRemoved.remove(this.manageRelease,this);this.zIndex&&t.zIndex!==this._zIndex&&(t.zIndex=this._zIndex,ig.game.sortEntitiesDeferred(t.layerName));this.type&&(t.type=this._type);this.group&&(t.group=this._group);this.entity=null;"function"===typeof t.manageStop&&t.manageStop();this.onManageStopped.dispatch(t)},highlightManaged:function(){this.entity&&(!this.entity._killed&&this.entity.currentAnim==this.entity.anims[this.entity.getDirectionalAnimName("idle")])&&this.entity.animOverride(this.entity.getDirectionalAnimName("highlight"))},update:function(){!this.entity&&this.entityFallback&&this.manage(this.entityFallback);this.isManagedControllable()&&this.handleInput()},isManagedControllable:function(){return this.entity&&!this.entity.paused&&this.entity.controllable},handleInput:function(){var t,i,n,a;this.entity.movingTo||(this.entity.jumping?this.entity.moveToHereHorizontal():this.entity.moveToHere());this.entity.handleInput&&this.entity.handleInput();ig.input.state("right")?this.entity.moveToRight():ig.input.state("left")&&this.entity.moveToLeft();ig.input.state("up")?this.entity.hasGravity?this.entity.climbUp():this.entity.moveToUp():ig.input.state("down")&&(this.entity.hasGravity?this.entity.climbDown():this.entity.moveToDown());if(this.holdToMove&&ig.input.state("hold")){n=ig.input.getInputPoints(["holding"],[!0]);t=0;for(i=n.length;t<i;t++)if(a=n[t],!a.targetsDownStart.length){var o=.5*this.entity.size.x,h=.5*this.entity.size.y,r=a.worldX-this.entity.pos.x+o,l=a.worldY-this.entity.pos.y+h;!0!==e.almostEqual(r,0,o)&&(0<r?this.entity.moveToRight():this.entity.moveToLeft());!0!==e.almostEqual(l,0,h)&&(0<l?this.entity.hasGravity?this.entity.climbDown():this.entity.moveToDown():this.entity.hasGravity?this.entity.climbUp():this.entity.moveToUp())}}if(!this.holdToMove&&this.touchDpadEnabled&&ig.input.state("hold")){n=ig.input.getInputPoints(["holding"],[!0]);t=0;for(i=n.length;t<i;t++)if(a=n[t],!a.targetsDownStart.length&&s.pointInAABB(a.x,a.y,ig.system.width*this.touchDpadBoundsPctMinX,ig.system.height*this.touchDpadBoundsPctMinY,ig.system.width*this.touchDpadBoundsPctMaxX,ig.system.height*this.touchDpadBoundsPctMaxY)&&!this.touchDpad&&(0!=a._downTotalDeltaX||0!=a._downTotalDeltaY))this.touchDpad=ig.game.spawnEntity(ig.global.UIDpad,0,0,{pos:{x:a.x,y:a.y}}),this.touchDpad.inputPoint=a;this.touchDpad&&this.touchDpad.inputPoint&&this.touchDpad.inputPoint.holding&&(this.touchDpad.setDirection(),a._downTotalDeltaX>this.touchDpadDeadZoneSize?this.entity.moveToRight():a._downTotalDeltaX<-this.touchDpadDeadZoneSize&&this.entity.moveToLeft(),a._downTotalDeltaY>this.touchDpadDeadZoneSize?this.entity.hasGravity?this.entity.climbDown():this.entity.moveToDown():a._downTotalDeltaY<-this.touchDpadDeadZoneSize&&(this.entity.hasGravity?this.entity.climbUp():this.entity.moveToUp()))}if(ig.input.pressed("jump"))this.entity.jump();else if(this.swipeToJump&&ig.input.state("swipe")){n=ig.input.getInputPoints(["swiping"],[!0]);t=0;for(i=n.length;t<i;t++)n[t].swipingUp&&this.entity.jump()}}})});ig.baked=!0;ig.module("plusplus.entities.trigger").requires("plusplus.core.timer","plusplus.core.entity","plusplus.helpers.utils","plusplus.helpers.signals").defines(function(){var t=ig.utils;ig.EntityTrigger=ig.global.EntityTrigger=ig.EntityExtended.extend({_wmScalable:!0,_wmDrawBox:!0,_wmBoxColor:"rgba( 255, 255, 0, 0.7 )",frozen:!0,target:{},sortTargetsBy:null,targetSequence:[],wait:0,delay:0,triggerAfterDelay:!1,once:!0,suicidal:!0,triggerable:!0,useCheckingAsTarget:!1,triggering:!1,autoComplete:!0,autoToggle:!1,teardownWhenComplete:!0,waitTimer:null,delayTimer:null,onCompleted:null,_delaying:!1,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","TRIGGER");t.addType(ig.EntityExtended,this,"checkAgainst","PLAYER")},initProperties:function(){this.parent();this.waitTimer=new ig.Timer;this.delayTimer=new ig.Timer;this.onCompleted=new ig.Signal},resetExtras:function(){var t=this.activated;this.activated=!1;this.parent();t&&this.trigger()},check:function(t){this.parent(t);this.triggerable&&this.trigger(t,!0,!0)},trigger:function(i,e,s){if(this.getCanTrigger(i)){if(0<this.delay&&!this._delaying){this._delaying=!0;var n=this.delayTimer.pausedAt;this.delayTimer.set(this.delay);this.delayTimer.pausedAt=n}if(0<=this.delayTimer.delta()){this._delaying=!1;this.triggering=!0;this.targetSequence.length=0;for(var a in this.target)(n=ig.game.namedEntities[this.target[a]])&&!n.triggering&&this.targetSequence.push(n);s&&this.useCheckingAsTarget&&t.arrayCautiousAdd(this.targetSequence,i);this.sortTargetsBy&&this.targetSequence.sort(this.sortTargetsBy);this.handleTargets(i,e);this.wait&&this.waitTimer.set(this.wait);this.triggering=!1;this.autoComplete&&this.complete()}}},getCanTrigger:function(){return!this.triggering&&(!this.once||!this.activated)&&(!this.wait||0<=this.waitTimer.delta())},handleTargets:function(t,i){!1!==i&&this.activate(t);for(var e=0,s=this.targetSequence.length;e<s;e++){var n=this.targetSequence[e];n instanceof ig.EntityTrigger?n.trigger(t):n.activate&&n.activate(t)}},activate:function(t){this.needsTeardown||this.setup();this.triggering||this.trigger(t,!1);this.parent(t)},deactivate:function(t){this.needsTeardown&&this.teardown();this.parent(t)},complete:function(){this.onCompleted.dispatch();this.targetSequence.length=0;this.suicidal?this.kill(!0):!this.checking&&this.autoToggle&&this.activated?this.deactivate():this.teardownWhenComplete&&this.needsTeardown&&this.teardown()},setup:function(){this.needsTeardown=!0},teardown:function(){this.needsTeardown=!1},pause:function(){this.parent();this.delayTimer.pause();this.waitTimer.pause()},unpause:function(){this.parent();this.delayTimer.unpause();this.waitTimer.unpause()},kill:function(t){this.triggerable=!1;this.parent(t)},cleanup:function(){ig.game.hasLevel||(this.onCompleted.removeAll(),this.onCompleted.forget());this.needsTeardown&&this.teardown();this.parent()},update:function(){!this.checking&&this.wasChecking!==this.checking&&(this.triggerAfterDelay||(this._delaying=!1),this.autoToggle&&this.activated&&this.deactivate());this._delaying&&(this.triggerAfterDelay&&0<=this.delayTimer.delta())&&this.trigger(this);this.parent()}});ig.global.wm&&(delete ig.EntityExtended.prototype.staticInstantiate,ig.EntityTrigger.inject({trigger:function(){}}))});ig.baked=!0;ig.module("plusplus.abstractities.spawner").requires("plusplus.core.timer","plusplus.entities.trigger","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.signals").defines(function(){var t=ig.utils,i=ig.utilsmath;ig.Spawner=ig.EntityTrigger.extend({_wmBoxColor:"rgba( 0, 100, 255, 0.7)",triggerable:!1,autoComplete:!1,triggerAfterDelay:!0,spawningEntity:"",spawnSettings:null,spawnCountMax:1,spawnCount:0,spawnedCount:0,spawning:!1,pool:[],entities:[],duration:0,durationTimer:null,respawnDelay:0,respawnTimer:null,spawnDelay:-1,spawnAt:!1,spawnTarget:{},spawnTargetSequence:[],spawnAtRandomPosition:!0,spawnAtSide:null,spawnAtRandomTarget:!1,spawnAtFirstTarget:!1,spawnAndMoveTo:!1,spawnAndMoveToSettings:null,spawnedDieWith:!1,unspawnSilently:!0,spawnTimer:null,onSpawned:null,onSpawnedAll:null,onUnspawned:null,onUnspawnedAll:null,_spawnedAtTargetIndex:0,_spawningComplete:!1,_reactivate:!1,initProperties:function(){this.parent();this.durationTimer=new ig.Timer;this.respawnTimer=new ig.Timer;this.spawnTimer=new ig.Timer;this.onSpawned=new ig.Signal;this.onSpawnedAll=new ig.Signal;this.onUnspawned=new ig.Signal;this.onUnspawnedAll=new ig.Signal},resetExtras:function(){this.spawnAt=this.spawnAt||this;-1===this.duration&&(this.suicidal=!1);this.parent()},activate:function(t){this.parent(t);if(!this.spawning&&this.spawnedCount<this.spawnCountMax&&(this.spawningEntity||0<this.pool.length)){this._spawningComplete=!1;this.spawning=!0;this.spawnedCount=this.spawnCount;0>this.spawnDelay&&(this.spawnDelay=0<this.duration?this.duration/this.spawnCountMax:0);this.spawnTargetSequence.length=0;for(var i in this.spawnTarget)(t=ig.game.namedEntities[this.spawnTarget[i]])&&this.spawnTargetSequence.push(t);if(0===this.duration||0===this.spawnDelay){for(i=!0;this.spawnedCount<this.spawnCountMax&&i;)i=this.spawnNext();this.complete()}else this.durationTimer.set(this.duration),this.spawnTimer.set(0)}},deactivate:function(t,i){this.spawning=this._spawningComplete=this._reactivate=!1;this.spawnedCount=this.spawnTargetSequence.length=this._spawnedAtTargetIndex=0;this.parent(t);for(var e=this.entities.length-1;0<=e;e--)this.unspawn(this.entities[e],i)},spawnNext:function(i){0<this.spawnTargetSequence.length?this.spawnAtRandomTarget?this.spawnAt=this.spawnTargetSequence[Math.round(Math.random()*(this.spawnTargetSequence.length-1))]:this.spawnAtFirstTarget?this.spawnAt=this.spawnTargetSequence[0]:(this.spawnAt=this.spawnTargetSequence[this._spawnedAtTargetIndex],this._spawnedAtTargetIndex=(this._spawnedAtTargetIndex+1)%this.spawnTargetSequence.length):this.spawnAt=this;if(i){if(!i.added||i._killed)i=ig.game.spawnEntity(i,0,0,this.spawnSettings);t.arrayCautiousRemove(this.pool,i);t.arrayCautiousAdd(this.entities,i)}else if(0<this.pool.length){if(i=this.pool.pop())i=ig.game.spawnEntity(i,0,0,this.spawnSettings),this.entities.push(i)}else this.spawningEntity&&this.spawnedCount<this.spawnCountMax&&(i=ig.game.spawnEntity(this.spawningEntity,0,0,this.spawnSettings),this.entities.push(i));i&&(this.spawnCount=Math.min(this.spawnCountMax,this.spawnCount+1),this.spawnedCount=Math.min(this.spawnCountMax,this.spawnedCount+1),this.spawned(i),this.onSpawned.dispatch(i),this.spawnedCount===this.spawnCountMax&&this.onSpawnedAll.dispatch(this));return i},unspawn:function(i,e){if(i._killed){if(i.spawner&&i.spawner.unlinkSpawned(i),this.spawnCount=Math.max(0,this.spawnCount-1),!this._killed&&(t.arrayCautiousRemove(this.entities,i),t.arrayCautiousAdd(this.pool,i),this.onUnspawned.dispatch(i),0===this.spawnCount&&this.onUnspawnedAll.dispatch(this),this.activated&&-1===this.duration&&!this.spawning&&(0<this.spawnDelay||0===this.spawnCount)))this.spawnedCount=this.spawnCount,this.respawnTimer.set(this.respawnDelay),this._reactivate=!0}else i.kill("boolean"===typeof e?e:this.unspawnSilently)},spawned:function(t){this.linkSpawned(t);var e=t.size.x,s=t.size.y,n=.5*e,a=.5*s,o=this.spawnAt.size.x,h=this.spawnAt.size.y,r=this.spawnAt.pos.x,l=this.spawnAt.pos.y,g=r+o,u=l+h;this.spawnAtRandomPosition?(t.pos.x=i.map(Math.random(),0,1,r+n,g-n),t.pos.y=i.map(Math.random(),0,1,l+a,u-a)):(t.pos.x=r+.5*o,t.pos.y=l+.5*h);t.pos.x-=n;t.pos.y-=a;this.spawnAtSide&&(0<this.spawnAtSide.x?t.pos.x=g-e-.5*o*(1-this.spawnAtSide.x):0>this.spawnAtSide.x&&(t.pos.x=r+.5*o*(1+this.spawnAtSide.x)),0<this.spawnAtSide.y?t.pos.y=u-s-.5*h*(1-this.spawnAtSide.y):0>this.spawnAtSide.y&&(t.pos.y=l+.5*h*(1+this.spawnAtSide.y)));this.spawnAndMoveTo&&0<this.spawnTargetSequence.length&&t.moveTo(this.spawnTargetSequence,this.spawnAndMoveToSettings)},linkSpawned:function(t){t.spawner&&t.spawner.unlinkSpawned(t);t.onRemoved.add(this.unspawn,this);t.spawner=this},unlinkSpawned:function(t){t.onRemoved.remove(this.unspawn,this);t.spawner=void 0},complete:function(){this._spawningComplete=!0;this.spawning=!1;this.parent()},pause:function(){this.parent();this.respawnTimer.pause();this.spawnTimer.pause();this.durationTimer.pause()},unpause:function(){this.parent();this.respawnTimer.unpause();this.spawnTimer.unpause();this.durationTimer.unpause()},cleanup:function(){ig.game.hasLevel||(this.onSpawned.removeAll(),this.onSpawned.forget(),this.onSpawnedAll.removeAll(),this.onSpawnedAll.forget(),this.onUnspawned.removeAll(),this.onUnspawned.forget(),this.onUnspawnedAll.removeAll(),this.onUnspawnedAll.forget());if(this.spawnedDieWith)for(var t=this.entities.length-1;0<=t;t--)this.unspawn(this.entities[t]);if(this.entities.length){for(t=this.entities.length-1;0<=t;t--)this.unlinkSpawned(this.entities[t]);this.entities.length=0}if(this.pool.length){for(t=this.pool.length-1;0<=t;t--)this.unlinkSpawned(this.pool[t]);this.pool.length=0}this.spawning=this._spawningComplete=this._reactivate=!1;this.spawnCount=this.spawnedCount=this.spawnTargetSequence.length=this._spawnedAtTargetIndex=0;this.parent()},update:function(){this.parent();if(this.spawning&&!this._spawningComplete&&0<=this.spawnTimer.delta()){this.spawnTimer.set(this.spawnDelay);var t=this.spawnNext();(this.spawnedCount>=this.spawnCountMax||!t)&&this.complete()}else!0===this._reactivate&&0<=this.respawnTimer.delta()&&(this._reactivate=!1,this.activate())}})});ig.baked=!0;ig.module("plusplus.abstractities.shape").requires("plusplus.core.entity","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.Shape=ig.EntityExtended.extend({_wmScalable:!0,_wmDrawBox:!0,_wmBoxColor:"rgba( 0, 255, 255, 0.7)",frozen:!0,opaqueFromVertices:!0,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","SHAPE")}})});ig.baked=!0;ig.module("plusplus.entities.shape-solid").requires("plusplus.abstractities.shape").defines(function(){ig.EntityShapeSolid=ig.global.EntityShapeSolid=ig.Shape.extend({opaque:!0,diffuse:1,hollow:!0})});ig.baked=!0;ig.module("plusplus.entities.shape-climbable").requires("plusplus.abstractities.shape").defines(function(){ig.EntityShapeClimbable=ig.global.EntityShapeClimbable=ig.Shape.extend({climbable:!0})});ig.baked=!0;ig.module("plusplus.entities.shape-climbable-one-way").requires("plusplus.entities.shape-climbable").defines(function(){ig.EntityShapeClimbableOneWay=ig.global.EntityShapeClimbableOneWay=ig.EntityShapeClimbable.extend({collides:ig.EntityExtended.COLLIDES.FIXED,oneWay:!0,oneWayFacing:{x:0,y:-1}})});ig.baked=!0;ig.module("plusplus.ui.ui-overlay-pause").requires("plusplus.ui.ui-overlay").defines(function(){ig.UIOverlayPause=ig.global.UIOverlayPause=ig.UIOverlay.extend({layerName:"ui",textSettings:{text:"PAUSED"}})});ig.baked=!0;ig.module("plusplus.helpers.pathfinding").requires("plusplus.core.config","plusplus.core.collision-map","plusplus.core.pathfinding-map","plusplus.helpers.utilsmath","plusplus.helpers.utilstile","plusplus.helpers.utilsintersection").defines(function(){function t(){var t,i;t=0;for(i=b.length;t<i;t++)b[t].cleanup();t=0;for(i=R.length;t<i;t++)R[t].cleanup();b.length=R.length=0}var i=ig.CONFIG,e=ig.utilsmath,s=ig.utilstile,n=ig.utilsintersection,a=i.COLLISION.TILE_ONE_WAY_UP,o=i.COLLISION.TILE_ONE_WAY_DOWN,h=i.COLLISION.TILE_ONE_WAY_RIGHT,r=i.COLLISION.TILE_ONE_WAY_LEFT,l=i.COLLISION.TILE_CLIMBABLE_WITH_TOP,g=i.COLLISION.TILE_CLIMBABLE_STAIRS_WITH_TOP,u=i.COLLISION.TILES_HASH_WALKABLE,c=i.COLLISION.TILES_HASH_SLOPED,d=i.COLLISION.TILES_HASH_CLIMBABLE,p=i.COLLISION.TILES_HASH_ONE_WAY,m=i.PATHFINDING.WEIGHTED,y=i.PATHFINDING.WEIGHT,f=i.PATHFINDING.WEIGHT_AWAY_FROM,E=i.PATHFINDING.ALLOW_DIAGONAL,T=i.PATHFINDING.DIAGONAL_REQUIRES_BOTH_DIRECT,A=i.PATHFINDING.AWAY_FROM_MAX_NODES,v=i.PATHFINDING.STRICT_SLOPE_CHECK;ig.pathfinding={};var x=null,_=null,I=null,C=null,S=ig.pathfinding.tilesize=1,O=1,w={from:{x:.1,y:.1},target:{x:.1,y:.1}},N=[],b=[],R=[],L=ig.pathfinding.HEURISTIC={MANHATTAN:function(t,i){return t+i},EUCLIDEAN:function(t,i){return Math.sqrt(t*t+i*i)},CHEBYSHEV:function(t,i){return Math.max(t,i)}};ig.PathNode=ig.Class.extend({x:0,y:0,gridX:0,gridY:0,size:0,walkable:!0,ungrounded:!0,insideLevel:!0,tile:0,sloped:!1,slopeNormal:{x:0,y:0},slopedAlong:!1,slopesAlongMap:{},slopedNeighbor:!1,slopedNeighborMap:{},climbable:!1,oneWay:!1,oneWayFacing:{x:0,y:0},weightPct:1,weight:0,neighbors:null,directNeighbors:null,neighborMap:{},corner:!1,cornerMap:{},closed:!1,opened:!1,openIndex:0,prevNode:null,g:0,w:0,h:0,f:0,init:function(t,i,e,u,m,y){this.x=t||0;this.y=i||0;this.gridX=e||0;this.gridY=u||0;this.walkable="undefined"!==typeof m?m:!0;this.tile=y||0;this.climbable=!!d[this.tile];this.oneWay=!!p[this.tile];if(this.sloped=!!c[this.tile])if(m=s.defaultTileSegmentsDef[this.tile]){e=0;for(u=m.length;e<u;e++)if(y=m[e].normal,y.x&&y.y){this.slopeNormal=y;break}}this.oneWay&&(this.tile===a||this.tile===l||this.tile===g?this.oneWayFacing.y=-1:this.tile===o&&(this.oneWayFacing.y=1),this.tile===r?this.oneWayFacing.x=-1:this.tile===h&&(this.oneWayFacing.x=1));if(this.walkable){if(ig.game.shapesLevel.length){this.insideLevel=!1;e=0;for(u=ig.game.shapesLevel.length;e<u;e++)if(m=ig.game.shapesLevel[e],n.pointInAABB(t,i,m.x,m.y,m.x+m.size.x,m.y+m.size.y)&&n.pointInPolygon(t-(m.x+.5*m.size.x),i-(m.y+.5*m.size.y),m.vertices)){this.insideLevel=!0;break}}}else this.insideLevel=!1},cleanup:function(){this.g=this.h=this.f=this.w=this.openIndex=0;this.prevNode=null;this.closed=this.opened=!1}});ig.pathfinding.rebuild=function(t,i){ig.pathfinding.unload();x=t;I=i;if(x&&I&&I.tilesize!==x.tilesize)throw Error("Maps tilesize mismatch: pathfinding map and collision map must have the same tilesize!");x&&(_=x.data,S=ig.pathfinding.tilesize=x.tilesize,O=1/x.tilesize);I&&(C=I.data,S=ig.pathfinding.tilesize=I.tilesize,O=1/I.tilesize);ig.pathfinding.rebuildGrid()};ig.pathfinding.unload=function(){N.length=0;x=_=I=C=null;S=ig.pathfinding.tilesize=0};ig.pathfinding.rebuildGrid=function(){var t,i,e,s,n,a,o,h,r;if(x&&_){n=0;for(a=_.length;n<a;n++){t=_[n];(e=N[n])||(e=N[n]=[]);o=0;for(h=t.length;o<h;o++)i=t[o],s=o*S+.5*S,r=n*S+.5*S,e[o]=new ig.PathNode(s,r,o,n,!!u[i],i)}}if(I&&C){n=0;for(a=C.length;n<a;n++){t=C[n];(e=N[n])||(e=N[n]=[]);o=0;for(h=!x||!_[0]||t.length>=_[0].length?t.length:_[0].length;o<h;o++){i=t[o]||0;var l=I.tiledef[i];s=e[o];s||(s=o*S+.5*S,r=n*S+.5*S,s=e[o]=new ig.PathNode(s,r,o,n,l&&"undefined"!==typeof l.walkable?l.walkable:!0,i));ig.merge(s,l)}}}n=0;for(a=N.length;n<a;n++){t=N[n];o=0;for(h=t.length;o<h;o++){s=t[o];s.size=S;i=s.neighborMap;e=N[n-1];l=N[n+1];e&&(i.top=e[o],0<o&&(i.topleft=e[o-1]),o<h-1&&(i.topright=e[o+1]));0<o&&(i.left=t[o-1]);o<h-1&&(i.right=t[o+1]);l&&(i.bottom=l[o],0<o&&(i.bottomleft=l[o-1]),o<h-1&&(i.bottomright=l[o+1]));s.ungrounded=!i.bottom||i.bottom.walkable&&0<=i.bottom.oneWayFacing.y;if(i.top&&i.top.walkable&&(i.top.climbable||0>=i.top.oneWayFacing.y)&&i.left&&i.left.walkable&&(i.left.climbable||0>=i.left.oneWayFacing.x)&&(!i.topleft||!i.topleft.walkable&&!i.topleft.sloped))s.corner=s.cornerMap.topleft=!0;if(i.top&&i.top.walkable&&(i.top.climbable||0>=i.top.oneWayFacing.y)&&i.right&&i.right.walkable&&(i.right.climbable||0<=i.right.oneWayFacing.x)&&(!i.topright||!i.topright.walkable&&!i.topright.sloped))s.corner=s.cornerMap.topright=!0;if(i.bottom&&i.bottom.walkable&&(i.bottom.climbable||0<=i.bottom.oneWayFacing.y)&&i.left&&i.left.walkable&&(i.left.climbable||0>=i.left.oneWayFacing.x)&&(!i.bottomleft||!i.bottomleft.walkable&&!i.bottomleft.sloped))s.corner=s.cornerMap.bottomleft=!0;if(i.bottom&&i.bottom.walkable&&(i.bottom.climbable||0<=i.bottom.oneWayFacing.y)&&i.right&&i.right.walkable&&(i.right.climbable||0<=i.right.oneWayFacing.x)&&(!i.bottomright||!i.bottomright.walkable&&!i.bottomright.sloped))s.corner=s.cornerMap.bottomright=!0;i.top&&i.top.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.top=!0);i.bottom&&i.bottom.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.bottom=!0);i.right&&i.right.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.right=!0);i.left&&i.left.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.left=!0);i.topleft&&i.topleft.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.topleft=!0);i.topright&&i.topright.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.topright=!0);i.bottomleft&&i.bottomleft.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.bottomleft=!0);i.bottomright&&i.bottomright.sloped&&(s.slopedNeighbor=s.slopedNeighborMap.bottomright=!0);s.slopesAlongMap.top=!1;s.slopesAlongMap.bottom=s.walkable&&!s.oneWay&&i.bottom&&i.bottom.sloped;ig.pathfinding.getIsAlongSlope(s,-1,0)&&(s.slopesAlongMap.left=s.slopedAlong=!0);ig.pathfinding.getIsAlongSlope(s,1,0)&&(s.slopesAlongMap.right=s.slopedAlong=!0);ig.pathfinding.getIsAlongSlope(s,-1,-1)&&(s.slopesAlongMap.topleft=s.slopedAlong=!0);ig.pathfinding.getIsAlongSlope(s,1,-1)&&(s.slopesAlongMap.topright=s.slopedAlong=!0);ig.pathfinding.getIsAlongSlope(s,-1,1)&&(s.slopesAlongMap.bottomleft=s.slopedAlong=!0);ig.pathfinding.getIsAlongSlope(s,1,1)&&(s.slopesAlongMap.bottomright=s.slopedAlong=!0);s.directNeighbors=ig.pathfinding.getDirectNeighbors(s);s.neighbors=[].concat(s.directNeighbors,ig.pathfinding.getDiagonalNeighbors(s))}}};ig.pathfinding.getPathToEntity=function(t,i,e,s,n){var a=ig.pathfinding.getPositionPathfindingEntities(t,i,w);return ig.pathfinding.getPathTo(a.from.x,a.from.y,a.target.x,a.target.y,e,s,t,i,n)};ig.pathfinding.getPathToPoint=function(t,i,e,s,n,a,o){var h=ig.pathfinding.getPositionPathfindingPoint(t,i,e,w.from);return ig.pathfinding.getPathTo(h.x,h.y,i,e,s,n,t,a,o)};ig.pathfinding.getPathTo=function(i,e,s,n,a,o,h,r,l){var g;h&&h.path?(g=h.path,g.length=0):g=[];if(0===N.length)return g;i=Math.floor(i*O);e=Math.floor(e*O);s=Math.floor(s*O);n=Math.floor(n*O);var u=N[e]&&N[e][i];i=N[n]&&N[n][s];if(!u||!i||u===i)return g;e=b;var c=R;l=L[l||"MANHATTAN"];var d=Math.abs,p=Math.SQRT2,f,A,v,x,_,I,C=S,w=C,D,P,M,F,k,G,Y,z,B,H;
h&&(w=Math.max(h.size.x,h.size.y),P=E&&T,a&&(D=!0,M=ig.pathfinding.nodeHasCollidingEntities));r&&0<o?(a=!0,o*=O,o*=o):a=!1;for(e.push(u);0<e.length;){var U=e.pop(),W=U.gridX,X=U.gridY;c.push(U);U.closed=!0;if(U===i){for(;U;)g.push(U),U=U.prevNode;t();return g}u=U.neighbors;x=u.length;P&&(w>C&&8>x&&!U.slopedNeighbor?(u=U.directNeighbors,x=u.length,H=-1,k=!1):(F=U.neighborMap,G=Y=z=B=k=!1,H=.5*x|1));for(v=0;v<x;v++)if(f=u[v],!f.closed){A=f.gridX;_=f.gridY;if(f!==i){if(a){I=A-s;var V=_-n;if(I*I+V*V>o)continue}if(D)if(k&&(G&&f===F.topleft||Y&&f===F.topright||z&&f===F.bottomleft||B&&f===F.bottomright))continue;else if(M(f,U,h,r)){P&&v<H&&(f===F.top&&(k=G=Y=!0),f===F.bottom&&(k=z=B=!0),f===F.left&&(k=G=z=!0),f===F.right&&(k=Y=B=!0));continue}}V=0===A-W||0===_-X?1:p;I=U.g+V;V=m?U.w+V+f.weight+y*f.weightPct:I;if(!f.opened||V<f.w){f.g=I;f.w=V;f.h=f.h||l(d(A-s),d(_-n));f.f=f.w+f.h;f.prevNode=U;if(f.opened){var q;_=f.openIndex;for(I=e.length-1;_<I;_++)if(A=e[_+1],A.f<=f.f){q=!0;break}else A.openIndex=_,e[_]=A;q||(_=e.length)}else{f.opened=!0;for(_=e.length;0<_&&!(A=e[_-1],f.f<=A.f);_--)A.openIndex=_,e[_]=A}f.openIndex=_;e[_]=f}}}t();return g};ig.pathfinding.getPathAwayFromEntity=function(t,i,e,s,n){return ig.pathfinding.getPathAwayFrom(t.pos.x+.5*t.size.x,t.pos.y+.5*t.size.y,i.pos.x+.5*i.size.x,i.pos.y+.5*i.size.y,e,s,t,n)};ig.pathfinding.getPathAwayFromPoint=function(t,i,e,s,n,a){return ig.pathfinding.getPathAwayFrom(t.pos.x+.5*t.size.x,t.pos.y+.5*t.size.y,i,e,s,n,t,a)};ig.pathfinding.getPathAwayFrom=function(i,e,s,n,a,o,h,r){h&&h.path?(o=h.path,o.length=0):o=[];if(0===N.length)return o;var l=Math.floor(i*O),g=Math.floor(e*O);s=Math.floor(s*O);n=Math.floor(n*O);var u=N[g]&&N[g][l];e=N[n]&&N[n][s];if(!u||!e)return o;e=b;i=R;r=L[r||"MANHATTAN"];var c=Math.abs,d=Math.SQRT2,p,v,x,_,I,C,w,D=S,P=D,M,F,k,G,Y,z,B,H,U,W;h&&(P=Math.max(h.size.x,h.size.y),F=E&&T,a&&(M=!0,k=ig.pathfinding.nodeHasCollidingEntities));e.push(u);a=Infinity;for(var u=-Infinity,X,l=l-s,g=g-n,V=l*l+g*g,q;0<e.length;){var Z=e.pop(),K=Z.gridX,j=Z.gridY;i.push(Z);Z.closed=!0;l=K-s;g=j-n;p=l*l+g*g-V;0<p&&(1<Z.g&&p>u&&.5*Z.w<a)&&(X=Z,a=Z.w,u=p);i.length>=A&&(q=X);if(q){for(;q;)o.push(q),q=q.prevNode;t();return o}p=Z.neighbors;I=p.length;F&&(P>D&&!Z.slopedNeighbor&&8>I?(p=Z.directNeighbors,I=p.length,W=-1,Y=!1):(G=Z.neighborMap,z=B=H=U=Y=!1,W=.5*I|1));for(_=0;_<I;_++)if(v=p[_],!v.closed){if(M)if(Y&&(z&&v===G.topleft||B&&v===G.topright||H&&v===G.bottomleft||U&&v===G.bottomright))continue;else if(k(v,Z,h)){F&&_<W&&(v===G.top&&(Y=z=B=!0),v===G.bottom&&(Y=H=U=!0),v===G.left&&(Y=z=H=!0),v===G.right&&(Y=B=U=!0));continue}x=v.gridX;C=v.gridY;var Q=x-K,J=C-j,$=0===Q||0===J?1:d;w=Z.g+$;$=m?$+v.weight+y*v.weightPct:$;if(0<l&&l+Q<l||0>l&&l+Q>l)$+=f;if(0<g&&g+J<g||0>g&&g+J>g)$+=f;Q=Z.w+$;if(!v.opened||Q<v.w){v.g=w;v.w=Q;v.h=v.h||r(c(x-s),c(C-n));v.f=v.w+v.h;v.prevNode=Z;if(v.opened){var ti;C=v.openIndex;for(w=e.length-1;C<w;C++)if(x=e[C+1],x.f<=v.f){ti=!0;break}else x.openIndex=C,e[C]=x;ti||(C=e.length)}else{v.opened=!0;for(C=e.length;0<C&&!(x=e[C-1],v.f<=x.f);C--)x.openIndex=C,e[C]=x}v.openIndex=C;e[C]=v}}}t();return o};ig.pathfinding.getNeighbors=function(t){var i=[],e=t.gridX,s=t.gridY,n=N[s],a=N[s-1],o=N[s+1];(s=a&&a[e])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,0,-1,t))&&i.push(s);(s=n&&n[e+1])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,1,0,t))&&i.push(s);(s=o&&o[e])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,0,1,t))&&i.push(s);(s=n&&n[e-1])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,-1,0,t))&&i.push(s);(s=a&&a[e-1])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,-1,-1,t))&&i.push(s);(s=a&&a[e+1])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,1,-1,t))&&i.push(s);(s=o&&o[e+1])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,1,1,t))&&i.push(s);(s=o&&o[e-1])&&(s.walkable&&ig.pathfinding.isDirectionWalkable(s,-1,1,t))&&i.push(s);return i};ig.pathfinding.getDirectNeighbors=function(t){var i=[],e=t.gridX,s=t.gridY,n,a=N[s];n=N[s-1];s=N[s+1];(n=n&&n[e])&&((n.walkable||t.slopesAlongMap.left)&&ig.pathfinding.isDirectionWalkable(n,0,-1,t))&&i.push(n);(n=a&&a[e+1])&&((n.walkable||t.slopesAlongMap.right)&&ig.pathfinding.isDirectionWalkable(n,1,0,t))&&i.push(n);(n=s&&s[e])&&((n.walkable||t.slopesAlongMap.bottom)&&ig.pathfinding.isDirectionWalkable(n,0,1,t))&&i.push(n);(n=a&&a[e-1])&&(n.walkable&&ig.pathfinding.isDirectionWalkable(n,-1,0,t))&&i.push(n);return i};ig.pathfinding.getDiagonalNeighbors=function(t){var i=[],e=t.gridX,s=t.gridY,n=N[s-1],a=N[s+1];(s=n&&n[e-1])&&((s.walkable||t.slopesAlongMap.topleft)&&ig.pathfinding.isDirectionWalkable(s,-1,-1,t))&&i.push(s);(s=n&&n[e+1])&&((s.walkable||t.slopesAlongMap.topright)&&ig.pathfinding.isDirectionWalkable(s,1,-1,t))&&i.push(s);(s=a&&a[e+1])&&((s.walkable||t.slopesAlongMap.bottomright)&&ig.pathfinding.isDirectionWalkable(s,1,1,t))&&i.push(s);(s=a&&a[e-1])&&((s.walkable||t.slopesAlongMap.bottomleft)&&ig.pathfinding.isDirectionWalkable(s,-1,1,t))&&i.push(s);return i};ig.pathfinding.nodeHasCollidingEntities=function(t,i,e,s){var a=ig.game.layersMap[e.layerName];if(a&&a.spatialHash){var o=a.spatialHashCellSize,h=t.x,r=t.y;if(a=a.spatialHash[h/o|0])if((o=a[r/o|0])&&0<o.length){var l=.45*e.size.x,g=.45*e.size.y,a=h-l,u=r-g,h=h+l,r=r+g,g=t.gridX-i.gridX;t=t.gridY-i.gridY;i=0;for(l=o.length;i<l;i++){var c=o[i];if(c!==e&&!(c.group&e.group)&&(!s||c!==s)&&!c.hidden&&!c._killed&&(c.collides!==ig.EntityExtended.COLLIDES.NEVER||c.type&ig.EntityExtended.TYPE.DANGEROUS&&c.checkAgainst&e.type)&&n.AABBIntersect(a,u,h,r,c.pos.x,c.pos.y,c.pos.x+c.size.x,c.pos.y+c.size.y))if(!c.oneWay||(!c.climbable||!e.canClimb&&!(0===e.gravityFactor||0===ig.game.gravity))&&(0>t&&0<c.oneWayFacing.y||0<t&&0>c.oneWayFacing.y||0>g&&0<c.oneWayFacing.x||0<g&&0>c.oneWayFacing.x))return!0}}}return!1};ig.pathfinding.getGridNode=function(t,i){return N[i]&&N[i][t]};ig.pathfinding.getNode=function(t,i,e,s){return ig.pathfinding.getGridNode(Math.floor(t*O)+(e||0),Math.floor(i*O)+(s||0))};ig.pathfinding.getGridWalkableNode=function(t,i,e,s,n,a){var o=i+(s||0),o=N[o]&&N[o][t+(e||0)];t=N[i]&&N[i][t];if(o&&o.walkable&&(!e&&!s||ig.pathfinding.isDirectionWalkable(o,e,s,t)))if(n&&a){if(!t||!ig.pathfinding.nodeHasCollidingEntities(o,t,a))return o}else return o};ig.pathfinding.getWalkableNode=function(t,i,e,s,n,a){return ig.pathfinding.getGridWalkableNode(Math.floor(t*O),Math.floor(i*O),e,s,n,a)};ig.pathfinding.getWalkableNodeChain=function(t,i,e,s,n,a,o,h){t=Math.floor(t*O);i=Math.floor(i*O);n=n||2;h?h.length=0:h=[];for(var r=1;r<=n;r++){var l=ig.pathfinding.getGridWalkableNode(t+e*r,i+s*r,e,s,a,o);if(!l)break;h.push(l)}return h};ig.pathfinding.isGridWalkable=function(t,i,e,s,n,a){var o=i+(s||0),o=N[o]&&N[o][t+(e||0)];t=N[i]&&N[i][t];if(o&&o.walkable&&(!e&&!s||ig.pathfinding.isDirectionWalkable(o,e,s,t)))if(n&&a){if(t&&!ig.pathfinding.nodeHasCollidingEntities(o,t,a))return!0}else return!0;return!1};ig.pathfinding.isWalkable=function(t,i,e,s,n,a){return ig.pathfinding.isGridWalkable(Math.floor(t*O),Math.floor(i*O),e,s,n,a)};ig.pathfinding.isDirectionWalkable=function(t,i,e,s){if(0!==i&&0!==e&&s){if(!E)return!1;s=s.neighborMap;if(T){if(0<i){if(!s.right||!s.right.walkable&&!s.right.sloped)return!1}else if(!s.left||!s.left.walkable&&!s.left.sloped)return!1;if(0<e){if(!s.bottom||!s.bottom.walkable&&!s.bottom.sloped)return!1}else if(!s.top||!s.top.walkable&&!s.top.sloped)return!1}else if(0<i)if(0<e){if((!s.right||!s.right.walkable&&!s.right.sloped)&&(!s.bottom||!s.bottom.walkable&&!s.bottom.sloped))return!1}else{if((!s.right||!s.right.walkable&&!s.right.sloped)&&(!s.top||!s.top.walkable&&!s.top.sloped))return!1}else if(0<e){if((!s.left||!s.left.walkable&&!s.left.sloped)&&(!s.bottom||!s.bottom.walkable&&!s.bottom.sloped))return!1}else if((!s.left||!s.left.walkable&&!s.left.sloped)&&(!s.top||!s.top.walkable&&!s.top.sloped))return!1}return t.oneWay&&!t.climbable&&(0>e&&0<t.oneWayFacing.y||0<e&&0>t.oneWayFacing.y||0>i&&0<t.oneWayFacing.x||0<i&&0>t.oneWayFacing.x)?!1:!0};ig.pathfinding.isGridPointInGrid=function(t,i){return N[i]&&N[i][t]instanceof Node};ig.pathfinding.isPointInGrid=function(t,i,e,s){t=Math.floor(t*O)+(e||0);i=Math.floor(i*O)+(s||0);return N[i]&&N[i][t]instanceof Node};ig.pathfinding.getPositionPathfindingEntities=function(t,i,e){e||(e={from:{x:.1,y:.1},target:{x:.1,y:.1}});var s=t.size.x,n=t.size.y,a=t.pos.x,o=t.pos.y,h=o+n,r=a+.5*s,l=o+.5*n,g=i.size.x,u=i.size.y,c=i.pos.x,d=i.pos.y,p=d+u,m=c+.5*g,y=d+.5*u,f=.25*S;r>m?(e.from.x=a+f,e.target.x=c+g-f):r<m?(e.from.x=a+s-f,e.target.x=c+f):(e.from.x=a+.5*s,e.target.x=c+.5*g);l>y?(e.from.y=t.hasGravity?h-f:o+f,e.target.y=p-f):l<y?(e.from.y=h-f,e.target.y=i.hasGravity?p-f:d+f):(e.from.y=t.hasGravity?h-f:o+.5*n,e.target.y=i.hasGravity?p-f:d+.5*u);return e};ig.pathfinding.getPositionPathfindingPoint=function(t,i,e,s){s||(s={});s.x=t.pos.x+.5*t.size.x;s.y=t.pos.y+.5*t.size.y;s.x>i?s.x=t.pos.x+.25*S:s.x<i&&(s.x=t.pos.x+t.size.x-.25*S);t.hasGravity||s.y<e?s.y=t.pos.y+t.size.y-.25*S:s.y>e&&(s.y=t.pos.y+.25*S);return s};ig.pathfinding.getBoundsPathfollowing=function(t,i,e,s,n,a,o){o||(o={});var h=Math.min(.5*S,.5*e),r=Math.min(.5*S,.5*s);n.corner?n.cornerMap.bottomleft?(o.minX=t,o.maxX=o.minX+h,o.maxY=i+s,o.minY=o.maxY-r):n.cornerMap.bottomright?(o.maxX=t+e,o.minX=o.maxX-h,o.maxY=i+s,o.minY=o.maxY-r):n.cornerMap.topleft?(o.minX=t,o.maxX=o.minX+h,o.minY=i,o.maxY=o.minY+r):n.cornerMap.topright&&(o.maxX=t+e,o.minX=o.maxX-h,o.minY=i,o.maxY=o.minY+r):(o.ignoreCornerX?(o.minX=t+.5*e-.5*h,o.maxX=o.minX+h):(o.minX=t+.5*e,o.maxX=o.minX),o.maxY=i+s,o.minY=o.maxY-r,n.x>o.maxX?(o.minX=t,o.maxX=o.minX+h):n.x<o.minX&&(o.maxX=t+e,o.minX=o.maxX-h),!o.ignoreCornerX&&(n.x>=o.minX-1&&n.x<=o.maxX+1)&&(o.ignoreCornerX=!0),a&&(o.ignoreCornerY?(o.minY=i+.5*s-.5*r,o.maxY=o.minY+r):(o.minY=i+.5*s,o.maxY=o.minY),n.y>o.maxY?(o.minY=i,o.maxY=o.minY+r):n.y<o.minY&&(o.maxY=i+s,o.minY=o.maxY-r),!o.ignoreCornerY&&(n.y>=o.minY-1&&n.y<=o.maxY+1)&&(o.ignoreCornerY=!0)));o.width=h;o.height=r;return o};ig.pathfinding.getEntityNeighborPositionX=function(t,i,e){return 0!==e?0>e?t-S:t+i+S:t+.5*i};ig.pathfinding.getEntityNeighborPositionY=function(t,i,e,s){return 0!==e?0>e?t-S:t+i+S:s?t+.5*i:t+i-.25*S};ig.pathfinding.getEntityOnSmoothSlope=function(t,i,e){var s=.25*S;return(t=0>i?ig.pathfinding.getNode(t.pos.x+s,t.pos.y+t.size.y-s):ig.pathfinding.getNode(t.pos.x+t.size.x-s,t.pos.y+t.size.y-s))?v?(i=0>i?"left":"right",t.slopesAlongMap[i]||e&&t.slopesAlongMap[(0>e?"top":"bottom")+i]||!e&&(t.slopesAlongMap["top"+i]||t.slopesAlongMap["bottom"+i])):t.slopedAlong:!1};ig.pathfinding.getSlopeDirectionY=function(t,i){var s=.25*S;return(s=0>i?ig.pathfinding.getNode(t.pos.x+s,t.pos.y+t.size.y-s):ig.pathfinding.getNode(t.pos.x+t.size.x-s,t.pos.y+t.size.y-s))&&s.sloped&&s.slopeNormal?e.direction(-s.slopeNormal.x*(0>i?1:-1)):0};ig.pathfinding.getIsAlongSlope=function(t,i,e){var s,n;0>i?(s="left",i=1,n=3):(s="right",i=3,n=1);var a;"undefined"!==typeof e?0!==e?0>e?(a=t.neighborMap["top"+s],e=0,s=1):(a=t.neighborMap["bottom"+s],e=0,s=-1):(a=t.neighborMap[s],e=1,s=0):t.sloped?(a=t.neighborMap["top"+s],e=0,s=1):(a=t.neighborMap[s],e=1,s=0);if(a&&a.sloped){var o=ig.game.collisionMap&&ig.game.collisionMap.tiledef||ig.CollisionMap.defaultTileDef;t=o[t.tile];a=o[a.tile];if(!a||!t&&a[n]===e||t&&t[i]+s===a[n])return!0}return!1}});ig.baked=!0;ig.module("plusplus.core.game").requires("impact.game","plusplus.core.config","plusplus.core.timer","plusplus.core.font","plusplus.core.image","plusplus.core.background-map","plusplus.core.collision-map","plusplus.core.pathfinding-map","plusplus.core.animation","plusplus.core.layer","plusplus.core.input","plusplus.core.entity","plusplus.core.camera","plusplus.core.player-manager","plusplus.abstractities.spawner","plusplus.entities.light","plusplus.entities.shape-solid","plusplus.entities.shape-climbable","plusplus.entities.shape-climbable-one-way","plusplus.ui.ui-overlay-pause","plusplus.helpers.signals","plusplus.helpers.tweens","plusplus.helpers.pathfinding","plusplus.helpers.utils","plusplus.helpers.utilstile","plusplus.helpers.utilsintersection").defines(function(){var t=ig.CONFIG,i=ig.pathfinding,e=ig.utils,s=ig.utilstile,n=ig.utilsintersection;ig.GameExtended=ig.Game.extend({config:{gameData:{gameStarted:!1,level:1}},shapesPasses:{level:{retainBoundaryOuter:!1,discardEdgesInner:!0,ignoreClimbables:!0,ignoreOneWays:!0},climbables:{ignoreSolids:!0,ignoreOneWays:!0}},shapesLevel:[],layers:[],layersMap:{},sortLayersBy:null,paused:!1,pauseLocked:!1,changed:!1,changedLights:!1,dirtyEntities:!0,dirtyLights:!0,deferring:!1,hasLevel:!1,entities:[],namedEntities:{},persistentEntities:{},autoSpawnPlayer:t.AUTO_SPAWN_PLAYER,playerClass:null,canSearchForPlayerByClass:!0,canSearchForPlayerByType:!0,lights:[],gravity:t.TOP_DOWN?0:t.GRAVITY,cameraClass:ig.Camera,cameraSettings:null,camera:null,playerManagerClass:ig.PlayerManager,playerManagerSettings:null,playerManager:null,pathfindingMap:null,onPaused:null,onUnpaused:null,clearColor:t.CLEAR_COLOR,_gameNeedsSetup:!0,_gameNeedsResize:!1,_gameForceResize:!1,_levelBuilding:!1,_levelToBuild:null,_levelNeedsBuild:!1,_levelNeedsUnload:!1,_playerSpawnerName:"",_layersToChange:[],_layersToAdd:[],_layersToRemove:[],_itemsToAdd:[],_itemsToAddNext:[],_itemsToRemove:[],_itemsToRemoveNext:[],init:function(){this._gameNeedsSetup&&this.setup()},setup:function(){this._gameNeedsSetup=!1;this.onPaused=new ig.Signal;this.onUnpaused=new ig.Signal;this.cameraClass&&(this.camera=new this.cameraClass(this.cameraSettings));this.playerManagerClass&&(this.playerManager=new this.playerManagerClass(this.playerManagerSettings));this.sortLayersBy=this.sortLayersBy||ig.Game.SORT.Z_INDEX;this.addLayer(new ig.Layer("backgroundMaps",{preRender:t.PRERENDER_BACKGROUND_LAYER,noUpdate:t.NO_UPDATE_BACKGROUND_LAYER}));this.addLayer(new ig.Layer("lights"));this.addLayer(new ig.Layer("entities"));this.addLayer(new ig.Layer("foregroundMaps",{preRender:t.PRERENDER_FOREGROUND_LAYER,noUpdate:t.NO_UPDATE_FOREGROUND_LAYER}));this.addLayer(new ig.Layer("overlay",{zIndex:1,ignorePause:t.IGNORE_PAUSE_OVERLAY_LAYER,autoSort:t.AUTO_SORT_OVERLAY_LAYER}));this.addLayer(new ig.Layer("ui",{zIndex:2,clearOnLoad:t.CLEAR_ON_LOAD_UI_LAYER,ignorePause:t.IGNORE_PAUSE_UI_LAYER,autoSort:t.AUTO_SORT_UI_LAYER}));for(var i in t.LAYERS_CUSTOM)this.addLayer(new ig.Layer(i,t.LAYERS_CUSTOM[i]));this._addDeferredLayers();ig.global.addEventListener("resize",e.debounce(this.resize.bind(this),t.RESIZE_DELAY),!1);this.resize();this.inputStart()},loadLevelDeferred:function(t,i){this.resetLoadLevel();this._levelToLoad=t;this._playerSpawnerName=i},loadLevel:function(i){this._gameNeedsSetup&&this.setup();i=i||this._levelToLoad;this._levelToLoad=void 0;"string"===typeof i&&(i=i.replace(/^(Level)?(\w)(\w*)/,function(t,i,e,s){return e.toUpperCase()+s}),i=i.replace(/[-|\s?)](.)/g,function(t,i){return i.toUpperCase()}),i=ig.global["Level"+i]);if(i)if(this._levelToBuild=i,this.hasLevel&&t.TRANSITION_LEVELS&&this.layersMap[t.TRANSITIONER_LAYER]&&this.layersMap[t.TRANSITIONER_LAYER].ignorePause){var e=this;this.transitioner||(this.transitioner=this.spawnEntity(ig.UIOverlay,0,0,{name:"transitioner",layerName:t.TRANSITIONER_LAYER,zIndex:t.Z_INDEX_TRANSITIONER,fillStyle:t.TRANSITIONER_COLOR,r:t.TRANSITIONER_R,g:t.TRANSITIONER_G,b:t.TRANSITIONER_B}),this.transitioner.alpha=0);this.transitioner.fadeTo(1,{onComplete:function(){e.removeEntity(e.transitioner);e.buildLevelDeferred()}});this.pause(!0)}else this.buildLevel()},buildLevelDeferred:function(){this._levelToBuild&&(this._levelNeedsBuild=!0)},buildLevel:function(){this._gameNeedsSetup&&this.setup();var e=this._levelToBuild,n=this._playerSpawnerName,a,o,h;if(e){this._levelBuilding=!0;this.unloadLevel();this.collisionMap=ig.CollisionMap.staticNoCollision;for(h=0;h<e.layer.length;h++)o=e.layer[h],"collision"===o.name?this.collisionMap=new ig.CollisionMap(o.tilesize,o.data):"pathfinding"===o.name?this.pathfindingMap=new ig.PathfindingMap(o.tilesize,o.data):(a=new ig.BackgroundMapExtended(o.tilesize,o.data,o.tilesetName),a.anims=this.backgroundAnims[o.tilesetName]||{},a.repeat=o.repeat,a.distance=o.distance,a.foreground=!!o.foreground,a.preRender=!!o.preRender,a.name=o.name,!a.layerName&&a.foreground?a.layerName="foregroundMaps":a.layerName||(a.layerName="backgroundMaps"),this.addItem(a));s.rebuild(this.collisionMap);this.createShapes();t.PATHFINDING.BUILD_WITH_LEVEL&&i.rebuild(this.collisionMap,this.pathfindingMap);this.namedEntities={};h=0;for(o=e.entities.length;h<o;h++)a=e.entities[h],this.spawnEntity(a.type,a.x,a.y,a.settings);e=this.getPlayer();!e&&this.autoSpawnPlayer&&(e=this.persistentEntities.player||this.playerClass)&&this.spawnEntity(e,0,0);this.transitioner&&(this.transitioner._layerNameAdd?this.transitioner.alpha=1:this.spawnEntity(this.transitioner,0,0,{alpha:1}),this.transitioner.fadeToDeath(),this.transitioner=void 0);h=0;for(o=this.layers.length;h<o;h++)a=this.layers[h],a.items.sort(a.sortBy);this._levelBuilding=!1;this.hasLevel=!0;h=0;for(o=this.layers.length;h<o;h++)this.layers[h].ready();e&&n&&(n=this.namedEntities[n])&&(n instanceof ig.Spawner?n.spawnNext(e):e.moveToPosition(n));this.unpause(!0);this.camera&&this.camera.ready();this.playerManager&&this.playerManager.ready();this.resize(!0);this.dirtyEntities=this.dirtyLights=!0}},unloadLevelDeferred:function(){this._levelNeedsUnload=!0},unloadLevel:function(){if(this.hasLevel){this.hasLevel=!1;this.shapesLevel.length=0;this.playerManager&&this.playerManager.reset();this.camera&&this.camera.reset();this._removeDeferredItems();this._addDeferredItems();this.resetLoadLevel();i.unload();for(var t=0,e=this.layers.length;t<e;t++)this.layers[t].reset()}},resetLoadLevel:function(){this._levelToLoad=this._levelToBuild=void 0;this._levelNeedsBuild=this._levelNeedsUnload=!1;this._playerSpawnerName=""},createShapes:function(){var t,i,e;if(this.shapesPasses&&this.collisionMap)for(var n in this.shapesPasses){t=this.shapesPasses[n];e=s.shapesFromCollisionMap(this.collisionMap,t);t=0;for(i=e.solids.length;t<i;t++){var a=e.solids[t];"level"===n?(a.size=a.settings.size,a.vertices=a.settings.vertices,delete a.id,delete a.settings,this.shapesLevel.push(a)):this.spawnEntity(ig.EntityShapeSolid,a.x,a.y,a.settings)}t=0;for(i=e.oneWays.length;t<i;t++)a=e.oneWays[t],this.spawnEntity(ig.EntityShapeSolid,a.x,a.y,a.settings);t=0;for(i=e.climbables.length;t<i;t++)a=e.climbables[t],this.spawnEntity(a.settings.oneWay?ig.EntityShapeClimbableOneWay:ig.EntityShapeClimbable,a.x,a.y,a.settings)}},addLayer:function(t){this._layersToAdd.push(t);return t},_addDeferredLayers:function(t){t=t||this._layersToAdd;if(0<t.length){for(var i=0,e=t.length;i<e;i++){var s=t[i];this.layersMap[s.name]!==s&&(this.layersMap[s.name]&&this.removeLayer(this.layersMap[s.name]),this.layersMap[s.name]=s,this.layers.push(s),this.sortLayersBy&&this.layers.sort(this.sortLayersBy))}t===this._layersToAdd&&(this._layersToAdd.length=0)}},removeLayer:function(t){this._layersToRemove.push(t)},_removeDeferredLayers:function(t){t=t||this._layersToRemove;if(0<t.length){for(var i=0,s=t.length;i<s;i++){var n=t[i];e.arrayCautiousRemove(this.layers,n);this.layersMap[n.name]===n&&delete this.layersMap[n.name];n.reset()}t===this._layersToRemove&&(this._layersToRemove.length=0)}},changeLayer:function(t,i){this._layersToChange.push({name:t,settings:i})},_changeDeferredLayers:function(){if(0<this._layersToChange.length){for(var t=0,i=this._layersToChange.length;t<i;t++){var e=this._layersToChange[t],s=e.settings;(e=this.layersMap[e.name])&&ig.merge(e,s)}this._layersToChange.length=0}},spawnEntity:function(i,e,s,n){var a="string"===typeof i?ig[i]||ig.global[i]:i;if(!a)throw Error("Can't spawn entity of type: "+i+". It does not exist in namespace 'ig' or 'ig.global'/'window'.");if(a instanceof ig.EntityExtended){i=a;if(i._layerNameAdd)return i;i.reset(e,s,n)}else i=new a(e,s,n);i.name&&(i.persistent&&(this.persistentEntities[i.name]instanceof ig.EntityExtended?(i=this.persistentEntities[i.name],i.reset(e,s,n)):this.persistentEntities[i.name]=i),this.namedEntities[i.name]=i);if(t.FORCE_ENTITY_EXTENDED&&!(i instanceof ig.EntityExtended))throw Error("You are trying to spawn an entity that does not inherit or extend ig.EntityExtended. Although it is not recommended (seriously), if you wish to allow this, see ig.CONFIG.FORCE_ENTITY_EXTENDED.");this.addItem(i);return i},removeEntity:function(t,i){t instanceof ig.EntityExtended&&!t._killed&&this.flagAsKilled(t);this.removeItem(t,i)},clearPersistentEntity:function(t){var i=ig.game.persistentEntities[t];i&&(i.added?i._cleanupPersistent=!0:i.cleanupPersistent(),delete ig.game.persistentEntities[t])},clearPersistentEntities:function(){for(var t in ig.game.persistentEntities)this.clearPersistentEntity(t)},flagAsKilled:function(t){t.name&&delete this.namedEntities[t.name];t._killed=!0;t.type=ig.EntityExtended.TYPE.NONE;t.checkAgainst=ig.EntityExtended.TYPE.NONE;t.collides=ig.EntityExtended.COLLIDES.NEVER},addItem:function(t,i){if(!t._killed){var e;i?(t._layerChange=i.forChange||!1,e=i.layerName||t.layerName||"entities"):(t._layerChange=!1,e=t.layerName||"entities");if(t._layerChange||!t._layerNameAdd)t._layerNameAdd=e,this._levelBuilding?this._addDeferredItem(t):this.deferring?this._itemsToAdd.push(t):this._itemsToAddNext.push(t)}},_addDeferredItems:function(){if(0<this._itemsToAdd.length){for(var t=0,i=this._itemsToAdd.length;t<i;t++)this._addDeferredItem(this._itemsToAdd[t]);this._itemsToAdd.length=0}},_addDeferredItem:function(t){this._gameNeedsSetup&&this.setup();t.layerName=t._layerNameAdd;t._layerNameAdd=void 0;var i=this.layersMap[t.layerName];if(!i)throw Error("Attempting to add item/entity to layer named "+t.layerName+" and that layer doesn't exist. Your item needs a 'layerName' property with a value matching one of the existing game layer names: ",this.layersMap);i.addItem(t);t.added=!0;!t._layerChange&&!this._levelBuilding&&(i.paused?t.pause&&t.pause():t.paused&&t.unpause&&t.unpause(),t.adding&&t.adding());t._layerChange=!1;this.dirtyEntities=!0;t instanceof ig.EntityLight&&(this.dirtyLights=!0)},removeItem:function(t,i){i?(t._layerNameRemove=i.layerName||t.layerName,t._layerChange=i.forChange||!1):(t._layerNameRemove=t.layerName,t._layerChange=!1);t._layerChange||(t.cleanup&&t.cleanup(),t.added=!1);this._levelBuilding?this._removeDeferredItem(t):(t._layerNameAdd&&(t._layerNameAdd=void 0,e.arrayCautiousRemove(this._itemsToAddNext,t),e.arrayCautiousRemove(this._itemsToAdd,t)),this.deferring?this._itemsToRemove.push(t):this._itemsToRemoveNext.push(t))},_removeDeferredItems:function(){if(0<this._itemsToRemove.length){for(var t=0,i=this._itemsToRemove.length;t<i;t++)this._removeDeferredItem(this._itemsToRemove[t]);this._itemsToRemove.length=0}},_removeDeferredItem:function(t){var i=this.layersMap[t._layerNameRemove];t._layerNameRemove=void 0;i&&i.removeItem(t);this.dirtyEntities=!0;t instanceof ig.EntityLight&&(this.dirtyLights=!0)},_advanceDeferredNext:function(){0<this._itemsToAddNext.length&&(this._itemsToAdd=this._itemsToAddNext,this._itemsToAddNext=[]);0<this._itemsToRemoveNext.length&&(this._itemsToRemove=this._itemsToRemoveNext,this._itemsToRemoveNext=[])},layerChangeItem:function(t,i){t&&(!i&&t.resetState&&(i=t.resetState.layerName),i&&t.layerName!==i&&(this.removeItem(t,{layerName:t.layerName,forChange:!0}),this.addItem(t,{layerName:i,forChange:!0})))},sortEntitiesDeferred:function(t){if("string"===typeof t)this.sortEntitiesOnLayerDeferred(this.layersMap[t]);else{t=0;for(var i=this.layers.length;t<i;t++)this.sortEntitiesOnLayerDeferred(this.layers[t])}},sortEntitiesOnLayerDeferred:function(t){t&&t.sort()},sortEntities:function(t){this.sortEntitiesDeferred(t)},sortEntitiesOnLayer:function(t){this.sortEntitiesOnLayerDeferred(t)},isInsideLevel:function(t,e){if(i.tilesize){var n=i.getNode(t,e);return n&&n.insideLevel}return this.collisionMap?s.isTileWalkableStrict(this.collisionMap.getTile(t,e)):!0},getPlayer:function(t){return this.namedEntities.player||this.canSearchForPlayerByClass&&this.getEntitiesByClass("Player",t||{first:!0})[0]||this.canSearchForPlayerByType&&this.getEntitiesByType(ig.EntityExtended.TYPE.PLAYER,t||{first:!0})[0]},getEntitiesByClass:function(t,i){var e="string"===typeof t?ig.global[t]:t;return e?this.getEntitiesMatching(function(t){return t instanceof e},i):[]},getEntitiesByType:function(t,i){var s="string"===typeof t?e.getType(ig.EntityExtended,t):t;return this.getEntitiesMatching(function(t){return t.type&s},i)},getEntitiesByGroup:function(t,i){var s="string"===typeof t?e.getType(ig.EntityExtended,t):t;return this.getEntitiesMatching(function(t){return t.group&s},i)},getCharactersByGroup:function(t,i){var s="string"===typeof t?e.getType(ig.EntityExtended,t):t;return this.getEntitiesMatching(function(t){return t.group&s&&t instanceof ig.Character},i)},getEntitiesMatching:function(t,i){var e=[],s,a,o,h,r,l,g,u,c,d,p,m,y,f,E;if(!i||!i.layerName){i=i||{};i.unsorted=!0;a=0;for(E=this.layers.length;a<E&&!(s=this.layers[a],s.numEntities&&(i.layerName=s.name,h=this.getEntitiesMatching(t,i),h.length&&(e=e.concat(h),i.first)));a++);}else if(i&&(a=i.layerName,o=i.unsorted,h=i.distanceSquared,r=i.byDistance,l=i.lineOfSight,g=i.nonHidden,u=i.from,f=i.first,"undefined"!==typeof i.minX&&(c=!0,d=i.minX,p=i.minY,m=i.maxX,y=i.maxY)),s=this.layersMap[a]){s=s.items;a=0;for(E=s.length;a<E;a++){var T=s[a];if(!T._killed&&t(T)&&(!g||!T.hidden)&&(!h||T.distanceSquaredTo(u)<=h)&&(!c||n.AABBIntersect(d,p,m,y,T.pos.x,T.pos.y,T.pos.x+T.width,T.pos.y+T.height))&&(!l||u.lineOfSight(T)))if(e.push(T),f)break}}1<e.length&&!o&&(r?u instanceof ig.EntityExtended?n.sortByDistance(u.pos.x+.5*u.size.x,u.pos.y+.5*u.size.y,e):n.sortByDistance(u.x,u.y,e):e.sort(this.sortBy));return e},getMapByName:function(t){var i,e,s,n,a;if("collision"===t)return this.collisionMap;i=0;for(e=this.layers.length;i<e;i++)if(s=this.layers[i],a=s.items,s.numBackgroundMaps){s=0;for(n=a.length;s<n;s++){var o=a[s];if(o.name===t)return o}}},pause:function(i){if(!this.pauseLocked&&!this._levelBuilding){for(var e=0,s=this.layers.length;e<s;e++)this.layers[e].pause();this.paused||(this.paused=!0,this.pauseLocked=i,this.camera&&this.camera.pause(),!this.pauseLocked&&t.DIMMED_PAUSE&&(this.dimmer||(this.dimmer=this.spawnEntity(ig.UIOverlayPause,0,0,{fillStyle:t.DIMMER_COLOR,r:t.DIMMER_R,g:t.DIMMER_G,b:t.DIMMER_B,alpha:0})),this.dimmer.fadeTo(t.DIMMER_ALPHA)),this.onPaused.dispatch(this))}},unpause:function(t){t&&(this.pauseLocked=!1);if(!this.pauseLocked&&!this._levelBuilding){t=0;for(var i=this.layers.length;t<i;t++)this.layers[t].unpause();this.paused&&(this.paused=!1,this.camera&&this.camera.unpause(),this.dimmer&&(this.dimmer.fadeToDeath(),this.dimmer=void 0),this.onUnpaused.dispatch(this))}},inputStart:function(){ig.input.bind(ig.KEY.MOUSE1,"touch");ig.input.bind(ig.KEY.MOUSE2,"touch");ig.input.bind(ig.KEY.TAP,"tap");ig.input.bind(ig.KEY.TAP_DOUBLE,"tapDouble");ig.input.bind(ig.KEY.HOLD,"hold");ig.input.bind(ig.KEY.HOLD_ACTIVATE,"holdActivate");ig.input.bind(ig.KEY.SWIPE,"swipe");ig.input.bind(ig.KEY.SWIPE_X,"swipeX");ig.input.bind(ig.KEY.SWIPE_Y,"swipeY");ig.input.bind(ig.KEY.SWIPE_LEFT,"swipeLeft");ig.input.bind(ig.KEY.SWIPE_RIGHT,"swipeRight");ig.input.bind(ig.KEY.SWIPE_UP,"swipeUp");ig.input.bind(ig.KEY.SWIPE_DOWN,"swipeDown");ig.input.bind(ig.KEY.LEFT_ARROW,"left");ig.input.bind(ig.KEY.RIGHT_ARROW,"right");ig.input.bind(ig.KEY.UP_ARROW,"up");ig.input.bind(ig.KEY.DOWN_ARROW,"down");ig.input.bind(ig.KEY.A,"left");ig.input.bind(ig.KEY.D,"right");ig.input.bind(ig.KEY.W,"up");ig.input.bind(ig.KEY.S,"down");ig.input.bind(ig.KEY.SPACE,"jump")},inputEnd:function(){ig.input.unbind(ig.KEY.MOUSE1,"touch");ig.input.unbind(ig.KEY.MOUSE2,"touch");ig.input.unbind(ig.KEY.TAP,"tap");ig.input.unbind(ig.KEY.TAP_DOUBLE,"tapDouble");ig.input.unbind(ig.KEY.HOLD,"hold");ig.input.unbind(ig.KEY.HOLD_ACTIVATE,"holdActivate");ig.input.unbind(ig.KEY.SWIPE,"swipe");ig.input.unbind(ig.KEY.SWIPE_X,"swipeX");ig.input.unbind(ig.KEY.SWIPE_Y,"swipeY");ig.input.unbind(ig.KEY.SWIPE_LEFT,"swipeLeft");ig.input.unbind(ig.KEY.SWIPE_RIGHT,"swipeRight");ig.input.unbind(ig.KEY.SWIPE_UP,"swipeUp");ig.input.unbind(ig.KEY.SWIPE_DOWN,"swipeDown");ig.input.unbind(ig.KEY.LEFT_ARROW,"left");ig.input.unbind(ig.KEY.RIGHT_ARROW,"right");ig.input.unbind(ig.KEY.UP_ARROW,"up");ig.input.unbind(ig.KEY.DOWN_ARROW,"down");ig.input.unbind(ig.KEY.A,"left");ig.input.unbind(ig.KEY.D,"right");ig.input.unbind(ig.KEY.W,"up");ig.input.unbind(ig.KEY.S,"down");ig.input.unbind(ig.KEY.SPACE,"jump")},handleInput:function(){var t,i,e,s,n,a,o,h;if(ig.input.released("tap")){n=ig.input.getInputPoints(["tapped"],[!0]);t=0;for(i=n.length;t<i;t++)if(a=n[t],o=a.targets,0<o.length){e=0;for(s=o.length;e<s;e++)if(h=o[e],h.type&ig.EntityExtended.TYPE.UI&&h.fixed){h.toggleActivate();a.tapped=!1;1===i&&(ig.input.delayedKeyup.tap=!1);break}}}},update:function(){var t,i,e;this.deferring=!1;this._removeDeferredLayers();this._addDeferredLayers();this._changeDeferredLayers();this._removeDeferredItems();this._addDeferredItems();this._advanceDeferredNext();this._levelToLoad?this.loadLevel():this._levelNeedsBuild?this.buildLevel():this._levelNeedsUnload&&this.unloadLevel();this._gameNeedsResize&&this.resize(this._gameForceResize);this.deferring=!0;if(!1!==this.dirtyEntities){t=this.entities.length=this.lights.length=0;for(i=this.layers.length;t<i;t++)e=this.layers[t],e.numEntities&&0<e.items.length&&(this.entities=this.entities.concat(e.items),this.lights=this.lights.concat(e.itemsLight))}ig.TWEEN.update();ig.input.update();this.handleInput();this.playerManager&&this.playerManager.update();this.changed=this.changedLights=!1;t=0;for(i=this.layers.length;t<i;t++)e=this.layers[t],e.update(),this.changed|=e.changed,this.changedLights|=e.changedLights;for(var s in this.backgroundAnims)for(t in i=this.backgroundAnims[s],i)i[t].update();this.camera&&this.camera.update();this.dirtyEntities=this.dirtyLights=!1},updateEntities:function(t){if(t=this.layersMap[t]){t=t.items;for(var i=0,e=t.length;i<e;i++)t[i].update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;for(var t=0,i=this.layers.length;t<i;t++)this.layers[t].draw()},drawEntities:function(t){if(t=this.layersMap[t]){t=t.items;for(var i=0,e=t.length;i<e;i++)t[i].draw()}},resize:function(i){var e=t.GAME_WIDTH_PCT?ig.global.innerWidth*t.GAME_WIDTH_PCT:t.GAME_WIDTH,s=t.GAME_HEIGHT_PCT?ig.global.innerHeight*t.GAME_HEIGHT_PCT:t.GAME_HEIGHT,n=t.SCALE;if(t.GAME_WIDTH_VIEW||t.GAME_HEIGHT_VIEW)n=Math.floor(Math.max(Math.min(e/(t.GAME_WIDTH_VIEW||1),s/(t.GAME_HEIGHT_VIEW||1)),1));var n=Math.min(Math.max(n,t.SCALE_MIN),t.SCALE_MAX),a=1/n;ig.system.resize(e*a,s*a,n,i||this._gameForceResize);this._gameNeedsResize=this._gameForceResize=!1},resizeDeferred:function(t){this._gameNeedsResize=!0;this._gameForceResize=t||!1}});ig.Game.SORT.Z_INDEX=function(t,i){return(t.zIndex||0)-(i.zIndex||0)};ig.Game.SORT.POS_X=function(t,i){return(t.pos&&t.size&&t.pos.x+t.size.x||0)-(i.pos&&i.size&&i.pos.x+i.size.x||0)};ig.Game.SORT.POS_Y=function(t,i){return(t.pos&&t.size&&t.pos.y+t.size.y||0)-(i.pos&&i.size&&i.pos.y+i.size.y||0)};ig.GameExtended.SORT=ig.Game.SORT});ig.baked=!0;ig.module("plusplus.core.plusplus").requires("plusplus.core.config","plusplus.core.loader","plusplus.core.game","plusplus.helpers.signals").defines(function(){var t=ig.CONFIG;ig.System.inject({size:240,onResized:null,init:function(t,i,e,s,n){this.onResized=new ig.Signal;this.fps=i;this.clock=new ig.Timer;this.canvas=ig.$(t);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;this.resize(e,s,n)},run:function(){ig.Timer.step();ig.Timer.stepped&&(this.tick=this.clock.tick(),this.delegate.run(),ig.input.clearPressed(),this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null))},resize:function(i,e,s,n){var a;a=1<ig.ua.pixelRatio&&(!this.context.webkitBackingStorePixelRatio||1<this.context.webkitBackingStorePixelRatio)?ig.ua.pixelRatio:1;
this.width=i*a;this.height=e*a;"undefined"!==typeof s&&null!==s&&(this.scale=s);this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight;this.canvas.style.width=Math.round(this.realWidth/a)+"px";this.canvas.style.height=Math.round(this.realHeight/a)+"px";this.size=Math.min(this.width,this.height);1!==this.scale&&t.AUTO_CRISP_SCALING&&(ig.System.scaleMode=ig.System.SCALE.CRISP);ig.System.scaleMode(this.canvas,this.context);this.onResized.dispatch(n)}})});ig.baked=!0;ig.module("plusplus.core.hierarchy").requires("plusplus.helpers.utils").defines(function(){var t=ig.utils,i=0;ig.Hierarchy=ig.Class.extend({id:i++,name:"",descendants:[],descendantsMap:{},ancestor:null,sortBy:null,init:function(t){this.id=i++;this.sortBy=ig.Hierarchy.SORT.PRIORITY;ig.merge(this,t)},setAncestor:function(t){this.ancestor=t},setName:function(t){this.name!==t&&(this.ancestor instanceof ig.Hierarchy&&this.ancestor.unmapDescendant(this),this.name=t,this.ancestor instanceof ig.Hierarchy&&this.ancestor.mapDescendant(this))},setFallback:function(t){this.fallback=t},addDescendants:function(i){i=t.toArray(i);for(var e=0,s=i.length;e<s;e++)this.addDescendant(i[e])},addDescendant:function(t){if(t instanceof ig.Hierarchy){if(!0===this.isAncestor(t))return;void 0!==t.ancestor&&t.ancestor.removeDescendant(t);t.setAncestor(this)}this.mapDescendant(t);this.descendants.push(t);this.sortDescendants()},removeDescendants:function(i){i=t.toArray(i);for(var e=0,s=i.length;e<s;e++)this.removeDescendant(i[e])},removeDescendant:function(i){var e=t.indexOfValue(this.descendants,i);if(-1!==e)i instanceof ig.Hierarchy&&i.setAncestor(),this.descendants.splice(e,1),this.unmapDescendant(i);else for(var e=0,s=this.descendants.length;e<s;e++){var n=this.descendants[e];n instanceof ig.Hierarchy&&n.removeDescendant(i)}},clearDescendants:function(){for(var t=this.descendants.length-1;0<=t;t--){var i=this.descendants[t];i instanceof ig.Hierarchy&&i.setAncestor();this.descendants.length--;this.unmapDescendant(i)}},sortDescendants:function(){this.descendants.sort(this.sortBy)},mapDescendant:function(t){if(t.name){var i=this.descendantsMap[t.name];i instanceof ig.Hierarchy&&i.ancestor.removeDescendant(i);this.descendantsMap[t.name]=t}},unmapDescendant:function(t){t.name&&t===this.descendantsMap[t.name]&&delete this.descendantsMap[t.name]},getDescendantByName:function(t,i){var e=this._getDescendantByName(t,i);!e&&this.fallback&&(e=this.fallback._getDescendantByName(t,i));return e},_getDescendantByName:function(t,i){var e=this.descendantsMap[t];if(!0===i&&!e)for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];if(a instanceof ig.Hierarchy&&(e=a.getDescendantByName(t,i)))break}return e},getDescendantsByType:function(t,i){var e=this._getDescendantsByType(t,i,[]);!e.length&&this.fallback&&(e=this.fallback._getDescendantsByType(t,i,e));return e},_getDescendantsByType:function(t,i,e){for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];a.type&t&&e.push(a);!0===i&&a instanceof ig.Hierarchy&&a._getDescendantsByType(name,i,e)}return e},getDescendants:function(i){i=t.toArray(i).concat(this.descendants);for(var e=0,s=this.descendants.length;e<s;e++){var n=this.descendants[e];n instanceof ig.Hierarchy&&(i=n.getDescendants(i))}return i},getRoot:function(){for(var t=this,i;t;)i=t,t=t.ancestor;return i},isAncestor:function(t){for(var i=this.ancestor;i;){if(i===t)return!0;i=i.ancestor}return!1},forAll:function(t){var i=Array.prototype.slice.call(arguments,1);t.apply(this,i);this.forAllDescendants.apply(this,arguments)},forAllDescendants:function(t){for(var i=Array.prototype.slice.call(arguments,1),e=0,s=this.descendants.length;e<s;e++){var n=this.descendants[e];t.apply(n,i);n instanceof ig.Hierarchy&&n.forAllDescendants.apply(n,arguments)}},forAllWithCallback:function(t){var i=this[t];if("function"===typeof i){var e=Array.prototype.slice.call(arguments,1);i.apply(this,e)}this.forAllDescendantsWithCallback.apply(this,arguments)},forAllDescendantsWithCallback:function(t){for(var i=Array.prototype.slice.call(arguments,1),e=0,s=this.descendants.length;e<s;e++){var n=this.descendants[e],a=n[t];"function"===typeof a&&a.apply(n,i);n instanceof ig.Hierarchy&&n.forAllWithCallback.apply(n,arguments)}},forImmediate:function(t){var i=Array.prototype.slice.call(arguments,1);t.apply(this,i);for(var e=0,s=this.descendants.length;e<s;e++)t.apply(this.descendants[e],i)},forImmediateWithCallback:function(t){var i=this[t];if("function"===typeof i){var e=Array.prototype.slice.call(arguments,1);i.apply(this,e)}for(var s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s],i=a[t];"function"===typeof i&&i.apply(a,e)}},activate:function(){for(var t=!1,i=!1,e="activate",s=0,n=this.descendants.length;s<n;s++){var a=this.descendants[s];a[e].apply(a,arguments);if(!i&&(a.activated||a.getUsing()))t=!0,a.blocking&&(i=!0,e="cleanup")}this.fallback&&(t=this.fallback[e].apply(a,arguments)||t);return t},deactivate:function(){for(var t=0,i=this.descendants.length;t<i;t++)this.descendants[t].deactivate();this.fallback&&this.fallback.deactivate()},update:function(){for(var t=0,i=this.descendants.length;t<i;t++)this.descendants[t].update();this.fallback&&this.fallback.update()},cleanup:function(){for(var t=0,i=this.descendants.length;t<i;t++)this.descendants[t].cleanup();this.fallback&&this.fallback.cleanup()},setEntity:function(t){for(var i=0,e=this.descendants.length;i<e;i++)this.descendants[i].setEntity(t);this.fallback&&this.fallback.setEntity(t)},setEntityTarget:function(t){for(var i=0,e=this.descendants.length;i<e;i++)this.descendants[i].setEntityTarget(t);this.fallback&&this.fallback.setEntityTarget(t)},setEntityTargetFirst:function(t){for(var i=0,e=this.descendants.length;i<e;i++)this.descendants[i].setEntityTargetFirst(t);this.fallback&&this.fallback.setEntityTargetFirst(t)},setEntityOptions:function(t){for(var i=0,e=this.descendants.length;i<e;i++)this.descendants[i].setEntityOptions(t);this.fallback&&this.fallback.setEntityOptions(t)},getUsing:function(){for(var t=0,i=this.descendants.length;t<i;t++)if(this.descendants[t].getUsing())return!0;return this.fallback?this.fallback.getUsing():!1},pause:function(){for(var t=0,i=this.descendants.length;t<i;t++)this.descendants[t].pause();this.fallback&&this.fallback.pause()},unpause:function(){for(var t=0,i=this.descendants.length;t<i;t++)this.descendants[t].unpause();this.fallback&&this.fallback.unpause()},clone:function(t){!0!==t instanceof ig.Hierarchy&&(t=new ig.Hierarchy);t.name=this.name;for(var i=0,e=this.descendants.length;i<e;i++){var s=this.descendants[i];"function"===typeof s.clone&&t.addDescendant(s.clone())}return t}});ig.Hierarchy.SORT={PRIORITY:function(t,i){return i.priority-t.priority},Z_INDEX:function(t,i){return i.zIndex-t.zIndex}}});ig.baked=!0;ig.module("plusplus.abstractities.spawner-fast").requires("plusplus.abstractities.spawner","plusplus.helpers.utils","plusplus.helpers.utilsmath").defines(function(){var t=ig.utils,i=ig.utilsmath;ig.SpawnerFast=ig.global.SpawnerFast=ig.Spawner.extend({spawnNext:function(t){if(0<this.pool.length){if(t=this.pool.pop())t=ig.game.spawnEntity(t,0,0,this.spawnSettings),this.entities.push(t)}else this.spawningEntity&&this.spawnedCount<this.spawnCountMax&&(t=ig.game.spawnEntity(this.spawningEntity,0,0,this.spawnSettings),this.entities.push(t),this.linkSpawned(t));t&&(this.spawnCount=Math.min(this.spawnCountMax,this.spawnCount+1),this.spawnedCount=Math.min(this.spawnCountMax,this.spawnedCount+1),this.spawned(t));return t},unspawn:function(i){if(i._killed){if(this.spawnCount=Math.max(0,this.spawnCount-1),t.arrayCautiousRemove(this.entities,i),this.pool.push(i),this.activated&&-1===this.duration&&!this.spawning&&(0<this.spawnDelay||0===this.spawnCount))this.spawnedCount=this.spawnCount,this.respawnTimer.set(this.respawnDelay),this._reactivate=!0}else i.kill(!0)},spawned:function(t){var e=t.size.x,s=t.size.y,n=this.pos.x,a=this.pos.y,o=n+this.size.x,h=a+this.size.y;t.pos.x=i.map(Math.random(),0,1,n,o-e)-.5*e;t.pos.y=i.map(Math.random(),0,1,a,h-s)-.5*s}})});ig.baked=!0;ig.module("plusplus.abstractities.particle").requires("plusplus.core.config","plusplus.core.timer","plusplus.core.entity").defines(function(){var t=ig.CONFIG;ig.Particle=ig.EntityExtended.extend({animAutomatic:t.PARTICLE.ANIM_AUTOMATIC,animsExpected:["move"],zIndex:t.Z_INDEX_ABOVE_ALL,performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,size:{x:1,y:1},maxVel:{x:150,y:150},friction:{x:20,y:0},minBounceVelocity:0,bounciness:.6,lifeDuration:1,fadeAfterSpawnDuration:0,fadeBeforeDeathDuration:.5,collisionKills:!1,collisionSticky:!1,randomVel:!0,randomDoubleVel:!0,randomFlip:!0,velocityFlip:!0,lifeTimer:null,_fadeAfterInv:0,_fadeBeforeDiff:0,_fadeBeforeInv:0,initProperties:function(){this.parent();this.lifeTimer=new ig.Timer},resetExtras:function(){this.parent();this.animAutomatic&&!this._animsPlaceheld&&(this._animsPlaceheld=!0,this.placeholdAnims());this.fadeAfterSpawnDuration&&(this._fadeAfterInv=1/this.fadeAfterSpawnDuration);this.fadeBeforeDeathDuration&&(this._fadeBeforeInv=1/this.fadeBeforeDeathDuration,this._fadeBeforeDiff=this.lifeDuration-this.fadeBeforeDeathDuration)},placeholdAnims:function(){if(0<this.animsExpected.length){var t=this.anims,i;i=this.animInit instanceof ig.Animation?animInit:this.animInit&&t[this.animInit]?t[this.animInit]:t.idle||this.currentAnim;for(var e=0,s=this.animsExpected.length;e<s;e++){var n=this.animsExpected[e],a=t[n]||i;a&&(t[n+"X"]||(t[n+"X"]=a),t[n+"Right"]||(t[n+"Right"]=t[n+"X"]),t[n+"Left"]||(t[n+"Left"]=t[n+"X"]),t[n+"Y"]||(t[n+"Y"]=a),t[n+"Down"]||(t[n+"Down"]=t[n+"Y"]),t[n+"Up"]||(t[n+"Up"]=t[n+"Y"]))}}},ready:function(){this.lifeTimer.set(this.lifeDuration);this.randomVel&&(this.randomDoubleVel?(this.vel.x*=2*Math.random()-1,this.vel.y*=2*Math.random()-1):(this.vel.x*=Math.random(),this.vel.y*=Math.random()));this.currentAnim&&(this.randomFlip?(this.flip.x=.5<Math.random(),this.flip.y=.5<Math.random()):this.velocityFlip&&(this.canFlipX&&(this.flip.x=0>this.vel.x?!0:!1),this.canFlipY&&(this.flip.y=0>this.vel.y?!0:!1)));this.parent()},pause:function(){this.parent();this.lifeTimer.pause()},unpause:function(){this.parent();this.lifeTimer.unpause()},collideWith:function(t,i,e,s,n,a){this.parent(t,i,e,s,n,a);this.collisionKills?this.kill():this.collisionSticky&&!(t instanceof ig.Particle)&&(this.collides=ig.EntityExtended.COLLIDES.NEVER,this.performance=ig.EntityExtended.PERFORMANCE.MOVABLE,this.moveTo(t,{offset:{x:this.pos.x+.5*this.size.x-(t.pos.x+.5*t.size.x),y:this.pos.y+.5*this.size.y-(t.pos.y+.5*t.size.y)}}))},handleMovementTrace:function(t){this.parent(t);this.collidingWithMap&&(this.collisionKills?this.kill():this.collisionSticky&&(this.applyAntiVelocity(),this.collides=ig.EntityExtended.COLLIDES.NEVER,this.performance=ig.EntityExtended.PERFORMANCE.STATIC))},update:function(){var t=this.lifeTimer.delta();0<=t?this.kill():(t+=this.lifeDuration,this.alpha=(0!==this.fadeAfterSpawnDuration?Math.min(1,t*this._fadeAfterInv):1)-(0!==this.fadeBeforeDeathDuration?Math.max(0,(t-this._fadeBeforeDiff)*this._fadeBeforeInv):0));this.parent()},recordChanges:function(i){this.parent(i);this.changed&&(t.TOP_DOWN||this.canFlipY?this.movingX?(this.facing.x=0>this.vel.x?-1:1,this.facing.y=this.movingY?0>this.vel.y?-1:1:0):this.movingY&&(this.facing.x=0,this.facing.y=0>this.vel.y?-1:1):this.movingX&&(this.facing.x=0>this.vel.x?-1:1))},updateVisible:function(){this.animAutomatic&&!this._killed&&this.updateCurrentAnim();this.parent()},updateCurrentAnim:function(){this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC&&(this.currentAnim=this.anims[this.getDirectionalAnimName("move")])}})});ig.baked=!0;ig.module("plusplus.abstractities.particle-fast").requires("plusplus.core.config","plusplus.abstractities.particle").defines(function(){ig.ParticleFast=ig.Particle.extend({type:ig.EntityExtended.TYPE.NONE,collides:ig.EntityExtended.COLLIDES.NEVER,checkAgainst:ig.EntityExtended.TYPE.NONE,performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,highPerformance:!0,init:function(t,i,e){this.id=++ig.Entity._lastId;this.lifeTimer=new ig.Timer;this.onAdded=new ig.Signal;this.onRemoved=new ig.Signal;this.onMovedTo=new ig.Signal;this.reset(t,i,e)},reset:function(t,i,e){this.pos.x=t;this.pos.y=i;this.posDraw=this.pos;this.sizeDraw=this.size;ig.merge(this,e);this._killed=!1;this.moving=this.movingX=this.movingY=this.changed=!0;this.ignoreSystemScale||(t=Math.min(Math.max(Math.round(ig.system.scale*this.scaleOfSystemScale),this.scaleMin),this.scaleMax),this.scale!==t&&(this.scale=t));this.scaleMod=this.scale/ig.system.scale;this.fadeAfterSpawnDuration&&(this._fadeAfterInv=1/this.fadeAfterSpawnDuration);this.fadeBeforeDeathDuration&&(this._fadeBeforeInv=1/this.fadeBeforeDeathDuration,this._fadeBeforeDiff=this.lifeDuration-this.fadeBeforeDeathDuration)},refresh:function(){},resetCore:function(){},resetExtras:function(){},recordResetState:function(){},ready:function(){this.lifeTimer.set(this.lifeDuration);this.randomVel&&(this.randomDoubleVel?(this.vel.x*=2*Math.random()-1,this.vel.y*=2*Math.random()-1):(this.vel.x*=Math.random(),this.vel.y*=Math.random()));this.currentAnim&&(this.randomFlip?(this.flip.x=.5<Math.random(),this.flip.y=.5<Math.random()):(this.canFlipX&&(this.flip.x=0>this.vel.x?!0:!1),this.canFlipY&&(this.flip.y=0>this.vel.y?!0:!1)))},spawn:function(){},tween:function(){throw Error("Attempting to TWEEN fast particle but fast particle does not tween!")},collideWith:function(){throw Error("Attempting to COLLIDE fast particle but fast particle does not collide!")},handleMovementTrace:function(){throw Error("Attempting to TRACE COLLISION MAP fast particle but fast particle ignore collision map!")},kill:function(){this._killed||ig.game.removeEntity(this)},die:function(){},cleanup:function(){this.moveToStop();this.onRemoved.dispatch(this);if(!ig.game.hasLevel){this.onAdded.removeAll();this.onAdded.forget();this.onRemoved.removeAll();this.onRemoved.forget();this.onMovedTo.removeAll();this.onMovedTo.forget();for(var t in this.anims){var i=this.anims[t];i.onCompleted.removeAll();i.onCompleted.forget()}}},update:function(){if(this.paused)ig.game.camera&&!ig.game.camera.paused&&(this.visible=this.getIsVisible());else if(!this._killed){var t=this.lifeTimer.delta();if(0<=t)return this.kill();t+=this.lifeDuration;this.alpha=(0!==this.fadeAfterSpawnDuration?Math.min(1,t*this._fadeAfterInv):1)-(0!==this.fadeBeforeDeathDuration?Math.max(0,(t-this._fadeBeforeDiff)*this._fadeBeforeInv):0);this.movingTo?this.moveToUpdate():(this.pos.x+=this.vel.x*ig.system.tick,this.pos.y+=this.vel.y*ig.system.tick);this.getIsVisible()?(this.visible=!0,this.currentAnim.update()):this.visible=!1}},getIsVisible:function(){if(0>=this.alpha)return!1;var t=this.posDraw.x-ig.game.screen.x,i=this.posDraw.y-ig.game.screen.y;return 0>t||0>i||t+this.sizeDraw.x>ig.system.width||i+this.sizeDraw.y>ig.system.height?!1:!0},recordChanges:function(){throw Error("Attempting to RECORD CHANGES in fast particle but fast particle is always changed!")},recordLast:function(){throw Error("Attempting to RECORD LAST of fast particle but fast particle doesn't record last!")},updateBounds:function(){throw Error("Attempting to UPDATE BOUNDS of fast particle but fast particle does not update bounds!")},draw:function(){if(this.visible){var t=this.currentAnim,i=t.sheet,e=i.image;if(e.loaded){e._scale!==this.scale&&e.resize(this.scale);var s=this.scale,n=i.width,i=i.height,a=Math.floor(n*s),o=Math.floor(i*s);1!==this.alpha?(ig.system.context.globalAlpha=this.alpha,ig.system.context.drawImage(e.data,Math.floor(t.tile*n)%e.width*s,Math.floor(t.tile*n/e.width)*i*s,a,o,ig.system.getDrawPos(this.posDraw.x-ig.game.screen.x),ig.system.getDrawPos(this.posDraw.y-ig.game.screen.y),a,o),ig.system.context.globalAlpha=1):ig.system.context.drawImage(e.data,Math.floor(t.tile*n)%e.width*s,Math.floor(t.tile*n/e.width)*i*s,a,o,ig.system.getDrawPos(this.posDraw.x-ig.game.screen.x),ig.system.getDrawPos(this.posDraw.y-ig.game.screen.y),a,o);ig.Image.drawCount++}}}})});ig.baked=!0;ig.module("plusplus.entities.particle-color").requires("plusplus.core.config","plusplus.abstractities.particle-fast").defines(function(){ig.EntityParticleColor=ig.global.EntityParticleColor=ig.ParticleFast.extend({size:{x:2,y:2},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"particles.png",2,2),animTileOffset:0,animSequenceCount:7,vel:{x:50,y:50},lifeDuration:.35,fadeBeforeDeathDuration:.15,_animTileOffsetLast:-1,reset:function(t,i,e){this.parent(t,i,e);this._animTileOffsetLast!==this.animTileOffset&&(this._animTileOffsetLast=this.animTileOffset,this.addAnim("move",{sequence:[Math.round(Math.random()*this.animSequenceCount)+this.animTileOffset*(this.animSequenceCount+1)],frameTime:1,stop:!0}))}});ig.EntityParticleColor.colorOffsets={RED:0,YELLOW:4,GREEN:8,BLUE:12,PURPLE:16,BROWN:20,GRAY:24,WHITE:28}});ig.baked=!0;ig.module("plusplus.entities.explosion").requires("plusplus.abstractities.spawner-fast","plusplus.entities.particle-color").defines(function(){ig.EntityExplosion=ig.global.EntityExplosion=ig.SpawnerFast.extend({spawningEntity:ig.EntityParticleColor,spawnCountMax:3,spawnSettings:{vel:{x:100,y:100},animTileOffset:ig.EntityParticleColor.colorOffsets.YELLOW},activated:!0,frozen:!1})});ig.baked=!0;ig.module("plusplus.abstractities.character").requires("plusplus.core.config","plusplus.core.timer","plusplus.core.entity","plusplus.core.hierarchy","plusplus.entities.explosion","plusplus.helpers.utils","plusplus.helpers.utilsmath","plusplus.helpers.utilsintersection","plusplus.helpers.utilsvector2","plusplus.helpers.tweens","plusplus.helpers.pathfinding").defines(function(){var t=ig.CONFIG,i=ig.utils,e=ig.utilsmath,s=ig.utilsintersection,n=ig.utilsvector2,a=ig.pathfinding;ig.Character=ig.EntityExtended.extend({performance:ig.EntityExtended.PERFORMANCE.MOVABLE,targetable:!0,animAutomatic:t.CHARACTER.ANIM_AUTOMATIC,animsExpected:"idle move stairs climb jump fall".split(" "),size:{x:t.CHARACTER.SIZE_EFFECTIVE_X,y:t.CHARACTER.SIZE_EFFECTIVE_Y},offset:{x:t.CHARACTER.SIZE_OFFSET_X,y:t.CHARACTER.SIZE_OFFSET_Y},maxVelUngrounded:{x:t.CHARACTER.MAX_VEL_UNGROUNDED_X,y:t.CHARACTER.MAX_VEL_UNGROUNDED_Y},maxVelGrounded:{x:t.CHARACTER.MAX_VEL_GROUNDED_X,y:t.CHARACTER.MAX_VEL_GROUNDED_Y},maxVelClimbing:{x:t.CHARACTER.MAX_VEL_CLIMBING_X,y:t.CHARACTER.MAX_VEL_CLIMBING_Y},frictionUngrounded:{x:t.CHARACTER.FRICTION_UNGROUNDED_X,y:t.CHARACTER.FRICTION_UNGROUNDED_Y},frictionGrounded:{x:t.CHARACTER.FRICTION_GROUNDED_X,y:t.CHARACTER.FRICTION_GROUNDED_Y},speed:{x:t.CHARACTER.SPEED_X,y:t.CHARACTER.SPEED_Y},canJump:t.CHARACTER.CAN_JUMP&&!t.TOP_DOWN,jumpSteps:t.CHARACTER.JUMP_STEPS,jumpForce:t.CHARACTER.JUMP_FORCE,jumpControl:t.CHARACTER.JUMP_CONTROL,canJumpRepeatedly:t.CHARACTER.CAN_JUMP_REPEATEDLY,additionalJumps:1,canClimb:t.CHARACTER.CAN_CLIMB&&!t.TOP_DOWN,climbingControl:t.CHARACTER.CLIMBING_CONTROL,movingFrom:!1,moveToUnsafe:!1,canPathfind:t.CHARACTER.CAN_PATHFIND,path:[],pathfindingDelay:t.CHARACTER.PATHFINDING_DELAY,pathfindingUpdateDelay:t.CHARACTER.PATHFINDING_UPDATE_DELAY,pathfindingSimpleDelay:t.CHARACTER.PATHFINDING_SIMPLE_DELAY,pathingTimer:null,stuck:!1,stuckDelay:t.CHARACTER.STUCK_DELAY,stuckTimer:null,health:t.CHARACTER.HEALTH,healthMax:t.CHARACTER.HEALTH,energy:t.CHARACTER.ENERGY,energyMax:t.CHARACTER.ENERGY,damageDelay:0,damageTimer:null,temporaryInvulnerabilityPulses:2,temporaryInvulnerabilityAlpha:.5,regen:!1,regenDelay:0,regenTimer:null,regenRateHealth:t.CHARACTER.REGEN_RATE_HEALTH,regenAsPctHealth:!1,regenRateEnergy:t.CHARACTER.REGEN_RATE_ENERGY,regenAsPctEnergy:!1,regenHealth:!0,regenEnergy:!0,mimicLevel:t.RANKS_MAP.NONE,explodingDamage:t.CHARACTER.EXPLODING_DAMAGE,damageSettings:{spawnCountMax:t.CHARACTER.EXPLODING_DAMAGE_PARTICLE_COUNT,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.WHITE}},explodingDeath:t.CHARACTER.EXPLODING_DEATH,deathSettings:{spawnCountMax:t.CHARACTER.EXPLODING_DEATH_PARTICLE_COUNT,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.WHITE}},abilities:null,abilitiesOriginal:null,slopeSticking:t.CHARACTER.SLOPE_STICKING,falling:!1,ungroundedFor:0,ungroundedForThreshold:t.CHARACTER.UNGROUNDED_FOR_THRESHOLD,ungroundedForAndFallingThreshold:t.CHARACTER.UNGROUNDED_FOR_AND_FALLING_THRESHOLD,withinClimbables:!1,withinClimbablesAbove:!1,withinStairs:!1,withinOneWay:!1,jumping:!1,jumpAscend:!1,climbing:!1,needsNewPath:!1,_jumpPushing:!1,_jumpWhileClimbing:!1,_jumpCounter:0,_canUseAdditionalJump:!1,_climbingIntentDown:!1,_climbingIntentUp:!1,_cleanIntentDown:!1,_cleanIntentUp:!1,_temporarilyInvulnerable:!1,_temporarilyInvulnerablePulsing:!1,_positionsPathfinding:{from:{x:.1,y:.1},target:{x:.1,y:.1}},_boundsPathfollow:{},initTypes:function(){this.parent();i.addType(ig.EntityExtended,this,"type","CHARACTER")},initProperties:function(){this.parent();this.regenTimer=new ig.Timer;this.damageTimer=new ig.Timer;this.pathingTimer=new ig.Timer;this.stuckTimer=new ig.Timer;this.abilities=this.abilitiesOriginal=new ig.Hierarchy},resetExtras:function(){this.parent();this.energyMax=this.energy;this.moveToStop();this.applyAntiVelocity();this.animAutomatic&&0<this.animsExpected.length&&(this._animsPlaceheld=!0,this.placeholdAnims())},placeholdAnims:function(){var t=this.anims,i;i=this.animInit instanceof ig.Animation?this.animInit:this.animInit&&t[this.animInit]?t[this.animInit]:t.idle||this.currentAnim;for(var e=0,s=this.animsExpected.length;e<s;e++){var n=this.animsExpected[e],a=t[n]||i;a&&(t[n+"X"]||(t[n+"X"]=a),t[n+"Right"]||(t[n+"Right"]=t[n+"X"]),t[n+"Left"]||(t[n+"Left"]=t[n+"X"]),t[n+"Y"]||(t[n+"Y"]=a),t[n+"Down"]||(t[n+"Down"]=t[n+"Y"]),t[n+"Up"]||(t[n+"Up"]=t[n+"Y"]))}},recordResetState:function(){this.parent();this.resetState.controllable=this.controllable;this.resetState.energy=this.energy},ready:function(){var t=this;this.abilities.forAllDescendants(function(){this.setEntity(t)});this.temporaryInvulnerability();this.removeControl();this.parent()},spawn:function(){this.parent();this.resetState.controllable&&this.addControl()},removeControl:function(){this.parent();this.moveToStop();this.jumpEnd();this.climbEnd()},pause:function(){this.parent();this.regenTimer.pause();this.damageTimer.pause();this.pathingTimer.pause();this.stuckTimer.pause();this.abilities.pause()},unpause:function(){this.parent();this.regenTimer.unpause();this.damageTimer.unpause();this.pathingTimer.unpause();this.stuckTimer.unpause();this.abilities.unpause()},setGrounded:function(i){t.TOP_DOWN?(this.standing=this.grounded=!0,this.falling=!1):(this.standing=this.grounded=this.hasGravity,this.falling=!1,!this.climbing&&!i&&(this.vel.y=this.slopeSticking&&this.hasGravity?this.maxVelGrounded.y:0))},setUngrounded:function(){t.TOP_DOWN||(this.grounded=this.standing=this.falling=!1)},moveTo:function(t,i){var e=this.parent(t,i);e&&(this.needsNewPath=!0,this.pathingTimer&&this.pathingTimer.set(0));return e},moveFrom:function(t,i){var e=this.moveTo(t,i);e&&(this.movingFrom=!0);return e},moveToUpdate:function(){if(this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC){if(this.movingTo)if(this.canPathfind){if(this.needsNewPath=this.movingTo.changed||this.changed||this.moveToUnsafe||this.needsNewPath,!this.movedTo||this.needsNewPath)this.findMoveToPath(),this.moveToPath()}else this.lookAt(this.movingTo)}else this.parent()},findMoveToPath:function(t){if(0<=this.pathingTimer.delta()&&(0===this.path.length||this.needsNewPath)){this.needsNewPath=this.movedTo=this.moveToUnsafe=!1;t=t||this.movingToSettings;var i,s,n,o,h,r;t&&(i=t.simple,s=t.avoidEntities,n=t.unsafe,o=t.avoidSlopes,h=t.searchDistance,r=t.alwaysKeepFirst);if(i){this.movingTo instanceof ig.EntityExtended?(i=ig.pathfinding.getPositionPathfindingEntities(this,this.movingTo,this._positionsPathfinding),t=i.from,h=i.target):(h=this.movingTo,t=a.getPositionPathfindingPoint(this,this.movingTo.x,this.movingTo.y,this._positionsPathfinding.from));i=h.x-t.x;h=h.y-t.y;this.movingFrom&&(i=-i,h=-h);0!==i&&(i=i*i<.25*this.size.x*this.size.x?0:e.direction(i));0!==h&&(h=h*h<.25*this.size.y*this.size.y?0:e.direction(h));if(this.hasGravity&&(0!==i&&(0!==h&&h*h<2*i*i)&&(h=0),!o)){var l=a.getEntityOnSmoothSlope(this,i);l&&0===h&&(h=a.getSlopeDirectionY(this,i))}(s=n||l?a.getNode(t.x,t.y,i,h):a.getWalkableNode(t.x,t.y,i,h,s,this))?this.path[0]=s:(this.clearPath(),this.moveToUnsafe=!0);this.pathingTimer.set(this.pathfindingSimpleDelay)}else this.path=this.movingFrom?this.movingTo instanceof ig.EntityExtended?a.getPathAwayFromEntity(this,this.movingTo,s,h):a.getPathAwayFromPoint(this,this.movingTo.x,this.movingTo.y,s,h):this.movingTo instanceof ig.EntityExtended?a.getPathToEntity(this,this.movingTo,s,h):a.getPathToPoint(this,this.movingTo.x,this.movingTo.y,s,h),0===this.path.length?(this.clearPath(),this.pathingTimer.set(this.pathfindingDelay)):(this.pathingTimer.set(this.pathfindingUpdateDelay),1<this.path.length&&!r&&(s=this.path[this.path.length-1],!s.corner||this._lastCornerNode===s?this.path.length--:(n=this.path[this.path.length-2],o=this.pos.x+.5*this.size.x,l=this.pos.y+.5*this.size.y,(s.x<o&&n.x>o||s.x>o&&n.x<o||s.y<l&&n.y>l||s.y>l&&n.y<l)&&this.path.length--,this.path.length&&this._lastNode!==this.path[this.path.length-1]&&(this._boundsPathfollow.ignoreCornerX=this._boundsPathfollow.ignoreCornerY=!1))))}},moveToPath:function(t,i){if(t=t||this.path)if(0===t.length||this.stuck&&0<=this.stuckTimer.delta())this.moveToComplete();else{this.changed?this.stuck=!1:this.stuck||(this.stuckTimer.set(this.stuckDelay),this.stuck=!0);i=i||this.movingToSettings;var e,n;i&&(e=i.unsafe,n=i.avoidUngrounded);var o=t.length,h=this._lastNode=t[o-1],r=h.x,l=h.y,g=this.size.x,u=this.size.y,c=this.pos.x,d=this.pos.y,p=a.getBoundsPathfollowing(c,d,g,u,h,!this.hasGravity,this._boundsPathfollow),m=Math.round(p.minX),y=Math.round(p.maxX),f=Math.round(p.minY),E=Math.round(p.maxY);if(h.corner?s.pointInAABB(r,l,m,f,y,E):this.jumping&&h.ungrounded&&1<o?c<=r&&c+g>=r:s.pointInAABB(r,l,c,d,c+g,d+u)){this._lastCornerNode=h.corner?h:null;this._boundsPathfollow.ignoreCornerX=this._boundsPathfollow.ignoreCornerY=!1;if(1===t.length)return this.moveToComplete();t.length--;return this.moveToPath(t)}g=p.width;u=p.height;o=Math.round(m+.5*g);u=Math.round(f+.5*u);if(this.hasGravity){m=m<=r&&y>=r;if(!this.jumping&&(f<=l&&E>=l?this.moveToHereVertical():u<l?(this.canClimb&&this.climbDown(),this.climbing||this.moveToDown()):u>l&&(this.moveToUnsafe=!e&&h.ungrounded,this.withinClimbables&&this.canClimb?(this.moveToUnsafe=!1,this.climbUp()):this.canJump&&(this.moveToUnsafe=!1,this.jump())),!e&&h.ungrounded&&(!h.oneWay||0<=h.oneWayFacing.y)&&n&&(this.grounded||this.climbing)))for(e=h.neighborMap.bottom;e&&!(e=e.neighborMap.bottom,!e.walkable||e.oneWay&&0>e.oneWayFacing.y);)if(e.y>this.pos.y+this.size.y){this.moveToUnsafe=!0;break}if(this.moveToUnsafe)return this.moveToComplete();if(m){if(this.moveToHereHorizontal(),this.jumping&&(!h.ungrounded||h.x===t[0].x))o<r?this.moveToRight():o>r&&this.moveToLeft()}else o<r?this.moveToRight():o>r&&this.moveToLeft()}else f<=l&&E>=l?this.moveToHereVertical():u<l?this.moveToDown():u>l&&this.moveToUp(),m<=r&&y>=r?this.moveToHereHorizontal():o<r?this.moveToRight():o>r&&this.moveToLeft()}},clearPath:function(){this.stuck=!1;0<this.path.length&&(this.path.length=0)},moveToLeft:function(t){this.accel.x=t?-this.speed.x*t:-this.speed.x;this.flip.x=this.canFlipX;this.moving&&(this.movingY||(this.facing.y=0),this.facing.x=-1)},moveToRight:function(t){this.accel.x=t?this.speed.x*t:this.speed.x;this.flip.x=!1;this.moving&&(this.movingY||(this.facing.y=0),this.facing.x=1)},moveToUp:function(i){this.accel.y=i?-this.speed.y*i:-this.speed.y;this.flip.y=this.canFlipY;if(this.moving&&(t.TOP_DOWN||this.canFlipY))this.movingX||(this.facing.x=0),this.facing.y=-1},moveToDown:function(i){this.accel.y=i?this.speed.y*i:this.speed.y;this.flip.y=!1;if(this.moving&&(t.TOP_DOWN||this.canFlipY))this.movingX||(this.facing.x=0),this.facing.y=1},moveToHereHorizontal:function(){this.accel.x=0},moveToHereVertical:function(){this.accel.y=0},moveToHere:function(){this.clearPath();this.moveToHereHorizontal();this.moveToHereVertical()},moveToSequenceNext:function(){this.movingToSequence&&(0<this.movingToSequence.length?this.movingFrom?(this.movingTo=null,this.movingFrom=!1,this.moveFrom(this.movingToSequence.shift(),this.movingToSettings)):(this.movingTo=null,this.moveTo(this.movingToSequence.shift(),this.movingToSettings)):(this.movingToSequence=void 0,this.moveToComplete(),this.moveToStop()))},moveToComplete:function(){this.pathingTimer&&this.pathingTimer.set(0);this.moveToHere();this.parent()},moveToStop:function(){this.moveToHere();this.movingFrom=!1;this.parent()},manageStart:function(){this.parent();this.moveToStop()},jump:function(){if(this.canJump&&(this.climbing&&(this._jumpWhileClimbing=!0,this.climbEnd()),this.canJumpRepeatedly&&(this._canUseAdditionalJump=this.additionalJumps>=this._jumpCounter),(this.grounded||this.canClimb&&this.withinClimbables||this.ungroundedFor<this.ungroundedForThreshold)&&!0!==this.jumping||this._canUseAdditionalJump))this.jumping=this._jumpPushing=!0,this.jumpStepsRemaining=this.jumpSteps,this._jumpCounter++},jumpUpdate:function(){!0===this.jumping&&(this._jumpPushing&&this.jumpPush(),0<=this.vel.y&&(this.jumpAscend=!1),!this._jumpPushing&&(!this.jumpAscend&&(this.grounded||this._jumpWhileClimbing&&this.withinClimbables))&&this.jumpEnd())},jumpPush:function(){0<this.jumpStepsRemaining&&(this.jumpStepsRemaining===this.jumpSteps&&(this.setUngrounded(),this.applyAntiVelocityY()),this.jumpAscend=!0,this.jumpStepsRemaining--,this.moveToUp(this.jumpForce),0>=this.jumpStepsRemaining&&(this._jumpPushing=!1,this.moveToHereVertical()))},jumpEnd:function(){this.jumping=this._jumpPushing=!1;this._jumpCounter=this.jumpStepsRemaining=0;this._canUseAdditionalJump=this.canJumpRepeatedly;this._jumpWhileClimbing&&(this._jumpWhileClimbing=!1,this.climb())},climb:function(){if(this.canClimb&&this.withinClimbables&&(this.jumping&&this.jumpEnd(),!0!==this.climbing&&(this._climbingIntentUp&&this.withinClimbablesAbove||this._climbingIntentDown&&!this.grounded)))this.setUngrounded(),this.climbing=!0,this.jumping||this.applyAntiVelocityY()},climbUp:function(){this._climbingIntentUp=!0;this._cleanIntentUp=!1;this.climb();this.climbing&&this.moveToUp()},climbDown:function(){this._climbingIntentDown=!0;this._cleanIntentDown=!1;this.climb();this.climbing&&this.moveToDown()},climbUpdate:function(){this.climbing&&(this.applyAntiGravity(),(!this.withinClimbables||this.grounded&&0<=this.vel.y)&&this.climbEnd());this._climbingIntentDown&&(this._cleanIntentDown=this._cleanIntentDown?this._climbingIntentDown=!1:!0);this._climbingIntentUp&&(this._cleanIntentUp=this._cleanIntentUp?this._climbingIntentUp=!1:!0)},climbEnd:function(){!1!==this.climbing&&(this.climbing=!1,!this.jumping&&0>this.vel.y&&this.applyAntiVelocityY())},receiveDamage:function(t,i,e){if((t=this.parent(t,i,e))&&!this._killed)this.explodingDamage&&this.explode(),e||this.temporaryInvulnerability();return t},explode:function(t){ig.game.spawnEntity(ig.EntityExplosion,this.pos.x,this.pos.y,ig.merge({size:{x:this.size.x,y:this.size.y}},t||this.damageSettings))},receiveHealing:function(t){this.health=Math.min(this.healthMax,this.health+t)},drainEnergy:function(t,i,e){return!this.invulnerable||e?(this.energy=Math.max(0,this.energy-t),!0):!1},receiveEnergy:function(t){this.energy=Math.min(this.energyMax,this.energy+t)},restoreStats:function(t){this.receiveHealing(this.healthMax-this.health,t);this.receiveEnergy(this.energyMax-this.energy,t)},regenerate:function(){this.regenHealth&&this.receiveHealing(this.regenRateHealth*(this.regenAsPctHealth?this.healthMax:1),this);this.regenEnergy&&this.receiveEnergy(this.regenRateEnergy*(this.regenAsPctEnergy?this.energyMax:1),this)},temporaryInvulnerability:function(t){"undefined"===typeof t&&(t=this.damageDelay);if(!this.invulnerable&&0<t&&(this.damageTimer.set(t),this.invulnerable=this._temporarilyInvulnerable=!0,1===this.alpha&&1>this.temporaryInvulnerabilityAlpha&&0<this.temporaryInvulnerabilityPulses)){this._temporarilyInvulnerablePulsing=!0;
var i=this.tween({alpha:this.temporaryInvulnerabilityAlpha},{name:"invulnerableHide",duration:1e3*t/(2*this.temporaryInvulnerabilityPulses),noComplete:!0,stopped:!0});t=this.tween({alpha:1},{name:"invulnerableShow",duration:1e3*t/(2*this.temporaryInvulnerabilityPulses),noComplete:!0,stopped:!0});i.chain(t);t.chain(i);i.start()}},temporaryInvulnerabilityEnd:function(){this._temporarilyInvulnerable&&(this._temporarilyInvulnerablePulsing&&(this.tweenEnd("invulnerableHide"),this.tweenEnd("invulnerableShow"),this._temporarilyInvulnerablePulsing=!1,this.alpha=1),this.invulnerable=this._temporarilyInvulnerable=!1)},kill:function(t){this.controllable=!1;this.parent(t)},die:function(){this.temporaryInvulnerabilityEnd();!this.dieingSilently&&this.explodingDeath&&this.explode(this.deathSettings);this.parent()},cleanup:function(){this.moveToUnsafe=!1;this._lastNode=this._lastCornerNode=null;this.parent()},cleanupCollision:function(){this.parent();this.withinOneWay=this.withinClimbables=this.withinClimbablesAbove=this.withinStairs=!1},intersectWith:function(t){this.parent();t.oneWay&&(this.withinOneWay=!0);t.climbable&&(this.withinClimbables=!0,this.withinStairs=t.climbableStairs,t.pos.y<Math.round(this.pos.y+.9*this.size.y)&&(this.withinClimbablesAbove=!0))},getIsCollidingWithOneWay:function(t){var i=this.parent(t);if(i&&t.climbable){if(this._climbingIntentDown&&0>t.oneWayFacing.y)return this.withinClimbables=!0,this.withinStairs=t.climbableStairs,this.grounded=!1,this.climbDown(),!1;if(this._climbingIntentUp&&0<t.oneWayFacing.y)return this.withinClimbables=this.withinClimbablesAbove=!0,this.withinStairs=t.climbableStairs,this.climbUp(),!1}return i},collideWith:function(t,i,e,s,n,a){this.parent(t,i,e,s,n,a);if(!a||this===a)0>e&&this.jumping&&this.jumpEnd(),this.changed&&this.updateVisible()},updateChanges:function(){this.parent();this._temporarilyInvulnerable&&(this.invulnerable&&0<=this.damageTimer.delta())&&this.temporaryInvulnerabilityEnd();this.regen&&0<=this.regenTimer.delta()&&(this.regenTimer.set(this.regenDelay),this.regenerate());this.abilities.update();this.jumpUpdate();this.climbUpdate();this.hasGravity&&!this.grounded&&!this.climbing?(this.ungroundedFor+=ig.system.tick,this.ungroundedFor>this.ungroundedForAndFallingThreshold&&(this.falling=!0)):this.ungroundedFor=0},updateVelocity:function(){var t;this.climbing?(n.copy(this.maxVel,this.maxVelClimbing),t=this.climbingControl):this.grounded?(n.copy(this.maxVel,this.maxVelGrounded),t=1):(n.copy(this.maxVel,this.maxVelUngrounded),t=this.jumpControl);this.standing||this.climbing?n.copy(this.friction,this.frictionGrounded):n.copy(this.friction,this.frictionUngrounded);this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x*t,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y*t,this.friction.y,this.maxVel.y)},updateVisible:function(){this.animAutomatic&&!this._killed&&this.updateCurrentAnim();this.parent()},updateCurrentAnim:function(){var t=this.anims;if(this.performance===ig.EntityExtended.PERFORMANCE.DYNAMIC){if(!0===this.climbing)if(this.withinStairs){if(this.moving)return this.currentAnim=t[this.getDirectionalAnimName("stairs")],!0}else return this.currentAnim=t[this.getDirectionalAnimName("climb")],this.currentAnim.stop=!this.moving,this.currentAnim.reverse=0<this.vel.y,!0;else if(!this.grounded){if(this.jumping)return t=t[this.getDirectionalAnimName("jump")],this.currentAnim!==t&&(this.currentAnim=t,this.currentAnim.playFromStart(!0)),!0;if(this.falling)return this.currentAnim=t[this.getDirectionalAnimName("fall")],!0}if(this.moving)return this.currentAnim=t[this.getDirectionalAnimName("move")],!0}t=t[this.getDirectionalAnimName("idle")];this.currentAnim!==t&&(this.currentAnim=t)&&this.currentAnim.playFromStart()}})});ig.baked=!0;ig.module("plusplus.abilities.ability").requires("plusplus.core.timer","plusplus.core.entity","plusplus.abstractities.particle","plusplus.helpers.utils","plusplus.helpers.utilsintersection","plusplus.helpers.signals").defines(function(){var t=ig.utils,i=ig.utilsintersection,e=0;ig.Ability=ig.Class.extend({id:e++,name:"",type:0,paused:!1,blocking:!0,priority:0,enabled:!0,entity:null,entityOptions:null,entityTarget:null,movable:!1,autoStopMoving:!0,once:!1,activated:!1,needsDeactivate:!1,activateToggle:!1,activateStrict:!0,channelled:!1,channelling:!1,costActivate:0,costChannel:0,cooldownDelay:0,cooldownTimer:null,castTimer:null,requiresTarget:!1,canFindTarget:!1,canTargetSelf:!0,canTargetOthers:!0,canTargetFixed:!1,rangeX:0,rangeY:0,typeTargetable:0,groupTargetable:0,faceTarget:!0,retainTarget:!1,regenBlocking:!0,rank:0,upgrades:[],casting:!1,activateCastSettings:null,activatePassCastSettings:null,activateSetupCastSettings:null,deactivateCastSettings:null,deactivateSetupCastSettings:null,failCastSettings:null,failReason:"",onActivated:null,onDeactivated:null,onFailed:null,_activating:!1,_deactivating:!1,_regenBlocked:!1,_entityTargetRetained:!1,init:function(i,s){this.id=e++;s&&!ig.global.wm&&("string"===typeof s.typeTargetable&&(t.addType(ig.EntityExtended,this,"typeTargetable",s.typeTargetable),delete s.typeTargetable),"string"===typeof s.groupTargetable&&(t.addType(ig.EntityExtended,this,"groupTargetable",s.groupTargetable,"GROUP"),delete s.groupTargetable),ig.merge(this,s));this.initTypes();this.initProperties();this.initUpgrades();this.setEntity(i)},initTypes:function(){},initProperties:function(){this.castTimer=new ig.Timer;this.cooldownTimer=new ig.Timer;this.onActivated=new ig.Signal;this.onDeactivated=new ig.Signal;this.onFailed=new ig.Signal},initUpgrades:function(){},activate:function(){if(this.enabled){if(this.activateToggle&&(this.needsDeactivate||this.activated))return this.deactivate.apply(this,arguments);if(!this._activating&&!this.channelling&&(this.activated=!1,this.assert(this.cooledDown(),ig.Ability.FAIL.COOLDOWN)))return this.activateSetup.apply(this,arguments)}},activatePlain:function(){return this.activate()},execute:function(){console.warn("DEPRECATED: ig.Ability.execute has been replaced by ig.Ability.activate, and ig.Ability.activate's previous functionality is now handled by ig.Ability.activateComplete.");return this.activate.apply(arguments,this)},activateSetup:function(){if(!this._activating)if(this.castEnd(),this._deactivating=!1,this.needsDeactivate=this._activating=!0,this.faceTarget&&this.entity.lookAt(this.entityTarget),this.activateSetupCastSettings)this.cast(this.activateSetupCastSettings,this.activateTry,arguments);else return this.activateTry.apply(this,arguments)},activateTry:function(){if(0===this.costActivate){if(this.assert(this.hasTarget(),ig.Ability.FAIL.TARGET)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))if(this.activatePassCastSettings)this.cast(this.activatePassCastSettings,this.activatePass,arguments);else return this.activatePass.apply(this,arguments)}else if(this.assert(this.hasTarget(),ig.Ability.FAIL.TARGET)&&this.assert(this.canPayCost(this.costActivate),ig.Ability.FAIL.COST)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))if(this.extractCost(this.costActivate),this.activatePassCastSettings)this.cast(this.activatePassCastSettings,this.activatePass,arguments);else return this.activatePass.apply(this,arguments)},activatePass:function(){if(!this.activatePassCastSettings||!this.activateStrict||this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))return this.activateComplete.apply(this,arguments)},activateComplete:function(){this._activating=this._deactivating=!1;this.needsDeactivate=!0;this.activated=this.once||this.channelled;this.onActivated.dispatch(this);0<this.cooldownDelay&&this.cooldownTimer.set(this.cooldownDelay);this.activateCastSettings?this.cast(this.activateCastSettings,this.channelled?this.channelTry:null):(this.castEnd(),this.channelled&&this.channelTry());this.dropEntityTarget()},deactivate:function(){return this.deactivateSetup.apply(this,arguments)},deactivateSetup:function(){if(this.needsDeactivate&&!this._deactivating)if(this._deactivating=!0,this.activated=this._activating=this.needsDeactivate=!1,this.channelling&&this.channelStop(),this.castEnd(),this.deactivateSetupCastSettings&&!this.entity._killed)this.cast(this.deactivateSetupCastSettings,this.deactivateComplete,arguments);else return this.deactivateComplete.apply(this,arguments)},deactivateComplete:function(){this._deactivating=!1;this.onDeactivated.dispatch(this);this.deactivateCastSettings&&!this.entity._killed?this.cast(this.deactivateCastSettings):this.castEnd();this.dropEntityTarget()},cleanup:function(){this.castEnd();var t=this.deactivateSetupCastSettings,i=this.deactivateCastSettings;this.deactivateCastSettings=this.deactivateSetupCastSettings=null;var e=this.deactivate.apply(this,arguments);this.deactivateSetupCastSettings=t;this.deactivateCastSettings=i;ig.game.hasLevel||(this.onActivated.removeAll(),this.onActivated.forget(),this.onDeactivated.removeAll(),this.onDeactivated.forget(),this.onFailed.removeAll(),this.onFailed.forget());return e},cleanupPlain:function(){return this.cleanup()},pause:function(){this.paused=!0;this.castTimer.pause();this.cooldownTimer.pause()},unpause:function(){this.paused=!1;this.castTimer.unpause();this.cooldownTimer.unpause()},setEnabled:function(t){"undefined"===typeof t&&(t=!0);t?this.enable():this.disable()},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1;if(this.needsDeactivate||this.activated)return this.deactivateSetup(arguments)},cooledDown:function(){return 0>=this.cooldownDelay||0<=this.cooldownTimer.delta()},cast:function(t,i,e){if(t){var s,n;t.async||(s=i,n=e);var a=t.animName;a&&!t.animOmniDirectional&&(a=this.entity.getDirectionalAnimName(a));var o=t.animSettings||{};if(a&&!t.delay&&(o.loop||(o.lock||o.stop)||o.frame&&this.entity.anims[a]&&this.entity.anims[a].stop))t.delay=1;if(t.delay)this.castStart(t,s,n),this.castTimer.set(t.delay),a&&("undefined"===typeof o.loop&&(o.loop=!0),this.entity.animOverride(a,o));else if(a){this.castStart(t,s,n);var h=o.callback,r=o.context;o.callback=function(){this.castComplete();h&&h.call(r||this)};o.context=this;this.entity.animOverride(a,o)}else this.castEffects(t.effects),s&&s.apply(this,n);t.async&&i&&i.apply(this,e)}else i&&i.apply(this,e)},castStart:function(t,i,e){this.castEnd();this.casting=!0;this.castSettings=t;this.castInternalCallback=i;this.castInternalArgs=e;this.autoStopMoving&&this.getInterrupted()&&this.entity.moveAllStop();this.castEffects(t.effects)},castUpdate:function(){this.castSettings&&this.castSettings.delay&&0<=this.castTimer.delta()?this.castComplete():this.failReason||this.assert(!this.getInterrupted(),ig.Ability.FAIL.INTERRUPT)},castComplete:function(){var t=this.castSettings,i=this.castInternalCallback,e=this.castInternalArgs;this.castEnd();this.failReason="";t&&t.callback&&t.callback.apply(t.context||this,t.settings);i&&i.apply(this,e)},castEnd:function(){if(this.casting||this.castSettings){this.casting=!1;if(this.castSettings){var t=this.castSettings.effects;if(t)for(var i=0,e=t.length;i<e;i++)this.effectEnd(t[i]);if(t=this.castSettings.animName)this.castSettings.animOmniDirectional||(t=this.entity.getDirectionalAnimName(t)),this.entity.animRelease(t,!0)}this.castSettings=this.castInternalCallback=this.castInternalArgs=void 0}},castEffects:function(t){if(t&&t.length)for(var i=0,e=t.length;i<e;i++)this.effectStart(t[i])},effectStart:function(t){var i=t.settings||{};if(!t.ignoreDuration){if(this.castSettings)if(this.castSettings.delay)i.lifeDuration=this.castSettings.delay;else if(this.castSettings.animName){var e=this.entity.anims[this.castSettings.animName];e&&(i.lifeDuration=e.frameTime*e.sequence.length)}t.fade&&(i.fadeBeforeDeathDuration=i.fadeBeforeDeathDuration||0)}if(!t.followTarget||this.entityTarget)i=t.entity=ig.game.spawnEntity(t.entityClass,0,0,i),t.followSettings?("undefined"===typeof t.followSettings.flipWith&&(t.followSettings.flipWith=!1),t.followTarget?this.entityTarget&&i.moveTo(this.entityTarget,t.followSettings):i.moveTo(this.entity,t.followSettings)):!1!==t.center&&(i.pos.x=this.entity.pos.x+.5*(this.entity.size.x-i.size.x),i.pos.y=this.entity.pos.y+.5*(this.entity.size.y-i.size.y))},effectEnd:function(t){if(t.entity&&!t.entity._killed&&(this.failReason===ig.Ability.FAIL.INTERRUPT||!(t.entity instanceof ig.Particle)))t.entity.kill(),t.entity=void 0},update:function(){this.enabled&&!this.paused&&(this.casting&&this.castUpdate(),this.activated&&this.channelled&&this.channelTry(arguments))},channelTry:function(t){!this.channelling&&(this.autoStopMoving&&this.getInterrupted())&&this.entity.moveAllStop();if(0===this.costChannel){if(this.assert(!this.getInterrupted(),ig.Ability.FAIL.INTERRUPT)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))return this.channel.apply(this,t)}else if(this.assert(this.canPayCost(this.costChannel),ig.Ability.FAIL.COST)&&this.assert(!this.getInterrupted(),ig.Ability.FAIL.INTERRUPT)&&this.assert(this.closeEnough(),ig.Ability.FAIL.DISTANCE))return this.extractCost(this.costChannel),this.channel.apply(this,t);return this.deactivate.apply(this,t)},channel:function(){!this.channelling&&this.regenBlocking&&(this.channelling=!0,this.blockRegen(this.entity));this.faceTarget&&this.entity.lookAt(this.entityTarget)},channelStop:function(){this.channelling=!1;this.unblockRegen(this.entity)},getUsing:function(){return this.casting||this.channelling},getActivelyUsing:function(){return this.activated||this.getUsing()},getInterrupted:function(){return this.entity.moving&&!(this.movable||this.castSettings&&this.castSettings.movable)},blockRegen:function(t){t.regenEnergy&&(this._regenBlocked=!0,t.regenEnergy=!1)},unblockRegen:function(t){this._regenBlocked&&(t.regenEnergy=!0,this._regenBlocked=!1)},setEntity:function(t){this.entity&&(this.entity.onRemoved.remove(this.cleanupPlain,this),this.entity.onAdded.remove(this.activatePlain,this),this.cleanup());if(this.entity=t)this.entity.onRemoved.add(this.cleanupPlain,this),this.type&ig.Ability.TYPE.PASSIVE&&(this.entity.added?this.activatePlain():this.entity.onAdded.addOnce(this.activatePlain,this))},setEntityOptions:function(t){this.entityOptions=t},setEntityTarget:function(t){if(!t||this.entityTarget!==t&&this.isEntityTargetable(t))this.entityTarget=t,this._entityTargetRetained=!1},isEntityTargetable:function(t){return(!t.fixed||this.canTargetFixed)&&(!this.typeTargetable||(t.type&this.typeTargetable)===this.typeTargetable&&!(this.entity.group&t.group))&&(!this.groupTargetable||(t.group&this.groupTargetable)===this.groupTargetable)&&(this.canTargetOthers&&this.entity!==t||this.canTargetSelf&&this.entity===t)},setEntityTargetFirst:function(t){if(t&&t.length)for(var i=0,e=t.length;i<e&&!(this.setEntityTarget(t[i]),this.entityTarget);i++);else this.setEntityTarget()},setClosestEntityTarget:function(){if(0<this.rangeX||0<this.rangeY){this.entityTarget&&this.setEntityTarget();var t=i.entitiesInAABB(this.entity.pos.x-this.rangeX,this.entity.pos.y-this.rangeY,this.entity.pos.x+this.entity.size.x+this.rangeX,this.entity.pos.y+this.entity.size.y+this.rangeY,!0);this.setEntityTargetFirst(t)}},dropEntityTarget:function(){this.entityTarget&&(this.isEntityTargetDroppable()?this.setEntityTarget():this._entityTargetRetained=!0)},isEntityTargetDroppable:function(){return!(this.activated&&this.channelled||this.retainTarget)},hasTarget:function(){return this.requiresTarget?(this.canFindTarget&&!this.entityTarget&&this.setClosestEntityTarget(),this.entityTarget?!0:!1):!0},hasValidTarget:function(){return!this.requiresTarget||this.entityTarget},closeEnough:function(){if(this.requiresTarget)if(this.entityTarget){var t=this.entityTarget.type&ig.EntityExtended.TYPE.INTERACTIVE;if(!(0===this.rangeX&&0===this.rangeY||t&&0===this.entityTarget.rangeInteractableX&&0===this.entityTarget.rangeInteractableY)){var e;t?(t=Math.max(this.rangeX,this.entityTarget.rangeInteractableX),e=Math.max(this.rangeY,this.entityTarget.rangeInteractableY)):(t=this.rangeX,e=this.rangeY);t=i.AABBIntersect(this.entityTarget.pos.x,this.entityTarget.pos.y,this.entityTarget.pos.x+this.entityTarget.size.x,this.entityTarget.pos.y+this.entityTarget.size.y,this.entity.pos.x-t,this.entity.pos.y-e,this.entity.pos.x+this.entity.size.x+t,this.entity.pos.y+this.entity.size.y+e);this.faceTarget&&this.entity.lookAt(this.entityTarget);return t}}else return!1;return!0},assert:function(t,i){t?this.failReason="":this.fail(i);return t},fail:function(t){this.failReason=t||ig.Ability.FAIL.UNKNOWN;this._activating=this._deactivating=!1;if(this.failReason===ig.Ability.FAIL.INTERRUPT)this.castEnd();else if(t=this.failCastSettings){if(t.effects)for(var i=0,e=t.effects.length;i<e;i++){var s=t.effects[i];s.settings=s.settings||{};s.settings.animInit=this.failReason}this.failCastSettings?this.cast(this.failCastSettings):this.castEnd()}this.onFailed.dispatch(this);this.dropEntityTarget()},canPayCost:function(t){return!this.entity.hasOwnProperty("energy")||this.entity.invulnerable||this.entity.energy>=t},extractCost:function(t){this.entity.drainEnergy&&this.entity.drainEnergy(t,this)},addUpgrades:function(i){t.arrayCautiousAddMulti(this.upgrades,i)},upgrade:function(i){!0===i?i=this.upgrades.length:t.isNumber(i)||(i=this.rank+1);this.changegrade(i)},downgrade:function(i){!0===i?i=0:t.isNumber(i)||(i=this.rank-1);this.changegrade(i)},changegrade:function(t){var i=this.upgrades.length,e=t<this.rank?-1:1,s=this.rank+e;for(this.rank!==t&&this.cleanup();this.rank!==t&&s<i&&0<=s;){this.rank=s;var n=this.upgrades[s],a=this.entity,o=this.entityOptions||a;"function"===typeof n?n.call(this,a,o):ig.merge(this,n);s+=e}},clone:function(t){!0!==t instanceof ig.Ability&&(t=new ig.Ability);t.name=this.name;t.type=this.type;t.enabled=this.enabled;t.costActivate=this.costActivate;t.costDeactivate=this.costDeactivate;t.costChannel=this.costChannel;t.requiresTarget=this.requiresTarget;t.canFindTarget=this.canFindTarget;t.canTargetSelf=this.canTargetSelf;t.canTargetOthers=this.canTargetOthers;t.typeTargetable=this.typeTargetable;t.rangeX=this.rangeX;t.rangeY=this.rangeY;t.retainTarget=this.retainTarget;t.rank=this.rank;t.upgrades=this.upgrades.slice(0);t.regenBlocking=this.regenBlocking;t.setEntityOptions(this.entityOptions);t.setEntity(this.entity);return t}});ig.Ability.TYPE;t.getType(ig.Ability,"PASSIVE");t.getType(ig.Ability,"SPAMMABLE");t.getType(ig.Ability,"TOGGLEABLE");ig.Ability.FAIL={UNKNOWN:"unknown",COST:"cost",TARGET:"target",DISTANCE:"distance",COOLDOWN:"cooldown",INTERRUPT:"interrupt"}});ig.baked=!0;ig.module("plusplus.abilities.interact").requires("plusplus.core.config","plusplus.abilities.ability","plusplus.helpers.utils").defines(function(){var t=ig.CONFIG,i=ig.utils;ig.AbilityInteract=ig.Ability.extend({rangeX:t.CHARACTER.SIZE_EFFECTIVE_X,rangeY:.5*t.CHARACTER.SIZE_EFFECTIVE_Y,requiresTarget:!0,canFindTarget:!1,canTargetSelf:!1,initTypes:function(){this.parent();i.addType(ig.Ability,this,"type","INTERACT");i.addType(ig.EntityExtended,this,"typeTargetable","INTERACTIVE")},activateComplete:function(){this.entityTarget.toggleActivate(this.entity);this.parent()}})});ig.baked=!0;ig.module("plusplus.abstractities.player").requires("plusplus.core.config","plusplus.abstractities.character","plusplus.abilities.interact","plusplus.helpers.utils","plusplus.helpers.utilsmath").defines(function(){var t=ig.utils;ig.Player=ig.Character.extend({name:"player",zIndex:ig.CONFIG.Z_INDEX_PLAYER,performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,collides:ig.EntityExtended.COLLIDES.LITE,persistent:!0,damageDelay:1,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","PLAYER DAMAGEABLE MIMICABLE");t.addType(ig.EntityExtended,this,"group","PLAYER FRIEND","GROUP")},initProperties:function(){this.parent();ig.global.wm||(this.abilityInteract=new ig.AbilityInteract(this),this.abilities.addDescendant(this.abilityInteract))},spawn:function(){this.parent();this.checkAutomaticUtilities()},checkAutomaticUtilities:function(){ig.game.playerManager&&(!ig.game.playerManager.entity&&ig.game.playerManager.autoManagePlayer)&&ig.game.playerManager.managePlayer();ig.game.camera&&(!ig.game.camera.entity&&ig.game.camera.autoFollowPlayer)&&ig.game.camera.followPlayer()},handleInput:function(){var t,i,e,s;if(!this.jumping&&ig.input.released("tap")){e=ig.input.getInputPoints(["tapped"],[!0]);t=0;for(i=e.length;t<i;t++)s=e[t],this.abilityInteract.setEntityTargetFirst(s.targets),this.abilityInteract.entityTarget&&(!(this.abilityInteract.entityTarget.type&ig.EntityExtended.TYPE.UI)||!this.abilityInteract.entityTarget.fixed)&&this.abilityInteract.activate()}}})});ig.baked=!0;ig.module("plusplus.abilities.ability-shoot").requires("plusplus.core.config","plusplus.core.input","plusplus.abilities.ability","plusplus.helpers.utilsmath").defines(function(){var t=ig.CONFIG,i=ig.utilsmath;ig.AbilityShoot=ig.Ability.extend({spawningEntity:"",movable:!0,spawnAtTarget:!1,shootLocationMinPctX:0,shootLocationMaxPctX:1,shootLocationMinPctY:t.TOP_DOWN?0:.5,shootLocationMaxPctY:t.TOP_DOWN?1:.5,offsetAccelX:0,offsetAccelY:0,offsetVelX:0,offsetVelY:0,relativeVelPctX:0,relativeVelPctY:0,activateCastSettings:{animName:"shoot"},activateComplete:function(t){var e=this.entityOptions||this.entity,s={group:this.entity.group};e.projectileSettings&&ig.merge(s,e.projectileSettings);var n,a,o,h,r;this.spawnAtTarget&&this.entityTarget?(e=this.entityTarget.pos.x,n=this.entityTarget.pos.y,a=this.entityTarget.size.x,o=this.entityTarget.size.y):(e=this.entity.pos.x,n=this.entity.pos.y,a=this.entity.size.x,o=this.entity.size.y);h=e+.5*a;r=n+.5*o;if(t){t.projectileSettings&&ig.merge(s,t.projectileSettings);var l=t.offsetX||0,g=t.offsetY||0,u,c,d;if(!l&&!g){var p,m;t instanceof ig.InputPoint?(p=t.worldX||0,m=t.worldY||0):(p=t.x||0,m=t.y||0);c=p-h;d=m-r;u=Math.sqrt(c*c+d*d)||1;l=.5*c/u*a;g=.5*d/u*o}this.spawnAtTarget&&!this.entityTarget&&(h=e=p,r=n=m,a=o=0);h+=l;r+=g;var y=p-h;if(!c||0>c&&0>y||0<c&&0<y)c=y;m-=r;if(!d||0>d&&0>m||0<d&&0<m)d=m;u=Math.sqrt(c*c+d*d)||1;y=c/u;u=d/u}h=i.clamp(h,e+a*this.shootLocationMinPctX,e+a*this.shootLocationMaxPctX);r=i.clamp(r,n+o*this.shootLocationMinPctY,n+o*this.shootLocationMaxPctY);s=ig.game.spawnEntity(this.spawningEntity,h,r,s);s.pos.x-=.5*s.size.x;s.pos.y-=.5*s.size.y;if(l){if(0<l&&0>s.vel.x||0>l&&0<s.vel.x)s.vel.x=-s.vel.x;this.offsetAccelX&&(s.accel.x+=this.offsetAccelX*(this.offsetAccelY?y:0>y?-1:1));this.offsetVelX&&(s.vel.x+=this.offsetVelX*(this.offsetVelY?y:0>y?-1:1))}if(g){if(0<g&&0>s.vel.y||0>g&&0<s.vel.y)s.vel.y=-s.vel.y;this.offsetAccelY&&(s.accel.y+=this.offsetAccelY*(this.offsetAccelX?u:0>u?-1:1));this.offsetVelY&&(s.vel.y+=this.offsetVelY*(this.offsetVelX?u:0>u?-1:1))}this.relativeVelPctX&&(s.vel.x+=this.entity.vel.x*this.relativeVelPctX);this.relativeVelPctY&&!this.entity.grounded&&(s.vel.y+=this.entity.vel.y*this.relativeVelPctY);this.faceTarget&&this.entity.lookAt(s);this.parent();return s},clone:function(t){!0!==t instanceof ig.AbilityShoot&&(t=new ig.AbilityShoot);t.spawningEntity=this.spawningEntity;return this.parent(t)}})});ig.baked=!0;ig.module("plusplus.abstractities.projectile").requires("plusplus.core.config","plusplus.abstractities.particle","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.Projectile=ig.Particle.extend({gravityFactor:.1,lifeDuration:4,fadeBeforeDeathDuration:0,randomVel:!1,randomDoubleVel:!1,randomFlip:!1,damage:1,damageAsPct:!1,damageUnblockable:!1,initProperties:function(){this.parent();t.addType(ig.EntityExtended,this,"checkAgainst","DAMAGEABLE")},check:function(t){this.parent(t);t.receiveDamage(this.damageAsPct?t.health*this.damage:this.damage,this,this.damageUnblockable);this.kill()}})});ig.baked=!0;ig.module("game.entities.grenade").requires("plusplus.abstractities.projectile","plusplus.core.config","plusplus.helpers.utils").defines(function(){ig.EntityGrenade=ig.global.EntityGrenade=ig.Projectile.extend({collides:ig.EntityExtended.COLLIDES.LITE,size:{x:8,y:8},offset:{x:4,y:4},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"grenade.png",16,16),animSettings:{moveX:{frameTime:.2,sequence:[0,1]},moveY:{frameTime:.2,sequence:[0,1]},deathX:{frameTime:.1,sequence:[2,3,4,5]},deathY:{frameTime:.1,sequence:[2,3,4,5]}},canFlipX:!0,canFlipY:!0,damage:10,lifeDuration:1,gravityFactor:.5,friction:{x:5,y:0}})});ig.baked=!0;ig.module("game.abilities.grenade-launcher").requires("plusplus.abilities.ability-shoot","game.entities.grenade","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.GrenadeLauncher=ig.AbilityShoot.extend({spawningEntity:ig.EntityGrenade,costActivate:4,offsetVelX:100,offsetVelY:100,relativeVelPctX:1,relativeVelPctY:1,shootLocationMinPctY:0,shootLocationMaxPctY:1,initTypes:function(){this.parent();t.addType(ig.Ability,this,"type","SPAMMABLE")}})});ig.baked=!0;ig.module("game.entities.laser").requires("plusplus.abstractities.projectile","plusplus.entities.explosion","plusplus.core.config","plusplus.helpers.utils").defines(function(){ig.EntityLaser=ig.global.EntityLaser=ig.Projectile.extend({collides:ig.EntityExtended.COLLIDES.LITE,size:{x:4,y:4},offset:{x:2,y:0},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"projectile.png",8,8),animSettings:{moveX:{frameTime:1,sequence:[0]},deathX:{frameTime:.05,sequence:[1,2,3,4,5]},moveY:{frameTime:1,sequence:[6]},deathY:{frameTime:.05,sequence:[7,8,9,10,11]}},canFlipX:!0,canFlipY:!0,damage:2,lifeDuration:.5,gravityFactor:0,friction:{x:0,y:0},bounciness:0,collisionKills:!0})});ig.baked=!0;ig.module("game.abilities.laser-gun").requires("plusplus.abilities.ability-shoot","game.entities.laser","plusplus.core.config","plusplus.helpers.utils").defines(function(){ig.LaserGun=ig.AbilityShoot.extend({spawningEntity:ig.EntityLaser,offsetVelX:500,offsetVelY:ig.CONFIG.TOP_DOWN?200:0})});ig.baked=!0;ig.module("plusplus.abilities.glow").requires("plusplus.abilities.ability","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.AbilityGlow=ig.Ability.extend({once:!0,activateToggle:!0,r:1,g:1,b:1,alpha:.25,fadeInDuration:125,fadeOutDuration:125,sizeMod:5,initTypes:function(){this.parent();t.addType(ig.Ability,this,"type","PASSIVE")},initUpgrades:function(){this.parent();this.addUpgrades([{sizeMod:this.sizeMod},{sizeMod:2*this.sizeMod}])},activateComplete:function(){var i=(this.entityOptions||this.entity).glowSettings||{};this.light=ig.game.spawnEntity(ig.EntityLight,this.entity.pos.x+.5*this.entity.size.x,this.entity.pos.y+.5*this.entity.size.y,ig.merge({radius:.5*Math.max(this.entity.getSizeDrawX(),this.entity.getSizeDrawY())*(i.sizeMod||this.sizeMod),r:t.isNumber(i.r)?i.r:this.r,g:t.isNumber(i.g)?i.g:this.g,b:t.isNumber(i.b)?i.b:this.b,alpha:t.isNumber(i.alpha)?i.alpha:this.alpha},i.light));this.light.added?this.showLight():this.light.onAdded.addOnce(this.showLight,this);this.parent();return this.light},showLight:function(){var i=(this.entityOptions||this.entity).glowSettings||{};this.light&&(this.light.moveTo(this.entity,{matchPerformance:!0}),this.light.alpha=0,this.light.fadeTo(this.light.resetState.alpha,{duration:t.isNumber(i.fadeInDuration)?i.fadeInDuration:this.fadeInDuration}))},deactivateComplete:function(){var i=this.light,e=(this.entityOptions||this.entity).glowSettings||{};this.light=void 0;i&&(i.onAdded.remove(this.showLight,this),i.fadeToDeath({duration:t.isNumber(e.fadeOutDuration)?e.fadeOutDuration:this.fadeOutDuration}));this.parent()},clone:function(t){!0!==t instanceof ig.AbilityGlow&&(t=new ig.AbilityGlow);t.r=this.r;t.g=this.g;t.b=this.b;t.alpha=this.alpha;t.fadeDuration=this.fadeDuration;t.sizeMod=this.sizeMod;return this.parent(t)}})});ig.baked=!0;ig.module("game.entities.player").requires("plusplus.abstractities.player","game.abilities.grenade-launcher","game.abilities.laser-gun","plusplus.abilities.glow","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.CONFIG,i=ig.utils;ig.EntityPlayer=ig.global.EntityPlayer=ig.Player.extend({size:{x:8,y:16},offset:{x:4,y:0},TYPE:"PLAYER",initTypes:function(){this.parent();i.addType(ig.EntityExtended,this,"group","FRIEND","GROUP")},animSheet:new ig.AnimationSheet(t.PATH_TO_MEDIA+"player.png",16,16),animInit:t.TOP_DOWN?"moveX":"idleX",animSettings:{idleX:{frameTime:1,sequence:t.TOP_DOWN?[21]:[0]},idleLeft:{frameTime:1,sequence:[20]},idleRight:{frameTime:1,sequence:[20]},idleY:{frameTime:1,sequence:[12]},idleUp:{frameTime:1,sequence:[20]},idleDown:{frameTime:1,sequence:[12]},jumpX:{frameTime:.1,sequence:[8,9]},fallX:{frameTime:.4,sequence:[6,7]},moveX:{frameTime:.07,sequence:t.TOP_DOWN?[21,22,23,22]:[0,1,2,3,4,5]},moveLeft:{frameTime:.07,sequence:[20,19]},moveRight:{frameTime:.07,sequence:[23,22]},moveY:{frameTime:.07,sequence:[12,13,14,13]},moveDown:{frameTime:.07,sequence:[12,13,14,13]},moveUp:{frameTime:.07,sequence:[15,16,17,16]},deathX:{frameTime:.1,sequence:t.TOP_DOWN?[29]:[10,11]},deathLeft:{frameTime:.1,sequence:[29]},deathRight:{frameTime:.1,sequence:[29]},deathY:{frameTime:.1,sequence:[28]},deathDown:{frameTime:.1,sequence:[28]},deathUp:{frameTime:.1,sequence:[28]}},health:6,energy:10,faceTarget:!1,regen:!0,regenHealth:!1,regenRateEnergy:.1,glowSettings:{light:{performance:ig.EntityExtended.PERFORMANCE.MOVABLE,castsShadows:!1}},initProperties:function(){this.parent();this.glow=new ig.AbilityGlow(this);this.shoot=new ig.LaserGun(this);this.abilities.addDescendants([this.glow,this.shoot])},check:function(t){console.log(t);ig.game.spawnEntity(EntityEffectElectricity,0,0,{size:{x:t.pos.x,y:t.pos.y}});this.parent(t)},handleInput:function(){var t,i;ig.input.pressed("shoot-left")&&(i=this.pos.y+.5*this.size.y,t=this.pos.x,this.shoot.activate({x:t,y:i}));ig.input.pressed("shoot-right")&&(i=this.pos.y+.5*this.size.y,t=this.pos.x+this.size.x,this.shoot.activate({x:t,y:i}));ig.input.pressed("shoot-up")&&(i=this.pos.y,t=this.pos.x+.5*this.size.x,this.shoot.activate({x:t,y:i}));ig.input.pressed("shoot-down")&&(i=this.pos.y+this.size.y,t=this.pos.x+.5*this.size.x,this.shoot.activate({x:t,y:i}));if(ig.input.state("swipe")){t=ig.input.getInputPoints(["swiping"],[!0]);i=0;for(var e=t.length;i<e;i++)t[i].swipingUp&&this.jump()}this.parent()}})});ig.baked=!0;ig.module("plusplus.abstractities.creature").requires("plusplus.core.config","plusplus.abstractities.character","plusplus.helpers.utils","plusplus.helpers.pathfinding").defines(function(){var t=ig.CONFIG,i=ig.utils,e=ig.pathfinding;ig.Creature=ig.Character.extend({performance:ig.EntityExtended.PERFORMANCE.DYNAMIC,collides:ig.EntityExtended.COLLIDES.LITE,reactionDistance:t.CREATURE.REACTION_DISTANCE,reactionDelay:t.CREATURE.REACTION_DELAY,reactionTimer:null,preyName:"",preyClass:null,preyType:ig.EntityExtended.TYPE.NONE,preyGroup:ig.EntityExtended.GROUP.NONE,prey:null,needsLineOfSightPrey:t.CREATURE.NEEDS_LINE_OF_SIGHT_PREY,detectHiddenPrey:t.CREATURE.DETECT_HIDDEN_PREY,moveToPreySettings:t.CREATURE.MOVE_TO_PREY_SETTINGS,predatorName:"",predatorClass:null,predatorType:ig.EntityExtended.TYPE.NONE,predatorGroup:ig.EntityExtended.GROUP.NONE,predatorFromDamage:t.CREATURE.PREDATOR_FROM_DAMAGE,canLearnPredators:t.CREATURE.CAN_LEARN_PREDATORS,predator:null,needsLineOfSightPredator:t.CREATURE.NEEDS_LINE_OF_SIGHT_PREDATOR,detectHiddenPredator:t.CREATURE.DETECT_HIDDEN_PREDATOR,moveToPredatorSettings:t.CREATURE.MOVE_TO_PREDATOR_SETTINGS,canFlee:t.CREATURE.CAN_FLEE,fleeHealthPct:t.CREATURE.FLEE_HEALTH_PCT,fleeing:!1,fleeingLowHealth:!1,tetherDistance:t.CREATURE.TETHER_DISTANCE,canBreakTether:t.CREATURE.CAN_BREAK_TETHER,tetherName:"",tetherToSpawner:t.CREATURE.TETHER_TO_SPAWNER,tethering:!1,entityTether:null,moveToTetherSettings:t.CREATURE.MOVE_TO_TETHER_SETTINGS,canWander:!0,canWanderX:t.CREATURE.CAN_WANDER_X,canWanderY:t.CREATURE.CAN_WANDER_Y,wanderSwitchChance:t.CREATURE.WANDER_SWITCH_CHANCE,wanderSwitchChanceStopped:t.CREATURE.WANDER_SWITCH_CHANCE_STOPPED,wandering:!1,wanderDirection:{x:0,y:0},wanderPos:{x:0,y:0},moveToWanderSettings:t.CREATURE.MOVE_TO_WANDER_SETTINGS,_preySearchSettings:{},_predatorSearchSettings:{},initTypes:function(){this.parent();i.addType(ig.EntityExtended,this,"type","CREATURE")},initProperties:function(){this.parent();
this.reactionTimer=new ig.Timer},resetCore:function(t,e,s){s&&!ig.global.wm&&(s.preyType&&(i.addType(ig.EntityExtended,this,"preyType",s.preyType),delete s.preyType),s.preyGroup&&(i.addType(ig.EntityExtended,this,"preyGroup",s.preyGroup,"GROUP"),delete s.preyGroup),s.predatorType&&(i.addType(ig.EntityExtended,this,"predatorType",s.predatorType),delete s.predatorType),s.predatorGroup&&(i.addType(ig.EntityExtended,this,"predatorGroup",s.predatorGroup,"GROUP"),delete s.predatorGroup));this.parent(t,e,s)},resetExtras:function(){this.wanderDirection.x=this.canWanderX?.5>Math.random()?-1:1:0;this.wanderDirection.y=this.canWanderY?.5>Math.random()?-1:1:0;var t=this._preySearchSettings,i=this._preySearchSettings;t.from=i.from=this;t.layerName=i.layerName=this.layerName;t.byDistance=i.byDistance=!0;t.distanceSquared=i.distanceSquared=this.reactionDistance*this.reactionDistance;t.lineOfSight=this.needsLineOfSightPrey;i.lineOfSight=this.needsLineOfSightPredator;t.nonHidden=this.detectHiddenPrey;i.nonHidden=this.detectHiddenPredator;this.parent()},spawn:function(){0<this.tetherDistance&&!this.entityTether&&(this.tetherName&&(this.entityTether=ig.game.getEntityByName(this.tetherName)),!this.entityTether&&this.tetherToSpawner&&(this.entityTether=this.spawner));this.parent()},pause:function(){this.parent();this.reactionTimer.pause()},unpause:function(){this.parent();this.reactionTimer.unpause()},findPredatorPrey:function(t){if(!this.tethering||this.canBreakTether){if(t||!this.prey)if(this.preyName){var i=ig.game.getEntityByName(this.preyName);if(i&&!i._killed&&(this.detectHiddenPrey||!i.hidden)&&this.distanceSquaredTo(i)<=this.reactionDistance*this.reactionDistance&&(!this.needsLineOfSightPrey||this.lineOfSight(i)))this.prey=i}else this.preyClass?this.prey=ig.game.getEntitiesByClass(this.preyClass,this._preySearchSettings)[0]:this.preyType?this.prey=ig.game.getEntitiesByType(this.preyType,this._preySearchSettings)[0]:this.preyGroup&&(this.prey=ig.game.getCharactersByGroup(this.preyGroup,this._preySearchSettings)[0]);if(t||!this.predator)if(this.predatorName){if((t=ig.game.getEntityByName(this.predatorName))&&!t._killed&&(this.detectHiddenPredator||!t.hidden)&&this.distanceSquaredTo(t)<=this.reactionDistance*this.reactionDistance&&(!this.needsLineOfSightPredator||this.lineOfSight(t)))this.predator=t}else this.predatorClass?this.predator=ig.game.getEntitiesByClass(this.predatorClass,this._predatorSearchSettings)[0]:this.predatorType?this.predator=ig.game.getEntitiesByType(this.predatorType,this._predatorSearchSettings)[0]:this.predatorGroup&&(this.predator=ig.game.getCharactersByGroup(this.predatorGroup,this._predatorSearchSettings)[0])}},removePrey:function(){if(this.prey){var t=this.prey;this.prey=null;this.moveToStop();this.abilities.forAllDescendants(function(){this.entityTarget===t&&this.deactivate()})}},removePredator:function(){if(this.predator){var t=this.predator;this.predator=null;this.fleeing=this.fleeingLowHealth=!1;this.moveToStop();this.abilities.forAllDescendants(function(){this.entityTarget===t&&this.deactivate()})}},clearPrey:function(){this.preyName="";this.preyClass=null;this.preyType=ig.EntityExtended.TYPE.NONE;this.preyGroup=ig.EntityExtended.GROUP.NONE;this.removePrey()},clearPredator:function(){this.predatorName="";this.predatorClass=null;this.predatorType=ig.EntityExtended.TYPE.NONE;this.predatorGroup=ig.EntityExtended.GROUP.NONE;this.removePredator()},attack:function(t){var i=Math.max(.25*this.size.x,.25*this.size.y,ig.game.collisionMap&&ig.game.collisionMap.tilesize||0);return this.distanceSquaredEdgeTo(t)<=i*i},flee:function(t,i){this.fleeing=!0;return this.moveFrom(t,i)},receiveDamage:function(t,i,e){t=this.parent(t,i,e);i&&!this._killed&&(this.canLearnPredators&&(this.predatorType|=i.type,this.predatorGroup|=i.group),this.predatorFromDamage&&this.health<this.healthMax*this.fleeHealthPct&&(this.fleeing=this.fleeingLowHealth=!0,this.predator=i));return t},receiveHealing:function(t,i){this.parent(t,i);this.fleeing&&this.health>=this.healthMax*this.fleeHealthPct&&this.removePredator()},cleanup:function(){this.removePrey();this.removePredator();this.tethering=this.wandering=this.fleeing=this.fleeingLowHealth=!1;this.parent()},updateChanges:function(){this.parent();0<=this.reactionTimer.delta()&&(this.reactionTimer.set(this.reactionDelay),this.findPredatorPrey());this.updatePrey();this.updatePredator();this.updateTether();this.updateWander()},updatePrey:function(){var t=this.prey;if(t&&!this.managed){if(t._killed||t.hidden&&!this.detectHiddenPrey||this.distanceSquaredTo(t)>this.reactionDistance*this.reactionDistance)return this.removePrey();!this.fleeing&&!this.fleeingLowHealth&&((this.attacking=this.attack(t))?this.moveToStop():this.moveTo(t,this.moveToPreySettings))}},updatePredator:function(){var t=this.predator;if(t&&!this.managed){if(t._killed||t.hidden&&!this.detectHiddenPredator||!this.fleeingLowHealth&&this.distanceSquaredTo(t)>this.reactionDistance*this.reactionDistance)return this.removePredator();this.canFlee&&this.flee(t,this.moveToPredatorSettings)}},updateTether:function(){if(0<this.tetherDistance&&!this.managed){var t=this.entityTether;if(t)if(this.tethering){var i=Math.min(ig.pathfinding.tilesize,this.size.x,this.size.y);this.distanceSquaredEdgeTo(this.entityTether)<=i*i?(this.tethering=!1,this.fleeing=this.fleeingLowHealth,this.moveToStop()):this.moveTo(t,this.moveToTetherSettings)}else if((!this.canBreakTether||!this.prey&&!this.predator)&&this.distanceSquaredEdgeTo(this.entityTether)>this.tetherDistance*this.tetherDistance)this.removePrey(),this.removePredator(),this.tethering=!0}},isSafeToWander:function(){return!this.tethering&&!this.prey&&!this.predator&&!this.managed&&!this.abilities.getUsing()},updateWander:function(){if((this.canWanderX||this.canWanderY)&&this.isSafeToWander()){this.wandering=!0;var t=0===this.wanderDirection.x&&0===this.wanderDirection.y?this.wanderSwitchChanceStopped:this.wanderSwitchChance;if(this.moveToUnsafe){this._wanderSwitchedHorizontal=!1;if(this.canWanderX&&(!this.canWanderY||.5>Math.random()))this._wanderSwitchedHorizontal=!0,this.wanderDirection.x=-this.wanderDirection.x||1;if(this.canWanderY&&(!this._wanderSwitchedHorizontal||.5>Math.random()))this.wanderDirection.y=-this.wanderDirection.y||1}else 0<t&&Math.random()<t?(t=Math.random(),this.canWanderX&&.5<t?this.wanderDirection.x=Math.round(2*t-1):this.canWanderY&&(this.wanderDirection.y=Math.round(2*t-1))):0<this.tetherDistance&&this.entityTether&&(this.canWanderX&&(t=this.entityTether.pos.x+.5*this.entityTether.size.x,t-this.tetherDistance>=this.pos.x?this.wanderDirection.x=1:t+this.tetherDistance<=this.pos.x+this.size.x&&(this.wanderDirection.x=-1)),this.canWanderY&&(t=this.entityTether.pos.y+.5*this.entityTether.size.y,t-this.tetherDistance>=this.pos.y?this.wanderDirection.y=1:t+this.tetherDistance<=this.pos.y+this.size.y&&(this.wanderDirection.y=-1)));0===this.wanderDirection.x&&0===this.wanderDirection.y?this.moveToStop():(this.wanderPos.x=e.getEntityNeighborPositionX(this.pos.x,this.size.x,this.wanderDirection.x),this.wanderPos.y=e.getEntityNeighborPositionY(this.pos.y,this.size.y,this.wanderDirection.y,!this.hasGravity),0===this.wanderDirection.x&&this.moveToHereHorizontal(),0===this.wanderDirection.y&&this.moveToHereVertical(),this.moveTo(this.wanderPos,this.moveToWanderSettings))}else this.wandering=!1}})});ig.baked=!0;ig.module("game.entities.spike").requires("plusplus.abstractities.creature","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntitySpike=ig.global.EntitySpike=ig.Creature.extend({size:{x:16,y:9},animSheet:new ig.AnimationSheet("media/spike.png",16,9),animInit:"idleX",animSettings:{idleX:{frameTime:.08,sequence:[0,1,2]},idleLeft:{frameTime:.08,sequence:[0,1,2]},idleRight:{frameTime:.08,sequence:[0,1,2]},moveX:{frameTime:.08,sequence:[0,1,2]},moveLeft:{frameTime:.08,sequence:[0,1,2]},moveRight:{frameTime:.08,sequence:[0,1,2]},idleY:{frameTime:.08,sequence:[0,1,2]},idleUp:{frameTime:.08,sequence:[0,1,2]},idleDown:{frameTime:.08,sequence:[0,1,2]},moveY:{frameTime:.08,sequence:[0,1,2]},moveUp:{frameTime:.08,sequence:[0,1,2]},moveDown:{frameTime:.08,sequence:[0,1,2]}},maxVelGrounded:{x:25,y:25},frictionGrounded:{x:800,y:800},speed:{x:100,y:100},health:10,deathSettings:{spawnCountMax:3,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.RED}},canJump:!1,canClimb:!1,canWanderX:!0,canWanderY:!1,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","DAMAGEABLE");t.addType(ig.EntityExtended,this,"group","ENEMY","GROUP");t.addType(ig.EntityExtended,this,"checkAgainst","CHARACTER")},check:function(t){this.parent(t);t.receiveDamage(10,this)}})});ig.baked=!0;ig.module("plusplus.ui.ui-interactive").requires("plusplus.ui.ui-element","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.UIInteractive=ig.global.UIInteractive=ig.UIElement.extend({targetable:!0,enabled:!0,onActivated:null,onDeactivated:null,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","INTERACTIVE")},initProperties:function(){this.parent();this.onActivated=new ig.Signal;this.onDeactivated=new ig.Signal},resetExtras:function(){this.parent();this.setEnabled(this.enabled)},setEnabled:function(t){t?this.enable():this.disable()},enable:function(){this.enabled=!0;this.animRelease(this.getDirectionalAnimName("disabled"))},disable:function(){this.activated&&this.deactivate();this.enabled=!1;this.animOverride(this.getDirectionalAnimName("disabled"),{lock:!0})},activate:function(t){this.enabled&&(this.activateComplete(t),this.parent(t))},deactivate:function(t){this.enabled&&(this.deactivateComplete(t),this.parent(t))},activateComplete:function(){this.onActivated.dispatch(this)},deactivateComplete:function(){this.onDeactivated.dispatch(this)},cleanup:function(){ig.game.hasLevel||(this.onActivated.removeAll(),this.onActivated.forget(),this.onDeactivated.removeAll(),this.onDeactivated.forget());this.parent()}})});ig.baked=!0;ig.module("plusplus.ui.ui-toggle").requires("plusplus.ui.ui-interactive").defines(function(){ig.UIToggle=ig.global.UIToggle=ig.UIInteractive.extend({activateComplete:function(t){this.parent(t);this.animOverride(this.getDirectionalAnimName("on"),{lock:!0})},deactivateComplete:function(t){this.parent(t);this.animRelease(this.getDirectionalAnimName("on"))}})});ig.baked=!0;ig.module("game.ui.ui-toggle-gfx-min").requires("plusplus.core.config","plusplus.ui.ui-toggle","plusplus.abilities.glow").defines(function(){ig.UIToggleGfxMin=ig.global.UIToggleGfxMin=ig.UIToggle.extend({size:{x:12,y:12},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"icons_performance.png",12,12),animSettings:{idleX:{frameTime:1,sequence:[0]},onX:{frameTime:1,sequence:[1]}},margin:{x:.02,y:.02},activateComplete:function(t){if(!this.activated){this.parent(t);ig.game.camera.removeAtmosphere(125);for(var i=ig.game.entities,e=0,s=i.length;e<s;e++)if(t=i[e],t.abilities){t=t.abilities.getDescendants();for(var n=0,a=t.length;n<a;n++){var o=t[n];o instanceof ig.AbilityGlow&&o.cleanup()}}(i=ig.game.getEntityByName("player"))&&i.onAdded.add(this.killPlayerLights,this)}},deactivateComplete:function(t){this.activated&&(this.parent(t),(t=ig.game.getEntityByName("player"))&&t.onAdded.remove(this.killPlayerLights,this))},killPlayerLights:function(){var t=ig.game.getEntityByName("player");if(t&&t.abilities)for(var t=t.abilities.getDescendants(),i=0,e=t.length;i<e;i++){var s=t[i];s instanceof ig.AbilityGlow&&s.cleanup()}}})});ig.baked=!0;ig.module("game.ui.ui-toggle-gfx-max").requires("plusplus.core.config","plusplus.ui.ui-toggle").defines(function(){ig.UIToggleGfxMax=ig.global.UIToggleGfxMax=ig.UIToggle.extend({size:{x:12,y:12},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"icons_performance.png",12,12),animSettings:{idleX:{frameTime:1,sequence:[2]},onX:{frameTime:1,sequence:[3]}},margin:{x:.02,y:.02},activateComplete:function(t){if(!this.activated){this.parent(t);ig.game.camera.addAtmosphere(125);for(var i=ig.game.entities,e=0,s=i.length;e<s;e++)if(t=i[e],t.abilities){t=t.abilities.getDescendants();for(var n=0,a=t.length;n<a;n++){var o=t[n];o instanceof ig.AbilityGlow&&o.activate()}}}},deactivateComplete:function(t){this.activated&&this.parent(t)}})});ig.baked=!0;ig.module("plusplus.ui.ui-toggle-pause").requires("plusplus.core.config","plusplus.ui.ui-toggle").defines(function(){ig.UITogglePause=ig.global.UITogglePause=ig.UIToggle.extend({size:{x:12,y:12},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"buttons_states.png",12,12),animSettings:{idleX:{sequence:[0],frameTime:1},onX:{sequence:[1],frameTime:1}},ready:function(){ig.game.onPaused.add(this.activate,this);ig.game.onUnpaused.add(this.deactivate,this);this.parent()},activateComplete:function(t){this.parent(t);ig.game.paused||ig.game.pause()},deactivateComplete:function(t){this.parent(t);ig.game.paused&&ig.game.unpause()},cleanup:function(){ig.game.onPaused.remove(this.activate,this);ig.game.onUnpaused.remove(this.deactivate,this);this.parent()}})});ig.baked=!0;ig.module("plusplus.ui.ui-text-bubble").requires("plusplus.core.config","plusplus.ui.ui-overlay","plusplus.helpers.utilsvector2","plusplus.helpers.utilsdraw","plusplus.helpers.utilsintersection").defines(function(){var t=ig.CONFIG,i=ig.utilsvector2,e=ig.utilsdraw;ig.UITextBubble=ig.global.UITextBubble=ig.UIOverlay.extend({layerName:"ui",size:{x:t.TEXT_BUBBLE.SIZE_X,y:t.TEXT_BUBBLE.SIZE_Y},sizeAsPct:t.TEXT_BUBBLE.SIZE_AS_PCT,sizePct:{x:t.TEXT_BUBBLE.SIZE_PCT_X,y:t.TEXT_BUBBLE.SIZE_PCT_Y},cornerRadius:t.TEXT_BUBBLE.CORNER_RADIUS,cornerRadiusAsPct:t.TEXT_BUBBLE.CORNER_RADIUS_AS_PCT,r:t.TEXT_BUBBLE.R,g:t.TEXT_BUBBLE.G,b:t.TEXT_BUBBLE.B,alpha:t.TEXT_BUBBLE.ALPHA,pixelPerfect:t.TEXT_BUBBLE.PIXEL_PERFECT,shrinkToText:t.TEXT_BUBBLE.SHRINK_TO_TEXT,triangleLength:t.TEXT_BUBBLE.TRIANGLE_LENGTH,triangleWidth:t.TEXT_BUBBLE.TRIANGLE_WIDTH,padding:{x:t.TEXT_BUBBLE.PADDING_X,y:t.TEXT_BUBBLE.PADDING_Y},resetExtras:function(){this.textSettings&&(this.textSettings.font=this.textSettings.font||ig.Font.FONTS.CHAT,this.textSettings.margin={x:0,y:this.padding.y-this.triangleLength},this.textSettings.marginAsPct=!1);this.textMoveToSettings=ig.merge(this.textMoveToSettings,{offset:{x:0,y:this.padding.y-this.triangleLength}});this.sizeAsPct||(this.resetState.size=this.resetState.size||{x:0,y:0},i.copy(this.resetState.size,this.size));this.parent()},recordResetState:function(){this.parent();this.resetState.size=this.resetState.size||{x:0,y:0};i.copy(this.resetState.size,this.size);this.resetState.sizePct=this.resetState.sizePct||{x:0,y:0};i.copy(this.resetState.sizePct,this.sizePct)},refresh:function(t){this.sizeAsPct||i.copy(this.size,this.resetState.size);this.message&&(this.message.added&&this.added)&&(this.message.maxWidth=this.message.maxHeight=0,this.message.refresh(t));this.parent(t);this.message&&this.message.linkedTo!==this&&this.message.refresh(t)},resize:function(t){t=this.parent(t);if(this.message){var i=this.message.scale/this.scale,e=this.getSizeDrawX()-2*this.padding.x,s=this.getSizeDrawY()-2*this.padding.y-this.triangleLength,n=this.message.getSizeDrawX()*i;n>e&&(this.message.maxWidth=e*(1/i),this.message.resize(!0),n=this.message.getSizeDrawX()*i);var a=this.message.getSizeDrawY()*i;a>s&&(this.message.maxHeight=s*(1/i),this.message.resize(!0),a=this.message.getSizeDrawY()*i);this.shrinkToText&&(n<e&&(this.size.x=n+2*this.padding.x,t=this.needsRebuild=!0),a<s&&(this.size.y=a+2*this.padding.y+this.triangleLength,t=this.needsRebuild=!0))}return t},refill:function(){if(this.fill&&0<this.triangleLength){var t=this.triangleLength,i=this.triangleWidth,s=this.sizeDraw.x,n=this.sizeDraw.y-t;this.parent(s,n);this.pixelPerfect||(s*=this.scale,n*=this.scale,t*=this.scale,i*=this.scale);t=[{x:.5*s-.5*i,y:n},{x:.5*s+.5*i,y:n},{x:.5*s,y:n+t}];i=this.fill.dataContext;this.pixelPerfect?e.pixelFillPolygon(i,0,0,this.fill.width,this.fill.height,t,this.r,this.g,this.b,this.alpha):(i.fillStyle=this.getFillStyle(),e.fillPolygon(i,t))}else this.parent()}})});ig.baked=!0;ig.module("plusplus.entities.conversation").requires("plusplus.core.timer","plusplus.ui.ui-text","plusplus.ui.ui-text-bubble","plusplus.entities.trigger","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityConversation=ig.global.EntityConversation=ig.EntityTrigger.extend({_wmBoxColor:"rgba(200, 200, 200, 0.7)",steps:{},stepsSorted:[],stepsUnused:[],stepsUsed:[],step:null,message:null,messageEntity:ig.UIText,messageContainer:null,messageContainerEntity:ig.UITextBubble,messageSettings:{},messageFollowsSpeaker:!0,messageMoveToSettings:{matchPerformance:!0,offsetPct:{x:0,y:-1.3}},speaker:null,speakerLast:null,participate:{},participating:[],looking:!0,pausing:!1,locking:!1,lockingPlayer:!1,interrupting:!0,animNameTalk:"talk",animNameListen:"listen",cameraFollows:!0,cameraCentered:!1,autoAdvance:!0,advanceTimer:null,durationPerLetter:.1,durationPerStepMin:1,action:"tap",triggerAfterDelay:!0,autoComplete:!1,_order:0,_step:null,_speakersModified:[],_cameraWasFollowing:null,initProperties:function(){this.parent();this.advanceTimer=new ig.Timer},resetExtras:function(){this.stepsSorted.length=0;for(var i in this.steps){var e=this.steps[i],s=parseInt(e.order);t.isNumber(s)||(s=e.order=parseInt(i));t.isNumber(s)?s>this._order&&(this._order=s):e.order=++this._order;this._addStep(e)}this.parent()},addStep:function(i,e,s,n){i&&0<i.length&&(t.isNumber(s)?s>this._order&&(this._order=s):s=++this._order,i=this.steps[s]={name:e,text:i,order:s,settings:n},this._addStep(i))},_addStep:function(t){this.stepsSorted.push(t);this.stepsSorted.sort(function(t,i){return t.order-i.order});this.activated&&(this._addUnusedStep(t),this.stepsUnused.sort(function(t,i){return t.order-i.order}))},setup:function(){var i,e;this.pausing&&!this.action&&(this.pausing=!1,this.autoAdvance=!0);if(this.interrupting){var s={};i=0;for(e=this.stepsSorted.length;i<e;i++){var n=ig.game.namedEntities[this.stepsSorted[i].name];if((n=n&&n.conversation)&&n!==this&&!s[n.id]&&n instanceof ig.EntityConversation&&n.activated)s[n.id]=!0,n.deactivate()}}this.pausing&&(ig.game.pause(!0),ig.game.camera&&ig.game.camera.unpause(),this.unpause());this.lockingPlayer&&(i=ig.game.getPlayer())&&i.removeControl();i=this.stepsUnused.length=this.stepsUsed.length=this.participating.length=this._speakersModified.length=0;for(e=this.stepsSorted.length;i<e;i++)this._addUnusedStep(this.stepsSorted[i]);this._speakersModified.length=0;for(var a in this.participate)(i=ig.game.namedEntities[this.participate[a]])&&t.arrayCautiousAdd(this.participating,i);this.nextStep();this.parent()},teardown:function(){this.hideStep();this.speakerLast=null;this.stepsUnused.length=this.stepsUsed.length=this.participating.length=this._speakersModified.length=0;for(var i in this.steps){var e=this.steps[i],s=ig.game.namedEntities[e.name];s&&-1===t.indexOfValue(this._speakersModified,e.name)&&(this._speakersModified.push(e.name),s.conversation=void 0,(e.locking||this.locking)&&s.addControl(),s.animRelease(s.getDirectionalAnimName(e.animNameTalk||this.animNameTalk)),s.animRelease(s.getDirectionalAnimName(e.animNameListen||this.animNameListen)))}this._speakersModified.length=0;ig.game.camera&&(ig.game.camera.onTransitioned.remove(this.complete,this),this._cameraWasFollowing=null);this.lockingPlayer&&(i=ig.game.getPlayer())&&i.addControl();this.pausing&&ig.game.unpause(!0);this.parent()},_addUnusedStep:function(i){this.stepsUnused.push(i);var e=i.name,s=ig.game.namedEntities[e];if(s&&-1===t.indexOfValue(this._speakersModified,i.name)&&(this._speakersModified.push(e),this.participating.push(s),s.conversation=this,this.pausing&&s.unpause(),i.locking||this.locking))s.removeControl(),(i="undefined"!==typeof i.animNameListen?i.animNameListen:this.animNameListen)&&s.animOverride(s.getDirectionalAnimName(i),{loop:!0})},nextStep:function(){this.hideStep();if(0<this.stepsUnused.length)if(this._step=this.stepsUnused.shift(),this.stepsUsed.push(this._step),this._step.name){if(this.speaker=ig.game.namedEntities[this._step.name]){var t=this._step.locking||this.locking;if(t){var i;(i="undefined"!==typeof this._step.animNameTalk?this._step.animNameTalk:this.animNameTalk)&&this.speaker.animOverride(this.speaker.getDirectionalAnimName(i),{loop:!0})}if(this.looking){i=0;for(var e=this.participating.length;i<e;i++){var s=this.participating[i];s!==this.speaker&&s.lookAt(this.speaker)}}(this.pausing||this.lockingPlayer||t)&&ig.game.camera&&this.cameraFollows&&this.speaker!==this.speakerLast?(this._cameraWasFollowing||(this._cameraWasFollowing=ig.game.camera.entity),this._cameraFollowing=this.speaker,ig.game.camera.onTransitioned.addOnce(this.showStep,this),ig.game.camera.follow(this.speaker,!1,this.cameraCentered)):this.showStep()}}else this.showStep();else ig.game.camera&&this.cameraFollows&&this._cameraWasFollowing?(ig.game.camera.onTransitioned.addOnce(this.complete,this),ig.game.camera.follow(this._cameraWasFollowing,!1,!0),this._cameraWasFollowing=null):this.complete()},showStep:function(){if(this._step&&this._step.text){var t=this.messageSettings;this.speaker&&this.messageFollowsSpeaker&&(t.fixed=t.fixed||!1);this.messageContainerEntity?(t.textSettings={text:this._step.text},t=this.messageContainer=ig.game.spawnEntity(this.messageContainer||this.messageContainerEntity,0,0,ig.merge(t,this._step.settings))):(t.text=this._step.text,t=this.message=ig.game.spawnEntity(this.message||this.messageEntity,0,0,ig.merge(t,this._step.settings)));t.added?this.activateStep():t.onAdded.addOnce(this.activateStep,this)}else this.activateStep()},activateStep:function(){if(this._step){this.step=this._step;this._step=void 0;var t,i;this.messageContainer?(t=this.messageContainer,i=this.message=t.message):t=i=this.message;if(i){if(i.textOverflow){var e=i.textOverflow;i.text=i.textDisplay||i.text;i.textOverflow="";var s=ig.merge({},this.step);this.step.text=i.text;s.text=e;this._addStep(s)}if(this.speaker&&this.messageFollowsSpeaker&&(t.unpause(),t.moveTo(this.speaker,this.messageMoveToSettings),(this.pausing||this.locking||this.lockingPlayer||this.step.locking)&&ig.game.camera&&this.cameraFollows&&!t.fixed))this._cameraWasFollowing||(this._cameraWasFollowing=ig.game.camera.entity),this._cameraFollowing=t,ig.game.camera.follow(t,!1,this.cameraCentered);this.autoAdvance&&this.advanceTimer.set(Math.max(this.step.text.length*this.durationPerLetter,this.durationPerStepMin))}else this.advanceTimer.set(this.durationPerStepMin)}},hideStep:function(){this.messageContainer&&(this.messageContainer.onAdded.remove(this.activateStep,this),this.messageContainer._killed||ig.game.removeEntity(this.messageContainer),this.messageContainer=null);this.message&&(this.message.onAdded.remove(this.activateStep,this),this.message._killed||ig.game.removeEntity(this.message),this.message=null);if(this.speaker){if(0<this.stepsUnused.length){if(this.locking||this.step&&this.step.locking){var t;(t=this.step&&"undefined"!==typeof this.step.animNameListen?this.step.animNameListen:this.animNameListen)&&this.speaker.animOverride(this.speaker.getDirectionalAnimName(t),{loop:!0})}this.speakerLast=this.speaker}else this.speaker.animRelease(this.speaker.getDirectionalAnimName(this.step.animNameTalk||this.animNameTalk)),this.speaker.animRelease(this.speaker.getDirectionalAnimName(this.step.animNameListen||this.animNameListen));this.speaker=null}ig.game.camera&&this.cameraFollows&&(ig.game.camera.onTransitioned.remove(this.showStep,this),ig.game.camera&&(this._cameraFollowing&&ig.game.camera.entity===this._cameraFollowing)&&ig.game.camera.unfollow(),this._cameraFollowing=null);this.step=this._step=null},pause:function(){this.parent();this.advanceTimer.pause()},unpause:function(){this.parent();this.advanceTimer.unpause()},update:function(){this.step&&(this.speaker&&this.speaker._killed?this.nextStep():(this.autoAdvance||this.step&&!this.step.text)&&0<=this.advanceTimer.delta()?this.nextStep():ig.input.released(this.action)&&this.nextStep());this.parent()}})});ig.baked=!0;ig.module("plusplus.entities.pain").requires("plusplus.entities.trigger","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityPain=ig.global.EntityPain=ig.EntityTrigger.extend({_wmBoxColor:"rgba( 255, 0, 100, 0.7 )",damage:1,damageAsPct:!1,damageUnblockable:!1,once:!1,suicidal:!1,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","DANGEROUS");t.addType(ig.EntityExtended,this,"checkAgainst","CHARACTER")},activate:function(t){this.parent(t);t.receiveDamage(this.damageAsPct?t.health*this.damage:this.damage,this,this.damageUnblockable)}})});ig.baked=!0;ig.module("plusplus.entities.pain-instagib").requires("plusplus.entities.pain").defines(function(){ig.EntityPainInstagib=ig.global.EntityPainInstagib=ig.EntityPain.extend({damageAsPct:!0,damageUnblockable:!0})});ig.baked=!0;ig.module("plusplus.entities.lava").requires("plusplus.core.config","plusplus.entities.pain-instagib").defines(function(){ig.EntityLava=ig.global.EntityLava=ig.EntityPainInstagib.extend({_wmDrawBox:!1,frozen:!1,textured:!0,animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"texture_lava.png",16,16),animSettings:!0,animFrameTime:.25,animSequenceCount:2,animationTypes:"SOLID SURFACE TOPRIGHT TOPRIGHTROUND TOPLEFT TOPLEFTROUND BOTTOMRIGHT BOTTOMRIGHTROUND BOTTOMLEFT BOTTOMLEFTROUND".split(" ")})});ig.baked=!0;ig.module("game.entities.torch").requires("plusplus.abstractities.character","plusplus.abilities.glow","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.CONFIG;ig.EntityTorch=ig.global.EntityTorch=ig.Character.extend({size:{x:8,y:8},collides:ig.EntityExtended.COLLIDES.NEVER,performance:ig.EntityExtended.PERFORMANCE.STATIC,animSheet:new ig.AnimationSheet("media/torch.png",8,8),animInit:"idleX",animSettings:{idleX:{frameTime:1,sequence:t.TOP_DOWN?[3]:[0]},onX:{frameTime:.1,sequence:t.TOP_DOWN?[4,5]:[1,2]}},canFlipX:!0,canFlipY:!1,invulnerable:!0,glowSettings:{sizeMod:12,light:{r:1,g:.85,b:.7,castsShadows:!0}},initProperties:function(){this.parent();this.abilities.addDescendant(new ig.TorchGlow(this))}});ig.TorchGlow=ig.AbilityGlow.extend({activateComplete:function(){this.entity.animOverride(this.entity.getDirectionalAnimName("on"),{loop:!0});this.parent()},deactivateComplete:function(){this.entity.animRelease(this.entity.getDirectionalAnimName("on"));this.parent()}})});ig.baked=!0;ig.module("plusplus.entities.checkpoint").requires("plusplus.core.config","plusplus.abstractities.spawner","plusplus.abstractities.character","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityCheckpoint=ig.global.EntityCheckpoint=ig.Spawner.extend({_wmBoxColor:"rgba( 0, 255, 125, 0.7 )",triggerable:!0,triggerAfterDelay:!1,restorative:!1,restorativeSpawn:!0,showSpawn:!0,respawnDelay:1,wait:1,duration:-1,once:!1,suicidal:!1,spawnAtRandomPosition:!1,spawnAtSide:ig.CONFIG.TOP_DOWN?null:{x:0,y:1},initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"type","CHECKPOINT")},activate:function(t){this.parent(t);t instanceof ig.Character&&(this.linkSpawned(t),this.restorative&&t.restoreStats(this))},spawned:function(t){this.parent(t);this.restorativeSpawn&&t.restoreStats(this)}})});ig.baked=!0;ig.module("plusplus.abilities.ability-damage").requires("plusplus.core.entity","plusplus.abilities.ability","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.AbilityDamage=ig.Ability.extend({damage:1,damageAsPct:!1,damageUnblockable:!1,requiresTarget:!0,canTargetSelf:!1,initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"typeTargetable","DAMAGEABLE")},activateComplete:function(){this.entityTarget.receiveDamage(this.damageAsPct?this.entityTarget.health*this.damage:this.damage,this.entity,this.damageUnblockable);this.parent()},clone:function(t){!0!==t instanceof ig.AbilityDamage&&(t=new ig.AbilityDamage);t.damage=this.damage;t.damageAsPct=this.damageAsPct;t.damageUnblockable=this.damageUnblockable;return this.parent(t)}})});ig.baked=!0;ig.module("plusplus.abstractities.effect").requires("plusplus.abstractities.particle").defines(function(){ig.Effect=ig.Particle.extend({fadeAfterSpawnDuration:0,fadeBeforeDeathDuration:0,randomVel:!1,randomDoubleVel:!1,randomFlip:!1})});ig.baked=!0;ig.module("plusplus.entities.effect-pow").requires("plusplus.core.config","plusplus.abstractities.effect").defines(function(){ig.EntityEffectPow=ig.global.EntityEffectPow=ig.Effect.extend({performance:ig.EntityExtended.PERFORMANCE.STATIC,size:{x:8,y:8},animAutomatic:!1,animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"effect_pow.png",8,8),animSettings:{moveX:{sequence:[0,1],frameTime:.125}},lifeDuration:.25,fadeBeforeDeathDuration:.05})});ig.baked=!0;ig.module("plusplus.abilities.melee").requires("plusplus.core.config","plusplus.abilities.ability-damage","plusplus.entities.effect-pow","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.AbilityMelee=ig.AbilityDamage.extend({movable:!0,cooldownDelay:.2,rangeX:1.5*ig.CONFIG.CHARACTER.SIZE_EFFECTIVE_X,canFindTarget:!0,activateSetupCastSettings:{animName:"melee",async:!0},activateCastSettings:{effects:[{entityClass:ig.EntityEffectPow,ignoreDuration:!0,followTarget:!0,followSettings:{matchPerformance:!0,randomOffsetPct:{x:.2,y:.2}}}]},initTypes:function(){this.parent();t.addType(ig.Ability,this,"type","SPAMMABLE")},clone:function(t){!0!==t instanceof ig.AbilityMelee&&(t=new ig.AbilityMelee);return this.parent(t)}})});ig.baked=!0;ig.module("game.entities.ghost").requires("plusplus.abstractities.creature","plusplus.abilities.melee","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityGhost=ig.global.EntityGhost=ig.Creature.extend({size:{x:12,y:12},offset:{x:2,y:2},collides:ig.EntityExtended.COLLIDES.NEVER,animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"ghost.png",16,16),animInit:"idle",animSettings:{idle:{frameTime:1,sequence:[0]},move:{frameTime:1,sequence:[0]},melee:{frameTime:.1,sequence:[3,3,3,2,1]}},animsExpected:["idle","move","melee"],canFlipX:!0,canFlipY:!1,gravityFactor:0,maxVelGrounded:{x:25,y:25},maxVelUngrounded:{x:25,y:25},frictionGrounded:{x:800,y:800},frictionUngrounded:{x:800,y:800},speed:{x:100,y:100},canJump:!1,canClimb:!1,invulnerable:!0,canWanderX:!0,canWanderY:!0,wanderSwitchChance:.005,wanderSwitchChanceStopped:.015,tetherDistance:50,reactionDistance:75,moveToPreySettings:{searchDistance:150},initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"group","ENEMY","GROUP");t.addType(ig.EntityExtended,this,"preyGroup","FRIEND","GROUP")},initProperties:function(){this.parent();this.melee=new ig.AbilityMelee(this,{canFindTarget:!1,damage:10,rangeX:.5*this.size.x});this.abilities.addDescendants([this.melee])},attack:function(t){this.melee.setEntityTarget(t);return this.melee.entityTarget?(t=this.melee.closeEnough(),this.melee.activate(),t):this.parent()}})});ig.baked=!0;ig.module("plusplus.entities.void").requires("plusplus.core.entity").defines(function(){ig.EntityVoid=ig.global.EntityVoid=ig.EntityExtended.extend({_wmScalable:!0,_wmDrawBox:!0,_wmBoxColor:"rgba(100, 100, 100, 0.7)",frozen:!0,update:function(){}})});ig.baked=!0;ig.module("game.levels.side-scrolling").requires("impact.image","plusplus.entities.conversation","plusplus.entities.lava","game.entities.torch","plusplus.entities.checkpoint","game.entities.ghost","plusplus.entities.void","game.entities.spike","game.entities.player").defines(function(){LevelSideScrolling={entities:[{type:"EntityConversation",x:104,y:160,settings:{delay:1,pausing:"true",steps:{1:{name:"player",text:"welcome to the impact++ demo"},2:{name:"player",text:"this demo can be switched to top-down mode (see config)"},3:{name:"player",text:"wasd, arrows, or tap hold to move"},4:{name:"player",text:"space or swipe up to jump"},5:{name:"player",text:"c to shoot"},6:{name:"player",text:"g or tap to throw grenades"},7:{name:"player",text:"have fun!"}},autoAdvance:"false",messageSettings:{pixelPerfect:"true"},locking:"true"}},{type:"EntityLava",x:192,y:220,settings:{size:{x:136,y:16},animationType:"SURFACE",triggerable:"false"}},{type:"EntityLava",x:192,y:236,settings:{size:{x:136,y:12}}},{type:"EntityLava",x:24,y:236,settings:{size:{x:112,y:12}}},{type:"EntityTorch",x:196,y:128},{type:"EntityLava",x:24,y:220,settings:{size:{x:112,y:16},animationType:"SURFACE",triggerable:"false"}},{type:"EntityTorch",x:124,y:204},{type:"EntityCheckpoint",x:96,y:160,settings:{size:{x:16,y:16}}},{type:"EntityGhost",x:144,y:50,settings:{tetherName:"tether"}},{type:"EntityTorch",x:144,y:68},{type:"EntityVoid",x:140,y:64,settings:{name:"tether"}},{type:"EntitySpike",x:220,y:140},{type:"EntitySpike",x:52,y:76},{type:"EntityPlayer",x:100,y:162}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,1,0,0,0,1,0,0,0,0,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,1,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,0,5,5,5,5,5,5,0,0,0,0,5,5,5,5,5,0,0,5,0,0,0,5,0,0,0,0,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,5,6,5,5,5,5,7,5,5,5,5,5,7,5,5,5,5,6,6,5,5,5,5,5,7,7,7,5,5,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,7,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,5],[0,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[0,7,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,3,1,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[5,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,3,4,0,0,0,0,0,0,0,0,0,0,0,2,5,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[0,5,1,0,0,1,1,1,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,7,5],[0,5,1,0,0,2,1,4,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,1,1,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,7,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,5],[0,5,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,3,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,6,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,1,1,1,3,3,3,1,1,0,0,0,0,0,0,0,0,1,5,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[0,5,1,0,0,0,0,0,0,0,1,1,1,4,4,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[0,5,2,0,0,0,0,0,0,0,1,3,3,3,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,0],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,1,2,2,0,0,1,7,5],[5,7,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,7,0],[5,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,3,3,3,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,4,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,6,5],[0,5,1,1,1,1,1,1,1,4,1,1,1,1,4,1,1,1,1,1,1,1,4,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]}]};
LevelSideScrollingResources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("game.entities.zombie").requires("plusplus.abstractities.creature","plusplus.abilities.melee","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityZombie=ig.global.EntityZombie=ig.Creature.extend({size:{x:8,y:16},offset:{x:0,y:0},collides:ig.EntityExtended.COLLIDES.FIXED,animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"zombie0.png",8,16),animInit:"idleX",name:"zombie",animSettings:{idleX:{frameTime:.08,sequence:[0,1,2]},idleLeft:{frameTime:.1,sequence:[9,10,11]},idleRight:{frameTime:.1,sequence:[9,10,11]},moveX:{frameTime:.1,sequence:[9,10,11]},moveLeft:{frameTime:.1,sequence:[9,10,11]},moveRight:{frameTime:.1,sequence:[9,10,11]},idleY:{frameTime:.08,sequence:[0,1,2]},idleUp:{frameTime:.08,sequence:[0,1,2]},idleDown:{frameTime:.08,sequence:[0,1,2]},moveY:{frameTime:.08,sequence:[0,1,2]},moveUp:{frameTime:.08,sequence:[0,1,2]},moveDown:{frameTime:.08,sequence:[0,1,2]}},animsExpected:"idleX idleLeft idleRight moveRight moveLeft moveUp moveDown melee".split(" "),canFlipX:!0,canFlipY:!1,gravityFactor:0,maxVelGrounded:{x:25,y:25},frictionGrounded:{x:800,y:800},speed:{x:70,y:70},health:10,deathSettings:{spawnCountMax:16,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.GREEN}},canJump:!1,canClimb:!1,canWanderX:!0,canWanderY:!0,wanderSwitchChance:.005,wanderSwitchChanceStopped:.015,tetherDistance:150,reactionDistance:125,moveToPreySettings:{searchDistance:150},predatorClass:"ENEMY",initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"preyGroup","FRIEND","GROUP");t.addType(ig.EntityExtended,this,"type","DAMAGEABLE");t.addType(ig.EntityExtended,this,"group","ENEMY","GROUP");t.addType(ig.EntityExtended,this,"checkAgainst","FRIEND")},initProperties:function(){this.parent();this.glow=new ig.AbilityGlow(this,{alpha:.07});this.melee=new ig.AbilityMelee(this,{canFindTarget:!1,damage:6,rangeX:.5*this.size.x});this.abilities.addDescendants([this.melee,this.glow])},attack:function(t){this.melee.setEntityTarget(t);return this.melee.entityTarget?(t=this.melee.closeEnough(),this.melee.activate(),t):this.parent()}})});ig.baked=!0;ig.module("game.entities.people").requires("plusplus.abstractities.creature","plusplus.abilities.melee","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityPeople=ig.global.EntityPeople=ig.Creature.extend({size:{x:8,y:16},offset:{x:0,y:0},collides:ig.EntityExtended.COLLIDES.FIXED,check:function(t){"player"==t.name?(ig.game.gameData.points+=10,this.die()):"zombie"==t.name?this.die():"enemy"==t.name?this.die():"people"!=t.name&&console.log(t.name)},animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"people.png",8,16),animInit:"idleX",name:"people",animSettings:{idleX:{frameTime:.08,sequence:[0,1,2]},idleLeft:{frameTime:.1,sequence:[9,10,11]},idleRight:{frameTime:.1,sequence:[9,10,11]},moveX:{frameTime:.1,sequence:[9,10,11]},moveLeft:{frameTime:.1,sequence:[9,10,11]},moveRight:{frameTime:.1,sequence:[9,10,11]},idleY:{frameTime:.08,sequence:[0,1,2]},idleUp:{frameTime:.08,sequence:[0,1,2]},idleDown:{frameTime:.08,sequence:[0,1,2]},moveY:{frameTime:.08,sequence:[0,1,2]},moveUp:{frameTime:.08,sequence:[0,1,2]},moveDown:{frameTime:.08,sequence:[0,1,2]}},animsExpected:"idleX idleLeft idleRight moveRight moveLeft moveUp moveDown melee".split(" "),canFlipX:!0,canFlipY:!1,gravityFactor:0,maxVelGrounded:{x:25,y:25},frictionGrounded:{x:800,y:800},speed:{x:70,y:70},health:1,deathSettings:{spawnCountMax:16,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.BLUE}},canJump:!1,canClimb:!1,canWanderX:!0,canWanderY:!0,wanderSwitchChance:.005,wanderSwitchChanceStopped:.015,tetherDistance:150,reactionDistance:125,moveToPreySettings:{searchDistance:150},initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"checkAgainst","DAMAGEABLE");t.addType(ig.EntityExtended,this,"predatorType","ENEMY","GROUP");t.addType(ig.EntityExtended,this,"type","DAMAGEABLE")},initProperties:function(){this.parent();this.glow=new ig.AbilityGlow(this,{alpha:.07});this.abilities.addDescendants([this.glow])}})});ig.baked=!0;ig.module("plusplus.entities.effect-electricity").requires("plusplus.core.config","plusplus.abstractities.effect").defines(function(){ig.EntityEffectElectricity=ig.global.EntityEffectElectricity=ig.Effect.extend({performance:ig.EntityExtended.PERFORMANCE.STATIC,size:{x:32,y:32},animAutomatic:!1,animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"effect_electricity.png",32,32),animSettings:{moveX:{sequence:[0,1,2,3],frameTime:.15}}})});ig.baked=!0;ig.module("game.levels.title").requires("impact.image","game.entities.torch","game.entities.zombie","plusplus.entities.light","game.entities.people","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelTitle={entities:[{type:"EntityTorch",x:12,y:136},{type:"EntityZombie",x:256,y:140},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityTorch",x:328,y:248},{type:"EntityTorch",x:100,y:8},{type:"EntityTorch",x:24,y:24},{type:"EntityTorch",x:204,y:248},{type:"EntityTorch",x:336,y:128},{type:"EntityTorch",x:88,y:248},{type:"EntityTorch",x:8,y:232},{type:"EntityLight",x:256,y:52,settings:{size:{x:12,y:10}}},{type:"EntityPeople",x:8,y:-168},{type:"EntityPeople",x:260,y:56},{type:"EntityPlayer",x:36,y:92},{type:"EntityEffectElectricity",x:24,y:84}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,0,0,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,1,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,6,0,0,2,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,2,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,2,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,8,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,8,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,4,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,4,0,0,0,0,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,6,8,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]},{name:"instructions",width:1,height:1,linkWithCollision:!1,visible:1,tilesetName:"media/instructions.png",repeat:!1,preRender:!1,distance:"1",tilesize:250,foreground:!1,data:[[1]]}]};LevelTitleResources=[new ig.Image("media/tiles.png"),new ig.Image("media/instructions.png")]});ig.baked=!0;ig.module("game.levels.level1").requires("impact.image","game.entities.torch","game.entities.zombie","plusplus.entities.light","game.entities.people","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelLevel1={entities:[{type:"EntityTorch",x:12,y:136},{type:"EntityTorch",x:88,y:248},{type:"EntityTorch",x:24,y:24},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityZombie",x:252,y:184},{type:"EntityTorch",x:328,y:248},{type:"EntityZombie",x:178,y:126},{type:"EntityTorch",x:336,y:128},{type:"EntityZombie",x:152,y:108},{type:"EntityTorch",x:100,y:8},{type:"EntityZombie",x:224,y:48},{type:"EntityTorch",x:204,y:248},{type:"EntityTorch",x:8,y:232},{type:"EntityLight",x:188,y:64,settings:{size:{x:18,y:22}}},{type:"EntityLight",x:208,y:88,settings:{size:{x:12,y:10}}},{type:"EntityLight",x:264,y:88,settings:{size:{x:8,y:8}}},{type:"EntityPeople",x:8,y:-168},{type:"EntityPeople",x:260,y:64},{type:"EntityPeople",x:152,y:60},{type:"EntityPeople",x:200,y:112},{type:"EntityPeople",x:84,y:180},{type:"EntityPeople",x:84,y:32},{type:"EntityZombie",x:204,y:160},{type:"EntityPlayer",x:36,y:92},{type:"EntityEffectElectricity",x:24,y:84}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]},{name:"instructions",width:1,height:1,linkWithCollision:!1,visible:!0,tilesetName:"media/instructions1.png",repeat:!1,preRender:!1,distance:"1",tilesize:250,foreground:!1,data:[[1]]}]};LevelLevel1Resources=[new ig.Image("media/tiles.png"),new ig.Image("media/instructions1.png")]});ig.baked=!0;ig.module("game.levels.level2").requires("impact.image","game.entities.zombie","game.entities.torch","plusplus.entities.checkpoint","plusplus.entities.light","game.entities.people","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelLevel2={entities:[{type:"EntityZombie",x:198,y:150},{type:"EntityZombie",x:160,y:76},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityTorch",x:88,y:248},{type:"EntityZombie",x:146,y:118},{type:"EntityTorch",x:12,y:136},{type:"EntityZombie",x:244,y:64},{type:"EntityTorch",x:336,y:128},{type:"EntityTorch",x:8,y:232},{type:"EntityCheckpoint",x:368,y:152,settings:{size:{x:32,y:24}}},{type:"EntityTorch",x:100,y:8},{type:"EntityTorch",x:24,y:24},{type:"EntityZombie",x:142,y:154},{type:"EntityTorch",x:204,y:248},{type:"EntityZombie",x:220,y:116},{type:"EntityTorch",x:328,y:248},{type:"EntityLight",x:188,y:64,settings:{size:{x:18,y:22}}},{type:"EntityLight",x:208,y:88,settings:{size:{x:12,y:10}}},{type:"EntityLight",x:264,y:88,settings:{size:{x:8,y:8}}},{type:"EntityZombie",x:164,y:24},{type:"EntityZombie",x:232,y:156},{type:"EntityZombie",x:186,y:126},{type:"EntityZombie",x:52,y:216},{type:"EntityZombie",x:104,y:224},{type:"EntityZombie",x:168,y:220},{type:"EntityPeople",x:140,y:28},{type:"EntityPeople",x:108,y:144},{type:"EntityPeople",x:108,y:28},{type:"EntityPeople",x:296,y:32},{type:"EntityPeople",x:228,y:36},{type:"EntityPeople",x:288,y:96},{type:"EntityPeople",x:136,y:208},{type:"EntityPeople",x:304,y:204},{type:"EntityPeople",x:304,y:124},{type:"EntityPeople",x:44,y:196},{type:"EntityPeople",x:44,y:136},{type:"EntityPeople",x:180,y:92},{type:"EntityPeople",x:180,y:184},{type:"EntityPeople",x:248,y:224},{type:"EntityPlayer",x:56,y:68},{type:"EntityEffectElectricity",x:44,y:60}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]}]};LevelLevel2Resources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("game.levels.level3").requires("impact.image","game.entities.people","game.entities.zombie","game.entities.torch","plusplus.entities.checkpoint","plusplus.entities.light","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelLevel3={entities:[{type:"EntityPeople",x:264,y:116},{type:"EntityZombie",x:182,y:126},{type:"EntityTorch",x:24,y:24},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityZombie",x:276,y:40},{type:"EntityTorch",x:100,y:8},{type:"EntityPeople",x:272,y:196},{type:"EntityTorch",x:204,y:248},{type:"EntityCheckpoint",x:368,y:152,settings:{size:{x:32,y:24}}},{type:"EntityTorch",x:88,y:248},{type:"EntityTorch",x:12,y:136},{type:"EntityTorch",x:336,y:128},{type:"EntityTorch",x:8,y:232},{type:"EntityZombie",x:142,y:154},{type:"EntityZombie",x:312,y:232},{type:"EntityZombie",x:146,y:118},{type:"EntityTorch",x:328,y:248},{type:"EntityZombie",x:260,y:32},{type:"EntityLight",x:80,y:44,settings:{size:{x:18,y:22}}},{type:"EntityLight",x:80,y:208,settings:{size:{x:12,y:10}}},{type:"EntityZombie",x:264,y:48},{type:"EntityPeople",x:292,y:120},{type:"EntityPeople",x:288,y:204},{type:"EntityPeople",x:296,y:176},{type:"EntityPeople",x:280,y:140},{type:"EntityZombie",x:208,y:48},{type:"EntityZombie",x:202,y:150},{type:"EntityZombie",x:184,y:60},{type:"EntityZombie",x:156,y:72},{type:"EntityZombie",x:160,y:44},{type:"EntityZombie",x:112,y:152},{type:"EntityZombie",x:168,y:100},{type:"EntityZombie",x:124,y:112},{type:"EntityZombie",x:100,y:200},{type:"EntityZombie",x:208,y:220},{type:"EntityZombie",x:128,y:204},{type:"EntityZombie",x:168,y:196},{type:"EntityZombie",x:196,y:188},{type:"EntityZombie",x:228,y:184},{type:"EntityPlayer",x:80,y:40},{type:"EntityEffectElectricity",x:68,y:32}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,6,6,6,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,6,6,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,4,4,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,4,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,4,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,4,4,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,4,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,4,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,4,4,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,7,5],[5,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,4,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]}]};
LevelLevel3Resources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("game.levels.level4").requires("impact.image","game.entities.people","game.entities.torch","plusplus.entities.checkpoint","game.entities.zombie","plusplus.entities.light","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelLevel4={entities:[{type:"EntityPeople",x:272,y:196},{type:"EntityPeople",x:92,y:76},{type:"EntityTorch",x:24,y:24},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityTorch",x:100,y:8},{type:"EntityTorch",x:204,y:248},{type:"EntityCheckpoint",x:368,y:152,settings:{size:{x:32,y:24}}},{type:"EntityTorch",x:88,y:248},{type:"EntityTorch",x:12,y:136},{type:"EntityTorch",x:336,y:128},{type:"EntityTorch",x:8,y:232},{type:"EntityZombie",x:142,y:154},{type:"EntityZombie",x:312,y:232},{type:"EntityZombie",x:146,y:118},{type:"EntityTorch",x:328,y:248},{type:"EntityZombie",x:64,y:112},{type:"EntityLight",x:328,y:36,settings:{size:{x:18,y:22}}},{type:"EntityLight",x:80,y:208,settings:{size:{x:12,y:10}}},{type:"EntityZombie",x:182,y:126},{type:"EntityZombie",x:64,y:168},{type:"EntityZombie",x:276,y:40},{type:"EntityPeople",x:52,y:204},{type:"EntityPeople",x:288,y:204},{type:"EntityPeople",x:296,y:176},{type:"EntityPeople",x:252,y:104},{type:"EntityZombie",x:208,y:48},{type:"EntityZombie",x:202,y:150},{type:"EntityZombie",x:184,y:60},{type:"EntityZombie",x:156,y:72},{type:"EntityZombie",x:160,y:44},{type:"EntityZombie",x:112,y:152},{type:"EntityZombie",x:24,y:60},{type:"EntityZombie",x:124,y:112},{type:"EntityZombie",x:100,y:200},{type:"EntityZombie",x:208,y:220},{type:"EntityZombie",x:128,y:204},{type:"EntityZombie",x:168,y:196},{type:"EntityZombie",x:196,y:188},{type:"EntityZombie",x:228,y:184},{type:"EntityPeople",x:144,y:24},{type:"EntityPeople",x:336,y:92},{type:"EntityZombie",x:92,y:44},{type:"EntityPlayer",x:332,y:36},{type:"EntityEffectElectricity",x:320,y:28}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,1,1,0],[0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],[0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,5,5,5,5,5,5,5,5,0,0,0,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0,0,5,5,5,5,5,5,5,0,0,5,5,0],[0,7,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[0,6,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[0,5,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,7],[0,5,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,7],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,5],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,5],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]}]};LevelLevel4Resources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("game.entities.big-zombie").requires("plusplus.abstractities.creature","plusplus.abilities.melee","plusplus.core.config","plusplus.helpers.utils").defines(function(){var t=ig.utils;ig.EntityBigZombie=ig.global.EntityBigZombie=ig.Creature.extend({size:{x:8,y:16},offset:{x:0,y:0},collides:ig.EntityExtended.COLLIDES.FIXED,animSheet:new ig.AnimationSheet(ig.CONFIG.PATH_TO_MEDIA+"bigzombie.png",8,16),animInit:"idleX",name:"zombie",animSettings:{idleX:{frameTime:.08,sequence:[0,1,2]},idleLeft:{frameTime:.1,sequence:[9,10,11]},idleRight:{frameTime:.1,sequence:[9,10,11]},moveX:{frameTime:.1,sequence:[9,10,11]},moveLeft:{frameTime:.1,sequence:[9,10,11]},moveRight:{frameTime:.1,sequence:[9,10,11]},idleY:{frameTime:.08,sequence:[0,1,2]},idleUp:{frameTime:.08,sequence:[0,1,2]},idleDown:{frameTime:.08,sequence:[0,1,2]},moveY:{frameTime:.08,sequence:[0,1,2]},moveUp:{frameTime:.08,sequence:[0,1,2]},moveDown:{frameTime:.08,sequence:[0,1,2]}},animsExpected:"idleX idleLeft idleRight moveRight moveLeft moveUp moveDown melee".split(" "),canFlipX:!0,canFlipY:!1,gravityFactor:0,maxVelGrounded:{x:25,y:25},frictionGrounded:{x:800,y:800},speed:{x:30,y:30},health:18,deathSettings:{spawnCountMax:16,spawnSettings:{animTileOffset:ig.EntityParticleColor.colorOffsets.GREEN}},canJump:!1,canClimb:!1,canWanderX:!0,canWanderY:!0,wanderSwitchChance:.005,wanderSwitchChanceStopped:.015,tetherDistance:150,reactionDistance:125,moveToPreySettings:{searchDistance:150},predatorClass:"ENEMY",initTypes:function(){this.parent();t.addType(ig.EntityExtended,this,"preyGroup","FRIEND","GROUP");t.addType(ig.EntityExtended,this,"type","DAMAGEABLE");t.addType(ig.EntityExtended,this,"group","ENEMY","GROUP");t.addType(ig.EntityExtended,this,"checkAgainst","FRIEND")},initProperties:function(){this.parent();this.glow=new ig.AbilityGlow(this,{alpha:.07});this.melee=new ig.AbilityMelee(this,{canFindTarget:!1,damage:6,rangeX:.5*this.size.x});this.abilities.addDescendants([this.melee,this.glow])},attack:function(t){this.melee.setEntityTarget(t);return this.melee.entityTarget?(t=this.melee.closeEnough(),this.melee.activate(),t):this.parent()}})});ig.baked=!0;ig.module("game.levels.level5").requires("impact.image","game.entities.zombie","game.entities.people","game.entities.torch","plusplus.entities.light","game.entities.big-zombie","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelLevel5={entities:[{type:"EntityZombie",x:208,y:48},{type:"EntityPeople",x:296,y:176},{type:"EntityTorch",x:24,y:24},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityLight",x:164,y:220,settings:{size:{x:22,y:22}}},{type:"EntityZombie",x:116,y:72},{type:"EntityPeople",x:64,y:132},{type:"EntityZombie",x:182,y:126},{type:"EntityPeople",x:288,y:204},{type:"EntityZombie",x:276,y:40},{type:"EntityPeople",x:264,y:116},{type:"EntityTorch",x:100,y:8},{type:"EntityPeople",x:272,y:196},{type:"EntityTorch",x:204,y:248},{type:"EntityTorch",x:88,y:248},{type:"EntityTorch",x:12,y:136},{type:"EntityTorch",x:336,y:128},{type:"EntityTorch",x:8,y:232},{type:"EntityZombie",x:142,y:154},{type:"EntityZombie",x:312,y:232},{type:"EntityZombie",x:146,y:118},{type:"EntityTorch",x:328,y:248},{type:"EntityZombie",x:260,y:32},{type:"EntityLight",x:80,y:208,settings:{size:{x:12,y:10}}},{type:"EntityPeople",x:280,y:140},{type:"EntityZombie",x:202,y:150},{type:"EntityZombie",x:184,y:60},{type:"EntityZombie",x:156,y:72},{type:"EntityZombie",x:160,y:44},{type:"EntityZombie",x:112,y:152},{type:"EntityZombie",x:20,y:152},{type:"EntityZombie",x:124,y:112},{type:"EntityZombie",x:100,y:200},{type:"EntityZombie",x:248,y:232},{type:"EntityZombie",x:60,y:220},{type:"EntityZombie",x:48,y:180},{type:"EntityZombie",x:232,y:116},{type:"EntityZombie",x:228,y:184},{type:"EntityPeople",x:80,y:104},{type:"EntityPeople",x:80,y:44},{type:"EntityPeople",x:28,y:72},{type:"EntityZombie",x:172,y:100},{type:"EntityBigZombie",x:208,y:88},{type:"EntityBigZombie",x:224,y:60},{type:"EntityBigZombie",x:128,y:36},{type:"EntityBigZombie",x:132,y:180},{type:"EntityBigZombie",x:176,y:164},{type:"EntityPlayer",x:172,y:220},{type:"EntityEffectElectricity",x:156,y:212}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,1,1,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1],[1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[1,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1],[0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1],[0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1],[1,1,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,6,0,0,6,6,6,6,6,6,6,0,6,6,6,6,6,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,6,6,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,6,6,7,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,6,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,6,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,6,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,5],[5,5,1,0,0,0,0,6,6,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,5],[5,0,0,0,0,0,0,6,0,0,0,7,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,5],[5,0,0,0,0,0,6,6,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,4,0,0,0,5,5],[0,5,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,5,5],[0,5,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,6,5],[5,5,0,0,0,6,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,7,5],[5,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,4,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]}]};LevelLevel5Resources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("game.levels.level6").requires("impact.image","game.entities.people","game.entities.torch","game.entities.zombie","plusplus.entities.checkpoint","plusplus.entities.light","game.entities.big-zombie","game.entities.player","plusplus.entities.effect-electricity").defines(function(){LevelLevel6={entities:[{type:"EntityPeople",x:108,y:28},{type:"EntityPeople",x:296,y:32},{type:"EntityTorch",x:220,y:8},{type:"EntityTorch",x:320,y:8},{type:"EntityTorch",x:88,y:248},{type:"EntityZombie",x:160,y:76},{type:"EntityZombie",x:146,y:118},{type:"EntityZombie",x:198,y:150},{type:"EntityTorch",x:12,y:136},{type:"EntityZombie",x:244,y:64},{type:"EntityTorch",x:336,y:128},{type:"EntityTorch",x:8,y:232},{type:"EntityCheckpoint",x:368,y:152,settings:{size:{x:32,y:24}}},{type:"EntityTorch",x:100,y:8},{type:"EntityTorch",x:24,y:24},{type:"EntityZombie",x:142,y:154},{type:"EntityTorch",x:204,y:248},{type:"EntityZombie",x:220,y:116},{type:"EntityTorch",x:328,y:248},{type:"EntityLight",x:188,y:64,settings:{size:{x:18,y:22}}},{type:"EntityLight",x:208,y:88,settings:{size:{x:12,y:10}}},{type:"EntityLight",x:264,y:88,settings:{size:{x:8,y:8}}},{type:"EntityZombie",x:164,y:24},{type:"EntityZombie",x:232,y:156},{type:"EntityZombie",x:186,y:126},{type:"EntityZombie",x:52,y:216},{type:"EntityZombie",x:104,y:224},{type:"EntityZombie",x:168,y:220},{type:"EntityPeople",x:140,y:28},{type:"EntityPeople",x:108,y:144},{type:"EntityPeople",x:228,y:36},{type:"EntityPeople",x:288,y:96},{type:"EntityPeople",x:136,y:208},{type:"EntityPeople",x:304,y:204},{type:"EntityPeople",x:304,y:124},{type:"EntityPeople",x:44,y:196},{type:"EntityPeople",x:44,y:136},{type:"EntityPeople",x:180,y:92},{type:"EntityPeople",x:180,y:184},{type:"EntityPeople",x:248,y:224},{type:"EntityBigZombie",x:116,y:104},{type:"EntityBigZombie",x:148,y:52},{type:"EntityBigZombie",x:112,y:80},{type:"EntityBigZombie",x:148,y:96},{type:"EntityBigZombie",x:168,y:124},{type:"EntityBigZombie",x:204,y:24},{type:"EntityBigZombie",x:212,y:68},{type:"EntityBigZombie",x:256,y:36},{type:"EntityBigZombie",x:168,y:156},{type:"EntityBigZombie",x:244,y:92},{type:"EntityBigZombie",x:68,y:164},{type:"EntityBigZombie",x:300,y:160},{type:"EntityBigZombie",x:240,y:112},{type:"EntityBigZombie",x:284,y:128},{type:"EntityBigZombie",x:236,y:196},{type:"EntityBigZombie",x:188,y:204},{type:"EntityBigZombie",x:280,y:180},{type:"EntityPlayer",x:56,y:68},{type:"EntityEffectElectricity",x:44,y:60}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]]}]};LevelLevel6Resources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("game.levels.transition").requires("impact.image","game.entities.player").defines(function(){LevelTransition={entities:[{type:"EntityPlayer",x:180,y:64}],layer:[{name:"collision",width:44,height:34,linkWithCollision:!1,visible:1,tilesetName:"",repeat:!1,preRender:!1,distance:1,tilesize:8,foreground:!1,data:[[0,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,0]]},{name:"main",width:44,height:34,linkWithCollision:!0,visible:1,tilesetName:"media/tiles.png",repeat:!1,preRender:!1,distance:"1",tilesize:8,foreground:!1,data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}]};
LevelTransitionResources=[new ig.Image("media/tiles.png")]});ig.baked=!0;ig.module("plusplus.entities.levelchange").requires("plusplus.entities.trigger").defines(function(){ig.EntityLevelchange=ig.global.EntityLevelchange=ig.EntityTrigger.extend({_wmBoxColor:"rgba(0, 0, 255, 0.7)",levelName:"",playerSpawnerName:"",clearPersistentPlayer:!1,clearPersistentEntities:!1,activate:function(t){this.parent(t);if(this.clearPersistentEntities)ig.game.clearPersistentEntities();else if(this.clearPersistentPlayer){t=ig.game.getPlayer();var i="player";t&&(i=t.name||i);ig.game.clearPersistentEntity(i)}ig.game.loadLevelDeferred(this.levelName,this.playerSpawnerName)}})});ig.baked=!0;ig.module("game.main").requires("plusplus.core.plusplus","game.entities.player","game.entities.spike","game.ui.ui-toggle-gfx-min","game.ui.ui-toggle-gfx-max","plusplus.ui.ui-toggle-pause","plusplus.ui.ui-overlay","game.levels.side-scrolling","game.levels.title","game.levels.level1","game.levels.level2","game.levels.level3","game.levels.level4","game.levels.level5","game.levels.level6","game.levels.transition","plusplus.entities.levelchange").defines(function(){var t=ig.CONFIG,i=ig.GameExtended.extend({backgroundMap:null,clearcolor:"#ffffff",scorefont:new ig.Font(t.PATH_TO_MEDIA+"fonts/kenpixel.futuresquare.8px.png"),startTimer:new ig.Timer(2),transitionTimer:new ig.Timer(2),restartTimer:new ig.Timer(4),gameWillRestart:!1,tiles:new ig.Image("media/tiles.png"),playerDead:!1,gameData:{gameStarted:!1,level:0,points:0},shapesPasses:{lighting:{ignoreClimbable:!0,discardBoundaryInner:!0}},reloadLevel:function(){ig.game.transitionTimer.set(1e7);var t=[],t=[[0,0,0,5,0,5,0,0,5,0,5,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0],[0,7,5,5,6,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,0],[0,7,1,1,1,1,1,1,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,7,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[5,5,1,0,0,0,0,0,0,0,0,1,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,8,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,5],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,6,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,5],[5,7,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,7,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0],[0,5,5,5,8,5,7,5,5,5,5,5,5,5,8,7,5,5,5,5,5,5,5,5,5,5,5,5,8,5,5,5,5,5,5,5,5,7,8,8,5,5,5,0],[0,0,0,5,0,0,0,5,0,5,5,5,0,5,5,5,5,5,5,0,0,0,5,0,0,0,0,0,0,0,5,0,0,0,5,5,5,5,5,0,0,0,0,0]],t=new ig.BackgroundMap(8,t,this.tiles);t.setScreenPos(0,0);ig.game.backgroundMaps[0]=t},init:function(){this.parent();this.loadLevel(ig.global.LevelTitle)},inputStart:function(){this.parent();ig.input.bind(ig.KEY.UP_ARROW,"shoot-up");ig.input.bind(ig.KEY.DOWN_ARROW,"shoot-down");ig.input.bind(ig.KEY.LEFT_ARROW,"shoot-left");ig.input.bind(ig.KEY.RIGHT_ARROW,"shoot-right");ig.input.bind(ig.KEY.R,"restart")},uibutton:function(){ig.game.spawnEntity(ig.UIElement,0,0,{margin:{x:.02,y:.02}}).onActivated.add(ig.game.loadLevel(LevelTitle))},update:function(){this.parent();ig.input.pressed("restart")&&(this.playerDead=!1,ig.game.loadLevel(LevelTitle));var i=!1;this.playerDead="undefined"==typeof ig.game.getPlayer()?!0:!1;if(!this.playerDead){if("undefined"==typeof ig.game.getPlayer()){this.playerDead=!0;var e=ig.game.spawnEntity(ig.UIOverlay,0,0,{layerName:"ui",fillStyle:"#000000",alpha:0}),s=new ig.UIOverlay;e.fadeTo(.75);s.textSettings={text:"Final score: "+Zombotron.gameData.points};e=new ig.Font(t.PATH_TO_MEDIA+"fonts/kenpixel.blocks.8px.png");s.textSettings.font=e}if(0<ig.game.startTimer.delta()){for(s=0;s<ig.game.entities.length;s++){if("zombie"==ig.game.entities[s].name){ig.game.transitionTimer.set(.2);return}i=!0}i&&0<ig.game.transitionTimer.delta()&&(i=ig.game.getPlayer(),Zombotron.gameData.level+=1,ig.game.transitionTimer.set(2e3),console.log("LevelLevel"+Zombotron.gameData.level),ig.game.spawnEntity(EntityLevelchange,i.pos.x,i.pos.y,{size:{x:16,y:32},levelName:"LevelLevel"+Zombotron.gameData.level,playerSpawnerName:"roderick"}))}}},draw:function(){this.parent();this.scorefont.draw("ZOMBIETRON 2084 - SCORE: "+ig.game.gameData.points,ig.system.width/2,10,ig.Font.ALIGN.CENTER);this.playerDead&&(this.scorefont.draw("Game Over",ig.system.width/2,ig.system.height/2-10,ig.Font.ALIGN.CENTER),this.scorefont.draw("Press R to restart",ig.system.width/2,ig.system.height/2+10,ig.Font.ALIGN.CENTER))},inputEnd:function(){this.parent();ig.input.unbind(ig.KEY.UP_ARROW,"shoot-up");ig.input.unbind(ig.KEY.DOWN_ARROW,"shoot-down");ig.input.unbind(ig.KEY.LEFT_ARROW,"shoot-left");ig.input.unbind(ig.KEY.RIGHT_ARROW,"shoot-right");ig.input.unbind(ig.KEY.R,"restart")}});ig.main("#canvas",i,60,t.GAME_WIDTH,t.GAME_HEIGHT,t.SCALE,ig.LoaderExtended)});